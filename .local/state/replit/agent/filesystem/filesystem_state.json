{"file_contents":{"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/JiraSettingsDialog.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Loader2, CheckCircle2, AlertCircle, Info } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface JiraSettingsDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  businessUserId: string;\n}\n\nexport function JiraSettingsDialog({ open, onOpenChange, businessUserId }: JiraSettingsDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [jiraDomain, setJiraDomain] = useState(\"\");\n  const [jiraEmail, setJiraEmail] = useState(\"\");\n  const [jiraApiToken, setJiraApiToken] = useState(\"\");\n\n  // Fetch existing settings\n  const { data: settings, isLoading } = useQuery({\n    queryKey: [\"/api/jira/settings\", businessUserId],\n    enabled: open,\n  });\n\n  // Populate form fields when settings are loaded\n  useEffect(() => {\n    if (settings) {\n      const settingsData = settings as any;\n      if (settingsData?.jiraDomain) setJiraDomain(settingsData.jiraDomain);\n      if (settingsData?.jiraEmail) setJiraEmail(settingsData.jiraEmail);\n      // Don't populate API token for security - user must re-enter\n    }\n  }, [settings]);\n\n  // Test connection mutation\n  const testConnectionMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch(`/api/jira/test-connection`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ businessUserId }),\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"Connection test failed\");\n      }\n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      toast({\n        title: \"Connection Successful\",\n        description: data.message,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/jira/settings\", businessUserId] });\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Connection Failed\",\n        description: error.message || \"Failed to connect to Jira. Please check your credentials.\",\n      });\n    },\n  });\n\n  // Save settings mutation\n  const saveSettingsMutation = useMutation({\n    mutationFn: async () => {\n      // Only include API token if provided (to preserve existing token)\n      const payload: any = {\n        businessUserId,\n        jiraDomain,\n        jiraEmail,\n        connectionType: \"manual\",\n        isConfigured: true,\n      };\n      \n      if (jiraApiToken) {\n        payload.jiraApiToken = jiraApiToken;\n      }\n      \n      return await apiRequest(\"POST\", `/api/jira/settings`, payload);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Settings Saved\",\n        description: \"Jira configuration has been saved successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/jira/settings\", businessUserId] });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: error.message || \"Failed to save settings.\",\n      });\n    },\n  });\n\n  const handleTestConnection = () => {\n    testConnectionMutation.mutate();\n  };\n\n  const handleSave = () => {\n    // Allow saving without API token if already configured (keep existing)\n    const isConfigured = (settings as any)?.isConfigured;\n    \n    if (!jiraDomain || !jiraEmail) {\n      toast({\n        variant: \"destructive\",\n        title: \"Missing Information\",\n        description: \"Please provide Jira domain and email.\",\n      });\n      return;\n    }\n    \n    if (!isConfigured && !jiraApiToken) {\n      toast({\n        variant: \"destructive\",\n        title: \"Missing API Token\",\n        description: \"Please provide an API token for initial setup.\",\n      });\n      return;\n    }\n    \n    saveSettingsMutation.mutate();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl\" data-testid=\"dialog-jira-settings\">\n        <DialogHeader>\n          <DialogTitle className=\"text-2xl\">Jira Configuration</DialogTitle>\n          <DialogDescription>\n            Configure your Jira credentials to sync projects and track milestones\n          </DialogDescription>\n        </DialogHeader>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"w-6 h-6 animate-spin\" />\n          </div>\n        ) : (\n          <div className=\"space-y-6\">\n            <Alert>\n              <Info className=\"h-4 w-4\" />\n              <AlertDescription>\n                <strong>Note:</strong> Jira integration uses Replit's secure connector system. \n                If you haven't connected Jira yet, you'll need to set it up through the Replit \n                integrations panel first, or manually configure your credentials below.\n              </AlertDescription>\n            </Alert>\n\n            {(settings as any)?.isConfigured && (\n              <Alert>\n                <CheckCircle2 className=\"h-4 w-4\" />\n                <AlertDescription>\n                  <strong>Connected!</strong> Last synced: {(settings as any).lastSyncedAt ? new Date((settings as any).lastSyncedAt).toLocaleString() : \"Never\"}\n                </AlertDescription>\n              </Alert>\n            )}\n\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"jira-domain\" data-testid=\"label-jira-domain\">Jira Domain</Label>\n                <Input\n                  id=\"jira-domain\"\n                  data-testid=\"input-jira-domain\"\n                  placeholder=\"company.atlassian.net\"\n                  value={jiraDomain}\n                  onChange={(e) => setJiraDomain(e.target.value)}\n                  className=\"mt-1\"\n                />\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  Your Jira cloud instance domain (without https://)\n                </p>\n              </div>\n\n              <div>\n                <Label htmlFor=\"jira-email\" data-testid=\"label-jira-email\">Jira Email</Label>\n                <Input\n                  id=\"jira-email\"\n                  data-testid=\"input-jira-email\"\n                  type=\"email\"\n                  placeholder=\"your-email@company.com\"\n                  value={jiraEmail}\n                  onChange={(e) => setJiraEmail(e.target.value)}\n                  className=\"mt-1\"\n                />\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  Email address associated with your Jira account\n                </p>\n              </div>\n\n              <div>\n                <Label htmlFor=\"jira-api-token\" data-testid=\"label-jira-token\">API Token</Label>\n                <Input\n                  id=\"jira-api-token\"\n                  data-testid=\"input-jira-token\"\n                  type=\"password\"\n                  placeholder={(settings as any)?.isConfigured ? \"••••••••••••••••\" : \"Enter API token\"}\n                  value={jiraApiToken}\n                  onChange={(e) => setJiraApiToken(e.target.value)}\n                  className=\"mt-1\"\n                />\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  {(settings as any)?.isConfigured ? \"Leave blank to keep existing token. \" : \"\"}\n                  Generate an API token from{\" \"}\n                  <a\n                    href=\"https://id.atlassian.com/manage-profile/security/api-tokens\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"underline hover:text-foreground\"\n                  >\n                    Atlassian Account Settings\n                  </a>\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex gap-3 justify-end\">\n              <Button\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel\"\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={handleTestConnection}\n                disabled={testConnectionMutation.isPending}\n                data-testid=\"button-test-connection\"\n              >\n                {testConnectionMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    Testing...\n                  </>\n                ) : (\n                  \"Test Connection\"\n                )}\n              </Button>\n              <Button\n                onClick={handleSave}\n                disabled={saveSettingsMutation.isPending}\n                data-testid=\"button-save-settings\"\n              >\n                {saveSettingsMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    Saving...\n                  </>\n                ) : (\n                  \"Save Settings\"\n                )}\n              </Button>\n            </div>\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":9583},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/pages/CreateProject.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { ArrowLeft, Plus, Trash2, Sparkles } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { SkillMapDisplay } from \"@/components/SkillMapDisplay\";\n\nconst projectSchema = z.object({\n  name: z.string().min(3, \"Project name must be at least 3 characters\"),\n  description: z.string().min(10, \"Description must be at least 10 characters\"),\n  businessUserId: z.string().default(\"demo-user\"),\n  jiraProjectKey: z.string().optional(),\n  milestones: z.array(z.object({\n    name: z.string().min(1, \"Milestone name is required\"),\n    description: z.string().min(1, \"Description is required\"),\n    estimatedHours: z.number().min(1).optional(),\n  })).min(1, \"At least one milestone is required\"),\n});\n\ntype ProjectFormValues = z.infer<typeof projectSchema>;\n\nexport default function CreateProject() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [generatedSkillMaps, setGeneratedSkillMaps] = useState<any[]>([]);\n  const [generatingIndex, setGeneratingIndex] = useState<number | null>(null);\n\n  const form = useForm<ProjectFormValues>({\n    resolver: zodResolver(projectSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      businessUserId: \"demo-user\",\n      jiraProjectKey: \"\",\n      milestones: [{ name: \"\", description: \"\", estimatedHours: undefined }],\n    },\n  });\n\n  const createProjectMutation = useMutation({\n    mutationFn: async (data: ProjectFormValues) => {\n      const result = await apiRequest(\"POST\", \"/api/projects\", data);\n      return result;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      toast({\n        title: \"Success\",\n        description: \"Project created successfully with AI-generated skill maps!\",\n      });\n      setLocation(\"/business\");\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create project\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const generateSkillMapMutation = useMutation({\n    mutationFn: async (milestone: { name: string; description: string }) => {\n      const result = await apiRequest(\"POST\", \"/api/ai/generate-skill-map\", milestone);\n      return result;\n    },\n    onSuccess: (data, variables, context) => {\n      const newMaps = [...generatedSkillMaps];\n      newMaps[generatingIndex!] = data.skillMap;\n      setGeneratedSkillMaps(newMaps);\n      setGeneratingIndex(null);\n      toast({\n        title: \"AI Generated\",\n        description: \"Skill map created successfully!\",\n      });\n    },\n    onError: () => {\n      setGeneratingIndex(null);\n      toast({\n        title: \"Error\",\n        description: \"Failed to generate skill map\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const milestones = form.watch(\"milestones\");\n\n  const addMilestone = () => {\n    const current = form.getValues(\"milestones\");\n    form.setValue(\"milestones\", [...current, { name: \"\", description: \"\", estimatedHours: undefined }]);\n  };\n\n  const removeMilestone = (index: number) => {\n    const current = form.getValues(\"milestones\");\n    form.setValue(\"milestones\", current.filter((_, i) => i !== index));\n    const newMaps = generatedSkillMaps.filter((_, i) => i !== index);\n    setGeneratedSkillMaps(newMaps);\n  };\n\n  const generateSkillMap = (index: number) => {\n    const milestone = milestones[index];\n    if (milestone.name && milestone.description) {\n      setGeneratingIndex(index);\n      generateSkillMapMutation.mutate(milestone);\n    }\n  };\n\n  const onSubmit = (data: ProjectFormValues) => {\n    createProjectMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b border-border bg-white sticky top-0 z-50\">\n        <div className=\"max-w-5xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={() => setLocation(\"/business\")}\n              data-testid=\"button-back\"\n            >\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n            <h1 className=\"text-2xl font-bold\" data-testid=\"page-title\">Create New Project</h1>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-5xl mx-auto px-4 py-8\">\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-8\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Project Details</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Project Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"e.g., Data Analytics Dashboard\" {...field} data-testid=\"input-project-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Description</FormLabel>\n                      <FormControl>\n                        <Textarea \n                          placeholder=\"Describe the project goals, requirements, and key deliverables...\" \n                          className=\"min-h-[100px]\"\n                          {...field} \n                          data-testid=\"input-project-description\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"jiraProjectKey\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Jira Project Key (Optional)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"e.g., PROJ-123\" {...field} data-testid=\"input-jira-key\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            <div>\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-semibold\">Milestones</h2>\n                <Button type=\"button\" variant=\"outline\" onClick={addMilestone} data-testid=\"button-add-milestone\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Add Milestone\n                </Button>\n              </div>\n\n              <div className=\"space-y-6\">\n                {milestones.map((_, index) => (\n                  <Card key={index} data-testid={`milestone-card-${index}`}>\n                    <CardHeader>\n                      <div className=\"flex items-center justify-between\">\n                        <CardTitle className=\"text-lg\">Milestone {index + 1}</CardTitle>\n                        {milestones.length > 1 && (\n                          <Button\n                            type=\"button\"\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => removeMilestone(index)}\n                            data-testid={`button-remove-milestone-${index}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 text-[hsl(0,84%,60%)]\" />\n                          </Button>\n                        )}\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name={`milestones.${index}.name`}\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Milestone Name</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"e.g., Backend API Development\" {...field} data-testid={`input-milestone-name-${index}`} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={form.control}\n                        name={`milestones.${index}.description`}\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Description</FormLabel>\n                            <FormControl>\n                              <Textarea \n                                placeholder=\"Describe the milestone deliverables and requirements...\" \n                                {...field} \n                                data-testid={`input-milestone-description-${index}`}\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={form.control}\n                        name={`milestones.${index}.estimatedHours`}\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Estimated Hours</FormLabel>\n                            <FormControl>\n                              <Input \n                                type=\"number\" \n                                placeholder=\"40\" \n                                {...field}\n                                onChange={(e) => field.onChange(e.target.value ? parseInt(e.target.value) : undefined)}\n                                data-testid={`input-milestone-hours-${index}`}\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      \n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        className=\"w-full\"\n                        onClick={() => generateSkillMap(index)}\n                        disabled={generatingIndex === index || !milestones[index].name || !milestones[index].description}\n                        data-testid={`button-generate-skillmap-${index}`}\n                      >\n                        <Sparkles className=\"w-4 h-4 mr-2\" />\n                        {generatingIndex === index ? \"Generating...\" : \"Generate AI Skill Map\"}\n                      </Button>\n\n                      {generatedSkillMaps[index] && (\n                        <div className=\"mt-4\">\n                          <SkillMapDisplay skillMap={generatedSkillMaps[index]} />\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"flex gap-3\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => setLocation(\"/business\")}\n                data-testid=\"button-cancel\"\n              >\n                Cancel\n              </Button>\n              <Button \n                type=\"submit\" \n                className=\"flex-1\"\n                disabled={createProjectMutation.isPending}\n                data-testid=\"button-create-project\"\n              >\n                {createProjectMutation.isPending ? \"Creating...\" : \"Create Project\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </main>\n    </div>\n  );\n}\n","size_bytes":12694},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/pages/BusinessDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ProjectCard } from \"@/components/ProjectCard\";\nimport { Plus, FolderKanban, Users, TrendingUp, AlertTriangle, ArrowLeft, Download, Settings } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { JiraSettingsDialog } from \"@/components/JiraSettingsDialog\";\n\nexport default function BusinessDashboard() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [jiraSettingsOpen, setJiraSettingsOpen] = useState(false);\n\n  const { data: projects = [] } = useQuery<any[]>({\n    queryKey: [\"/api/projects\"],\n  });\n\n  const { data: stats = { totalProjects: 0, totalCandidates: 0, avgFitScore: 0, riskAlerts: 0 } } = useQuery<{\n    totalProjects: number;\n    totalCandidates: number;\n    avgFitScore: number;\n    riskAlerts: number;\n  }>({\n    queryKey: [\"/api/business/stats\"],\n  });\n\n  const importFromJiraMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch(\"/api/jira/import-projects\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ businessUserId: \"demo-business-user\" }),\n      });\n      if (!response.ok) {\n        throw new Error(\"Failed to import projects\");\n      }\n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/business/stats\"] });\n      toast({\n        title: \"Import Successful\",\n        description: `Imported ${data.imported} project(s) from Jira with AI-powered skill mapping.`,\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Import Failed\",\n        description: error.message || \"Failed to import projects from Jira. Please check your Jira connection.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b border-border bg-white sticky top-0 z-50\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                onClick={() => setLocation(\"/\")}\n                data-testid=\"button-back-home\"\n              >\n                <ArrowLeft className=\"w-5 h-5\" />\n              </Button>\n              <h1 className=\"text-2xl font-bold\" data-testid=\"business-dashboard-title\">Business Portal</h1>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button \n                variant=\"outline\"\n                size=\"icon\"\n                onClick={() => setJiraSettingsOpen(true)}\n                data-testid=\"button-jira-settings\"\n              >\n                <Settings className=\"w-4 h-4\" />\n              </Button>\n              <Button \n                variant=\"outline\"\n                onClick={() => importFromJiraMutation.mutate()}\n                disabled={importFromJiraMutation.isPending}\n                data-testid=\"button-import-jira\"\n              >\n                <Download className=\"w-4 h-4 mr-2\" />\n                {importFromJiraMutation.isPending ? \"Importing...\" : \"Import from Jira\"}\n              </Button>\n              <Button \n                onClick={() => setLocation(\"/business/projects/new\")}\n                data-testid=\"button-new-project\"\n              >\n                <Plus className=\"w-4 h-4 mr-2\" />\n                New Project\n              </Button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 py-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n          <Card data-testid=\"stat-projects\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Active Projects</CardTitle>\n                <FolderKanban className=\"w-4 h-4 text-muted-foreground\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold\" data-testid=\"stat-projects-value\">{stats.totalProjects}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"stat-candidates\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Candidates</CardTitle>\n                <Users className=\"w-4 h-4 text-muted-foreground\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold\" data-testid=\"stat-candidates-value\">{stats.totalCandidates}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"stat-fit-score\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Avg Fit Score</CardTitle>\n                <TrendingUp className=\"w-4 h-4 text-muted-foreground\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold\" data-testid=\"stat-fit-score-value\">{stats.avgFitScore}%</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"stat-risk-alerts\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Risk Alerts</CardTitle>\n                <AlertTriangle className=\"w-4 h-4 text-[hsl(0,84%,60%)]\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold text-[hsl(0,84%,60%)]\" data-testid=\"stat-risk-alerts-value\">\n                {stats.riskAlerts}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"mb-6\">\n          <h2 className=\"text-2xl font-semibold mb-4\">Your Projects</h2>\n          {projects.length === 0 ? (\n            <Card className=\"py-16\">\n              <CardContent className=\"text-center\">\n                <FolderKanban className=\"w-16 h-16 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-xl font-semibold mb-2\">No projects yet</h3>\n                <p className=\"text-muted-foreground mb-6\">\n                  Create your first project to start matching candidates with AI-powered skill mapping.\n                </p>\n                <Button onClick={() => setLocation(\"/business/projects/new\")} data-testid=\"button-create-first-project\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Create First Project\n                </Button>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {projects.map((project: any) => (\n                <ProjectCard\n                  key={project.id}\n                  project={project}\n                  onViewDetails={(id) => setLocation(`/business/projects/${id}`)}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      </main>\n\n      <JiraSettingsDialog\n        open={jiraSettingsOpen}\n        onOpenChange={setJiraSettingsOpen}\n        businessUserId=\"demo-business-user\"\n      />\n    </div>\n  );\n}\n","size_bytes":7917},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport session from \"express-session\";\nimport connectPgSimple from \"connect-pg-simple\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { sql } from \"drizzle-orm\";\nimport { Pool } from \"@neondatabase/serverless\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  try {\n    // Verify critical environment variables\n    if (!process.env.DATABASE_URL) {\n      throw new Error(\"DATABASE_URL environment variable is required. Please set it in your deployment configuration.\");\n    }\n    if (!process.env.GEMINI_API_KEY) {\n      throw new Error(\"GEMINI_API_KEY environment variable is required. Please set it in your deployment configuration.\");\n    }\n\n    // Test database connection\n    log(\"Testing database connection...\");\n    const { db } = await import(\"./db\");\n    try {\n      await db.execute(sql`SELECT 1`);\n      log(\"Database connection successful\");\n    } catch (dbError: any) {\n      throw new Error(`Database connection failed: ${dbError.message}. Please check your DATABASE_URL configuration.`);\n    }\n\n    // Configure session store\n    const PgSession = connectPgSimple(session);\n    const sessionPool = new Pool({ connectionString: process.env.DATABASE_URL });\n\n    const sessionSecret = process.env.SESSION_SECRET;\n    if (!sessionSecret) {\n      throw new Error(\"SESSION_SECRET environment variable is required.\");\n    }\n\n    app.use(\n      session({\n        store: new PgSession({\n          pool: sessionPool,\n          tableName: \"sessions\",\n          createTableIfMissing: false,\n        }),\n        secret: sessionSecret,\n        resave: false,\n        saveUninitialized: false,\n        cookie: {\n          maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\n          httpOnly: true,\n          secure: process.env.NODE_ENV === \"production\",\n          sameSite: \"lax\",\n        },\n      })\n    );\n    log(\"Session middleware configured\");\n\n    const server = await registerRoutes(app);\n\n    app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n      const status = err.status || err.statusCode || 500;\n      const message = err.message || \"Internal Server Error\";\n\n      res.status(status).json({ message });\n      throw err;\n    });\n\n    // importantly only setup vite in development and after\n    // setting up all the other routes so the catch-all route\n    // doesn't interfere with the other routes\n    if (app.get(\"env\") === \"development\") {\n      await setupVite(app, server);\n    } else {\n      serveStatic(app);\n    }\n\n    // ALWAYS serve the app on the port specified in the environment variable PORT\n    // Other ports are firewalled. Default to 5000 if not specified.\n    // this serves both the API and the client.\n    // It is the only port that is not firewalled.\n    const port = parseInt(process.env.PORT || '5000', 10);\n    \n    server.listen({\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    }, () => {\n      log(`Server successfully started on port ${port}`);\n      log(`Environment: ${app.get(\"env\")}`);\n      log(`Listening on http://0.0.0.0:${port}`);\n    });\n\n    // Handle server errors\n    server.on('error', (error: any) => {\n      if (error.code === 'EADDRINUSE') {\n        log(`Port ${port} is already in use`);\n      } else {\n        log(`Server error: ${error.message}`);\n      }\n      process.exit(1);\n    });\n\n  } catch (error: any) {\n    console.error(\"Failed to start server:\", error.message);\n    console.error(error.stack);\n    process.exit(1);\n  }\n})();\n","size_bytes":4403},"client/src/components/ProjectCard.tsx":{"content":"import { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ChevronRight, AlertTriangle } from \"lucide-react\";\nimport type { Project } from \"@shared/schema\";\n\ninterface ProjectCardProps {\n  project: Project & { milestoneCount?: number; riskCount?: number };\n  onViewDetails: (id: string) => void;\n}\n\nexport function ProjectCard({ project, onViewDetails }: ProjectCardProps) {\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"active\": return \"bg-foreground text-background\";\n      case \"completed\": return \"bg-[hsl(142,76%,36%)] text-white\";\n      case \"on-hold\": return \"bg-muted text-muted-foreground\";\n      default: return \"bg-muted text-foreground\";\n    }\n  };\n\n  return (\n    <Card className=\"hover-elevate transition-all duration-150\" data-testid={`project-card-${project.id}`}>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-start justify-between gap-2\">\n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-xl font-semibold truncate\" data-testid={`project-name-${project.id}`}>\n              {project.name}\n            </h3>\n            <p className=\"text-sm text-muted-foreground line-clamp-2 mt-1\">\n              {project.description}\n            </p>\n          </div>\n          <Badge className={`${getStatusColor(project.status)} shrink-0`} data-testid={`project-status-${project.id}`}>\n            {project.status}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"pb-3\">\n        <div className=\"flex items-center gap-4 text-sm\">\n          <div>\n            <span className=\"text-muted-foreground\">Milestones: </span>\n            <span className=\"font-medium\" data-testid={`project-milestone-count-${project.id}`}>\n              {project.milestoneCount || 0}\n            </span>\n          </div>\n          {project.riskCount !== undefined && project.riskCount > 0 && (\n            <div className=\"flex items-center gap-1 text-[hsl(0,84%,60%)]\">\n              <AlertTriangle className=\"w-4 h-4\" />\n              <span className=\"font-medium\" data-testid={`project-risk-count-${project.id}`}>\n                {project.riskCount} Risk{project.riskCount > 1 ? 's' : ''}\n              </span>\n            </div>\n          )}\n        </div>\n      </CardContent>\n      <CardFooter className=\"pt-0\">\n        <Button \n          variant=\"ghost\" \n          className=\"w-full justify-between group\" \n          onClick={() => onViewDetails(project.id)}\n          data-testid={`button-view-project-${project.id}`}\n        >\n          View Details\n          <ChevronRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\n        </Button>\n      </CardFooter>\n    </Card>\n  );\n}\n","size_bytes":2836},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, timestamp, jsonb, boolean } from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// ========== PROJECTS ==========\nexport const projects = pgTable(\"projects\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  businessUserId: varchar(\"business_user_id\").notNull(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\").notNull(),\n  status: text(\"status\").notNull().default(\"active\"), // active, completed, on-hold\n  jiraProjectKey: text(\"jira_project_key\"),\n  lastJiraSyncAt: timestamp(\"last_jira_sync_at\"),\n  lastJiraSyncStatus: text(\"last_jira_sync_status\"), // success, failed, partial\n  lastJiraSyncError: text(\"last_jira_sync_error\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const projectsRelations = relations(projects, ({ many }) => ({\n  milestones: many(milestones),\n}));\n\nexport const insertProjectSchema = createInsertSchema(projects).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertProject = z.infer<typeof insertProjectSchema>;\nexport type Project = typeof projects.$inferSelect;\n\n// ========== MILESTONES ==========\nexport const milestones = pgTable(\"milestones\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  projectId: varchar(\"project_id\").notNull().references(() => projects.id, { onDelete: \"cascade\" }),\n  name: text(\"name\").notNull(),\n  description: text(\"description\").notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, in-progress, completed, delayed\n  estimatedHours: integer(\"estimated_hours\"),\n  assignedCandidateId: varchar(\"assigned_candidate_id\"),\n  assignmentStatus: text(\"assignment_status\").default(\"unassigned\"), // unassigned, offered, confirmed, active, completed\n  assignmentConfirmedAt: timestamp(\"assignment_confirmed_at\"),\n  backupCandidateId: varchar(\"backup_candidate_id\"),\n  backupAssignmentStatus: text(\"backup_assignment_status\").default(\"none\"), // none, standby, offered, active\n  jiraIssueKey: text(\"jira_issue_key\"),\n  jiraEpicKey: text(\"jira_epic_key\"),\n  jiraSprintId: text(\"jira_sprint_id\"),\n  jiraSprintName: text(\"jira_sprint_name\"),\n  delayPercentage: integer(\"delay_percentage\").default(0),\n  riskLevel: text(\"risk_level\"), // low, medium, high, critical\n  skillMap: jsonb(\"skill_map\"), // AI-generated skill requirements\n  skillMapApproved: boolean(\"skill_map_approved\").default(false), // Business approved skill map\n  candidatesNotified: boolean(\"candidates_notified\").default(false), // Candidates have been notified\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const milestonesRelations = relations(milestones, ({ one, many }) => ({\n  project: one(projects, {\n    fields: [milestones.projectId],\n    references: [projects.id],\n  }),\n  fitScores: many(fitScores),\n}));\n\nexport const insertMilestoneSchema = createInsertSchema(milestones).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertMilestone = z.infer<typeof insertMilestoneSchema>;\nexport type Milestone = typeof milestones.$inferSelect;\n\n// ========== CANDIDATES ==========\nexport const candidates = pgTable(\"candidates\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  name: text(\"name\").notNull(),\n  phone: text(\"phone\"),\n  cvFilePath: text(\"cv_file_path\"),\n  cvAnalysis: jsonb(\"cv_analysis\"), // AI-parsed CV data\n  skills: text(\"skills\").array(),\n  experience: text(\"experience\"),\n  education: text(\"education\"),\n  linkedinUrl: text(\"linkedin_url\"),\n  githubUrl: text(\"github_url\"),\n  availableFrom: timestamp(\"available_from\"),\n  availableUntil: timestamp(\"available_until\"),\n  isAvailable: boolean(\"is_available\").default(true),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const candidatesRelations = relations(candidates, ({ many }) => ({\n  fitScores: many(fitScores),\n}));\n\nexport const insertCandidateSchema = createInsertSchema(candidates).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertCandidate = z.infer<typeof insertCandidateSchema>;\nexport type Candidate = typeof candidates.$inferSelect;\n\n// ========== FIT SCORES ==========\nexport const fitScores = pgTable(\"fit_scores\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  candidateId: varchar(\"candidate_id\").notNull().references(() => candidates.id, { onDelete: \"cascade\" }),\n  milestoneId: varchar(\"milestone_id\").notNull().references(() => milestones.id, { onDelete: \"cascade\" }),\n  score: integer(\"score\").notNull(), // 0-100\n  skillOverlap: integer(\"skill_overlap\"),\n  experienceMatch: integer(\"experience_match\"),\n  softSkillRelevance: integer(\"soft_skill_relevance\"),\n  reasoning: text(\"reasoning\"), // AI reasoning for the score\n  status: text(\"status\").default(\"pending\"), // pending, accepted, rejected\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const fitScoresRelations = relations(fitScores, ({ one }) => ({\n  candidate: one(candidates, {\n    fields: [fitScores.candidateId],\n    references: [candidates.id],\n  }),\n  milestone: one(milestones, {\n    fields: [fitScores.milestoneId],\n    references: [milestones.id],\n  }),\n}));\n\nexport const insertFitScoreSchema = createInsertSchema(fitScores).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertFitScore = z.infer<typeof insertFitScoreSchema>;\nexport type FitScore = typeof fitScores.$inferSelect;\n\n// ========== RISK ALERTS ==========\nexport const riskAlerts = pgTable(\"risk_alerts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  milestoneId: varchar(\"milestone_id\").notNull().references(() => milestones.id, { onDelete: \"cascade\" }),\n  riskLevel: text(\"risk_level\").notNull(), // low, medium, high\n  delayPercentage: integer(\"delay_percentage\").notNull(),\n  aiAnalysis: jsonb(\"ai_analysis\"), // Gemini risk prediction\n  backupActivated: boolean(\"backup_activated\").default(false),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const riskAlertsRelations = relations(riskAlerts, ({ one }) => ({\n  milestone: one(milestones, {\n    fields: [riskAlerts.milestoneId],\n    references: [milestones.id],\n  }),\n}));\n\nexport const insertRiskAlertSchema = createInsertSchema(riskAlerts).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertRiskAlert = z.infer<typeof insertRiskAlertSchema>;\nexport type RiskAlert = typeof riskAlerts.$inferSelect;\n\n// ========== SAVED JOBS ==========\nexport const savedJobs = pgTable(\"saved_jobs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  candidateId: varchar(\"candidate_id\").notNull().references(() => candidates.id, { onDelete: \"cascade\" }),\n  milestoneId: varchar(\"milestone_id\").notNull().references(() => milestones.id, { onDelete: \"cascade\" }),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const savedJobsRelations = relations(savedJobs, ({ one }) => ({\n  candidate: one(candidates, {\n    fields: [savedJobs.candidateId],\n    references: [candidates.id],\n  }),\n  milestone: one(milestones, {\n    fields: [savedJobs.milestoneId],\n    references: [milestones.id],\n  }),\n}));\n\nexport const insertSavedJobSchema = createInsertSchema(savedJobs).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertSavedJob = z.infer<typeof insertSavedJobSchema>;\nexport type SavedJob = typeof savedJobs.$inferSelect;\n\n// ========== APPLICATIONS ==========\nexport const applications = pgTable(\"applications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  candidateId: varchar(\"candidate_id\").notNull().references(() => candidates.id, { onDelete: \"cascade\" }),\n  milestoneId: varchar(\"milestone_id\").notNull().references(() => milestones.id, { onDelete: \"cascade\" }),\n  projectId: varchar(\"project_id\").notNull().references(() => projects.id, { onDelete: \"cascade\" }),\n  status: text(\"status\").notNull().default(\"submitted\"), // submitted, under_review, interview, accepted, rejected\n  coverLetter: text(\"cover_letter\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const applicationsRelations = relations(applications, ({ one }) => ({\n  candidate: one(candidates, {\n    fields: [applications.candidateId],\n    references: [candidates.id],\n  }),\n  milestone: one(milestones, {\n    fields: [applications.milestoneId],\n    references: [milestones.id],\n  }),\n  project: one(projects, {\n    fields: [applications.projectId],\n    references: [projects.id],\n  }),\n}));\n\nexport const insertApplicationSchema = createInsertSchema(applications).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertApplication = z.infer<typeof insertApplicationSchema>;\nexport type Application = typeof applications.$inferSelect;\n\n// ========== CANDIDATE ACTIONS (Save/Skip) ==========\nexport const candidateActions = pgTable(\"candidate_actions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  candidateId: varchar(\"candidate_id\").notNull().references(() => candidates.id, { onDelete: \"cascade\" }),\n  milestoneId: varchar(\"milestone_id\").notNull().references(() => milestones.id, { onDelete: \"cascade\" }),\n  action: text(\"action\").notNull(), // save, skip, view\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const candidateActionsRelations = relations(candidateActions, ({ one }) => ({\n  candidate: one(candidates, {\n    fields: [candidateActions.candidateId],\n    references: [candidates.id],\n  }),\n  milestone: one(milestones, {\n    fields: [candidateActions.milestoneId],\n    references: [milestones.id],\n  }),\n}));\n\nexport const insertCandidateActionSchema = createInsertSchema(candidateActions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertCandidateAction = z.infer<typeof insertCandidateActionSchema>;\nexport type CandidateAction = typeof candidateActions.$inferSelect;\n\n// ========== BUSINESS INTERESTS (Multi-Business Competition) ==========\nexport const businessInterests = pgTable(\"business_interests\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  businessUserId: varchar(\"business_user_id\").notNull(),\n  candidateId: varchar(\"candidate_id\").notNull().references(() => candidates.id, { onDelete: \"cascade\" }),\n  milestoneId: varchar(\"milestone_id\").notNull().references(() => milestones.id, { onDelete: \"cascade\" }),\n  projectId: varchar(\"project_id\").notNull().references(() => projects.id, { onDelete: \"cascade\" }),\n  status: text(\"status\").notNull().default(\"interested\"), // interested, offered, accepted, rejected, withdrawn\n  offerBudget: integer(\"offer_budget\"), // Budget offered for this milestone\n  priorityScore: integer(\"priority_score\"), // Calculated: fit 40% + budget 30% + preference 30%\n  candidatePreference: integer(\"candidate_preference\"), // Candidate's rating 1-5 for this opportunity\n  notes: text(\"notes\"), // Business notes about why they want this candidate\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const businessInterestsRelations = relations(businessInterests, ({ one }) => ({\n  candidate: one(candidates, {\n    fields: [businessInterests.candidateId],\n    references: [candidates.id],\n  }),\n  milestone: one(milestones, {\n    fields: [businessInterests.milestoneId],\n    references: [milestones.id],\n  }),\n  project: one(projects, {\n    fields: [businessInterests.projectId],\n    references: [projects.id],\n  }),\n}));\n\nexport const insertBusinessInterestSchema = createInsertSchema(businessInterests).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertBusinessInterest = z.infer<typeof insertBusinessInterestSchema>;\nexport type BusinessInterest = typeof businessInterests.$inferSelect;\n\n// ========== SKILL MAP TYPE ==========\nexport const skillMapSchema = z.object({\n  milestone: z.string(),\n  required_skills: z.array(z.string()),\n  experience_level: z.string(),\n  soft_skills: z.array(z.string()),\n});\n\nexport type SkillMap = z.infer<typeof skillMapSchema>;\n\n// ========== CV ANALYSIS TYPE ==========\nexport const cvAnalysisSchema = z.object({\n  name: z.string(),\n  email: z.string().optional(),\n  skills: z.array(z.string()),\n  experience: z.string(),\n  education: z.string(),\n  soft_skills: z.array(z.string()).optional(),\n  domain_expertise: z.array(z.string()).optional(),\n});\n\nexport type CVAnalysis = z.infer<typeof cvAnalysisSchema>;\n\n// ========== JIRA SETTINGS ==========\nexport const jiraSettings = pgTable(\"jira_settings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  businessUserId: varchar(\"business_user_id\").notNull().unique(),\n  jiraDomain: text(\"jira_domain\"), // e.g., \"company.atlassian.net\"\n  jiraEmail: text(\"jira_email\"),\n  jiraApiToken: text(\"jira_api_token\"), // Encrypted API token\n  connectionType: text(\"connection_type\").default(\"replit_connector\"), // replit_connector or manual\n  isConfigured: boolean(\"is_configured\").default(false),\n  lastSyncedAt: timestamp(\"last_synced_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const insertJiraSettingsSchema = createInsertSchema(jiraSettings).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  jiraApiToken: z.string().optional(), // Make optional for updates - existing token will be preserved\n});\n\nexport type InsertJiraSettings = z.infer<typeof insertJiraSettingsSchema>;\nexport type JiraSettings = typeof jiraSettings.$inferSelect;\n\n// ========== MAGIC LINKS ==========\nexport const magicLinks = pgTable(\"magic_links\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  token: varchar(\"token\", { length: 255 }).notNull().unique(),\n  email: text(\"email\").notNull(),\n  userId: varchar(\"user_id\"), // Null if shadow account\n  role: text(\"role\").default(\"candidate\"), // candidate or business\n  used: boolean(\"used\").default(false).notNull(),\n  ipAddress: text(\"ip_address\"),\n  userAgent: text(\"user_agent\"),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  usedAt: timestamp(\"used_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertMagicLinkSchema = createInsertSchema(magicLinks).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertMagicLink = z.infer<typeof insertMagicLinkSchema>;\nexport type MagicLink = typeof magicLinks.$inferSelect;\n\n// ========== BACKGROUND JOBS ==========\nexport const backgroundJobs = pgTable(\"background_jobs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  jobType: text(\"job_type\").notNull(), // cv_processing, fit_score_calculation, jira_sync\n  status: text(\"status\").notNull().default(\"pending\"), // pending, processing, completed, failed\n  userId: varchar(\"user_id\").notNull(), // candidate or business user id\n  userEmail: text(\"user_email\"), // for email notifications\n  payload: jsonb(\"payload\"), // job-specific data\n  result: jsonb(\"result\"), // job output\n  error: text(\"error\"), // error message if failed\n  progress: integer(\"progress\").default(0), // 0-100\n  attempts: integer(\"attempts\").default(0),\n  maxAttempts: integer(\"max_attempts\").default(3),\n  startedAt: timestamp(\"started_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertBackgroundJobSchema = createInsertSchema(backgroundJobs).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertBackgroundJob = z.infer<typeof insertBackgroundJobSchema>;\nexport type BackgroundJob = typeof backgroundJobs.$inferSelect;\n\n// ========== JIRA SYNC LOGS ==========\nexport const jiraSyncLogs = pgTable(\"jira_sync_logs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  businessUserId: varchar(\"business_user_id\").notNull(),\n  syncType: text(\"sync_type\").notNull(), // import_projects, sync_project, sync_milestone\n  status: text(\"status\").notNull(), // success, failed, partial\n  projectId: varchar(\"project_id\"),\n  jiraProjectKey: text(\"jira_project_key\"),\n  milestonesCreated: integer(\"milestones_created\").default(0),\n  milestonesUpdated: integer(\"milestones_updated\").default(0),\n  error: text(\"error\"), // Error message if failed\n  errorDetails: jsonb(\"error_details\"), // Detailed error stack/context\n  canRetry: boolean(\"can_retry\").default(true),\n  retryCount: integer(\"retry_count\").default(0),\n  startedAt: timestamp(\"started_at\").notNull().defaultNow(),\n  completedAt: timestamp(\"completed_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertJiraSyncLogSchema = createInsertSchema(jiraSyncLogs).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertJiraSyncLog = z.infer<typeof insertJiraSyncLogSchema>;\nexport type JiraSyncLog = typeof jiraSyncLogs.$inferSelect;\n\n// ========== SESSIONS (Express Session Store) ==========\nexport const sessions = pgTable(\"sessions\", {\n  sid: varchar(\"sid\").primaryKey(),\n  sess: jsonb(\"sess\").notNull(),\n  expire: timestamp(\"expire\").notNull(),\n});\n\nexport type Session = typeof sessions.$inferSelect;\n","size_bytes":17266},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/pages/LandingPage.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { \n  Users, \n  Building2, \n  ArrowRight, \n  Sparkles, \n  CheckCircle2,\n  Zap,\n  Brain,\n  TrendingUp,\n  Shield\n} from \"lucide-react\";\nimport { useLocation } from \"wouter\";\n\nexport default function LandingPage() {\n  const [, setLocation] = useLocation();\n\n  const features = [\n    {\n      icon: Brain,\n      title: \"AI-Powered Matching\",\n      description: \"Google Gemini analyzes skills and experience to generate precise fit scores between candidates and projects\"\n    },\n    {\n      icon: Zap,\n      title: \"Instant CV Analysis\",\n      description: \"Automatic parsing and skill extraction from CVs in seconds, creating comprehensive talent profiles\"\n    },\n    {\n      icon: TrendingUp,\n      title: \"Real-Time Tracking\",\n      description: \"Jira integration monitors project progress and predicts delays before they impact delivery\"\n    },\n    {\n      icon: Shield,\n      title: \"Automated Backup\",\n      description: \"AI detects risks and activates backup candidates automatically to ensure project continuity\"\n    }\n  ];\n\n  const workflows = [\n    {\n      number: \"01\",\n      title: \"Talent Pool Automation\",\n      description: \"Candidates sign up, upload CVs, and AI extracts skills, experience, and domain expertise automatically\",\n      steps: [\"CV Upload\", \"AI Analysis\", \"Skill Extraction\", \"Profile Creation\"]\n    },\n    {\n      number: \"02\",\n      title: \"Intelligent Matching\",\n      description: \"Businesses create projects, AI generates skill maps, and ranks candidates by comprehensive fit scores\",\n      steps: [\"Project Setup\", \"Skill Mapping\", \"Fit Calculation\", \"Candidate Ranking\"]\n    },\n    {\n      number: \"03\",\n      title: \"Project Continuity\",\n      description: \"System monitors Jira progress, detects delays, predicts risks, and activates backup talent seamlessly\",\n      steps: [\"Jira Sync\", \"Delay Detection\", \"Risk Prediction\", \"Backup Activation\"]\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-50 border-b bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/80\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex h-16 items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-8 h-8 bg-black rounded-md flex items-center justify-center\">\n                <Sparkles className=\"w-5 h-5 text-white\" />\n              </div>\n              <h1 className=\"text-xl font-bold\" data-testid=\"app-title\">\n                Lean Workforce\n              </h1>\n            </div>\n            <div className=\"flex gap-3\">\n              <Button \n                variant=\"outline\"\n                onClick={() => setLocation(\"/business-login\")}\n                data-testid=\"button-login-business\"\n              >\n                Business Login\n              </Button>\n              <Button \n                onClick={() => setLocation(\"/candidate-login\")}\n                data-testid=\"button-login-candidate\"\n              >\n                Candidate Login\n              </Button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Hero Section */}\n      <section className=\"relative py-20 sm:py-32\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"max-w-3xl mx-auto text-center\">\n            <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full border border-border bg-white mb-8\">\n              <Sparkles className=\"w-4 h-4\" />\n              <span className=\"text-sm font-medium\">Powered by LeanfounderSpace</span>\n            </div>\n            \n            <h2 className=\"text-5xl sm:text-6xl font-bold tracking-tight mb-6\" data-testid=\"landing-title\">\n              Intelligent Talent Matching\n              <span className=\"block mt-2\">For Modern Teams</span>\n            </h2>\n            \n            <p className=\"text-xl text-muted-foreground mb-10 max-w-2xl mx-auto\">\n              AI-powered workforce operating system that automates talent matching, \n              predicts project risks, and ensures continuity with real-time Jira integration\n            </p>\n\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n              <Button \n                size=\"lg\" \n                className=\"group\"\n                onClick={() => setLocation(\"/business-login\")}\n                data-testid=\"button-hero-business\"\n              >\n                Start as Business\n                <ArrowRight className=\"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform\" />\n              </Button>\n              <Button \n                size=\"lg\" \n                variant=\"outline\"\n                onClick={() => setLocation(\"/candidate-login\")}\n                data-testid=\"button-hero-candidate\"\n              >\n                Join as Candidate\n              </Button>\n            </div>\n\n            <div className=\"mt-12 flex flex-wrap items-center justify-center gap-x-8 gap-y-4 text-sm text-muted-foreground\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"w-4 h-4 text-black\" />\n                <span>AI Skill Extraction</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"w-4 h-4 text-black\" />\n                <span>0-100 Fit Scores</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"w-4 h-4 text-black\" />\n                <span>Automatic Risk Detection</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Features Grid */}\n      <section className=\"py-20 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-16\">\n            <h3 className=\"text-3xl font-bold mb-4\">\n              Everything You Need for Workforce Automation\n            </h3>\n            <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n              Built for businesses managing complex projects and candidates seeking the perfect match\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {features.map((feature, index) => (\n              <Card key={index} className=\"hover-elevate transition-all duration-150\">\n                <CardContent className=\"p-6\">\n                  <div className=\"w-12 h-12 bg-black rounded-md flex items-center justify-center mb-4\">\n                    <feature.icon className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <h4 className=\"text-lg font-semibold mb-2\">{feature.title}</h4>\n                  <p className=\"text-sm text-muted-foreground\">{feature.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* How It Works */}\n      <section className=\"py-20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-16\">\n            <h3 className=\"text-3xl font-bold mb-4\">\n              How It Works\n            </h3>\n            <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n              Three automated workflows powered by Google Gemini AI and Jira integration\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            {workflows.map((workflow, index) => (\n              <div key={index} className=\"relative\">\n                <div className=\"mb-6\">\n                  <div className=\"text-5xl font-bold text-muted-foreground/20 mb-4\">\n                    {workflow.number}\n                  </div>\n                  <h4 className=\"text-xl font-semibold mb-2\">{workflow.title}</h4>\n                  <p className=\"text-sm text-muted-foreground mb-4\">{workflow.description}</p>\n                </div>\n\n                <div className=\"space-y-2\">\n                  {workflow.steps.map((step, stepIndex) => (\n                    <div key={stepIndex} className=\"flex items-center gap-3\">\n                      <div className=\"w-6 h-6 rounded-full border-2 border-black flex items-center justify-center flex-shrink-0\">\n                        <div className=\"w-2 h-2 rounded-full bg-black\" />\n                      </div>\n                      <span className=\"text-sm font-medium\">{step}</span>\n                    </div>\n                  ))}\n                </div>\n\n                {index < workflows.length - 1 && (\n                  <div className=\"hidden md:block absolute top-8 -right-4 w-8 h-0.5 bg-border\" />\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Portal CTAs */}\n      <section className=\"py-20 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"grid md:grid-cols-2 gap-8\">\n            <Card \n              className=\"hover-elevate transition-all duration-150 cursor-pointer border-2\" \n              onClick={() => setLocation(\"/business-login\")} \n              data-testid=\"card-business\"\n            >\n              <CardContent className=\"p-10\">\n                <div className=\"flex items-center gap-4 mb-6\">\n                  <div className=\"w-16 h-16 bg-black rounded-lg flex items-center justify-center\">\n                    <Building2 className=\"w-8 h-8 text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-2xl font-bold\">Business Portal</h3>\n                    <p className=\"text-sm text-muted-foreground\">For hiring teams</p>\n                  </div>\n                </div>\n                \n                <ul className=\"space-y-3 mb-8\">\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">Create projects with AI-generated skill maps</span>\n                  </li>\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">View candidates ranked by fit scores (0-100)</span>\n                  </li>\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">Monitor risks and activate backup talent</span>\n                  </li>\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">Import projects directly from Jira</span>\n                  </li>\n                </ul>\n\n                <Button className=\"w-full group\" size=\"lg\" data-testid=\"button-enter-business\">\n                  Enter Business Portal\n                  <ArrowRight className=\"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card \n              className=\"hover-elevate transition-all duration-150 cursor-pointer border-2\" \n              onClick={() => setLocation(\"/candidate-login\")} \n              data-testid=\"card-candidate\"\n            >\n              <CardContent className=\"p-10\">\n                <div className=\"flex items-center gap-4 mb-6\">\n                  <div className=\"w-16 h-16 bg-black rounded-lg flex items-center justify-center\">\n                    <Users className=\"w-8 h-8 text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-2xl font-bold\">Candidate Portal</h3>\n                    <p className=\"text-sm text-muted-foreground\">For professionals</p>\n                  </div>\n                </div>\n                \n                <ul className=\"space-y-3 mb-8\">\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">Upload CV for instant AI skill extraction</span>\n                  </li>\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">Browse projects matched to your expertise</span>\n                  </li>\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">See fit scores for every opportunity</span>\n                  </li>\n                  <li className=\"flex items-start gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />\n                    <span className=\"text-sm\">Declare availability and get matched</span>\n                  </li>\n                </ul>\n\n                <Button className=\"w-full group\" size=\"lg\" data-testid=\"button-enter-candidate\">\n                  Enter Candidate Portal\n                  <ArrowRight className=\"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"py-20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 text-center\">\n            <div>\n              <div className=\"text-4xl font-bold mb-2\">100%</div>\n              <div className=\"text-sm text-muted-foreground\">Automated Matching</div>\n            </div>\n            <div>\n              <div className=\"text-4xl font-bold mb-2\">0-100</div>\n              <div className=\"text-sm text-muted-foreground\">Fit Score Range</div>\n            </div>\n            <div>\n              <div className=\"text-4xl font-bold mb-2\">Real-time</div>\n              <div className=\"text-sm text-muted-foreground\">Risk Detection</div>\n            </div>\n            <div>\n              <div className=\"text-4xl font-bold mb-2\">AI</div>\n              <div className=\"text-sm text-muted-foreground\">Powered Analysis</div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"border-t bg-muted/20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          {/* Main Footer Content */}\n          <div className=\"py-12 grid grid-cols-2 md:grid-cols-4 gap-8\">\n            {/* Brand Column */}\n            <div className=\"col-span-2 md:col-span-1\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <div className=\"w-8 h-8 bg-black rounded-md flex items-center justify-center\">\n                  <Sparkles className=\"w-5 h-5 text-white\" />\n                </div>\n                <span className=\"font-semibold\">Lean Workforce</span>\n              </div>\n              <p className=\"text-sm text-muted-foreground mb-4\">\n                Intelligent talent matching powered by AI for modern teams\n              </p>\n              <p className=\"text-xs text-muted-foreground\">\n                Powered by LeanfounderSpace\n              </p>\n            </div>\n\n            {/* Platform Column */}\n            <div>\n              <h4 className=\"font-semibold mb-4\">Platform</h4>\n              <ul className=\"space-y-3 text-sm\">\n                <li>\n                  <button \n                    onClick={() => setLocation(\"/business-login\")}\n                    className=\"text-muted-foreground hover:text-foreground transition-colors\"\n                  >\n                    Business Login\n                  </button>\n                </li>\n                <li>\n                  <button \n                    onClick={() => setLocation(\"/candidate-login\")}\n                    className=\"text-muted-foreground hover:text-foreground transition-colors\"\n                  >\n                    Candidate Login\n                  </button>\n                </li>\n                <li>\n                  <a href=\"#features\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    Features\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#how-it-works\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    How It Works\n                  </a>\n                </li>\n              </ul>\n            </div>\n\n            {/* Company Column */}\n            <div>\n              <h4 className=\"font-semibold mb-4\">Company</h4>\n              <ul className=\"space-y-3 text-sm\">\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    About Us\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    Contact\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    Careers\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    Blog\n                  </a>\n                </li>\n              </ul>\n            </div>\n\n            {/* Resources Column */}\n            <div>\n              <h4 className=\"font-semibold mb-4\">Resources</h4>\n              <ul className=\"space-y-3 text-sm\">\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    Documentation\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    API Reference\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    Support\n                  </a>\n                </li>\n                <li>\n                  <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                    Status\n                  </a>\n                </li>\n              </ul>\n            </div>\n          </div>\n\n          {/* Bottom Bar */}\n          <div className=\"border-t py-6\">\n            <div className=\"flex flex-col md:flex-row items-center justify-between gap-4\">\n              <div className=\"text-sm text-muted-foreground\">\n                © {new Date().getFullYear()} Lean Workforce. All rights reserved.\n              </div>\n              <div className=\"flex gap-6 text-sm\">\n                <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                  Privacy Policy\n                </a>\n                <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                  Terms of Service\n                </a>\n                <a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">\n                  Cookie Policy\n                </a>\n              </div>\n            </div>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","size_bytes":19718},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/pages/ProjectDetail.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { MilestoneTimeline } from \"@/components/MilestoneTimeline\";\nimport { CandidateCard } from \"@/components/CandidateCard\";\nimport { GroupedTasksView } from \"@/components/GroupedTasksView\";\nimport { ArrowLeft, AlertTriangle, Users, Target, RefreshCw, List } from \"lucide-react\";\nimport { useLocation, useParams } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Project, Milestone, Candidate } from \"@shared/schema\";\nimport { useState } from \"react\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\nexport default function ProjectDetail() {\n  const [, setLocation] = useLocation();\n  const params = useParams();\n  const projectId = params.id;\n  const { toast } = useToast();\n  const [groupBy, setGroupBy] = useState<\"epic\" | \"sprint\" | \"none\">(\"sprint\");\n  const [viewMode, setViewMode] = useState<\"timeline\" | \"grouped\">(\"grouped\");\n\n  const { data: project, isLoading: projectLoading } = useQuery<Project>({\n    queryKey: [\"/api/projects\", projectId],\n  });\n\n  const { data: milestones = [] } = useQuery<Milestone[]>({\n    queryKey: [\"/api/projects\", projectId, \"milestones\"],\n  });\n\n  const { data: topCandidates = [] } = useQuery<Candidate[]>({\n    queryKey: [\"/api/projects\", projectId, \"candidates\"],\n  });\n\n  const { data: riskAlerts = [] } = useQuery<any[]>({\n    queryKey: [\"/api/projects\", projectId, \"risks\"],\n  });\n\n  const syncJiraMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/projects/${projectId}/sync-jira`, {});\n    },\n    onSuccess: (data: any) => {\n      toast({\n        title: \"Sync Complete\",\n        description: data.message || `Successfully synced ${data.synced} tasks from Jira`,\n      });\n      // Invalidate queries to refresh the data\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"milestones\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"candidates\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", projectId, \"risks\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Sync Failed\",\n        description: error.message || \"Failed to sync tasks from Jira\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (projectLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-lg text-muted-foreground\">Loading project...</div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!project) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-lg font-semibold mb-2\">Project not found</div>\n          <Button onClick={() => setLocation(\"/business\")}>Back to Dashboard</Button>\n        </div>\n      </div>\n    );\n  }\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"active\": return \"bg-foreground text-background\";\n      case \"completed\": return \"bg-[hsl(142,76%,36%)] text-white\";\n      case \"on-hold\": return \"bg-muted text-muted-foreground\";\n      default: return \"bg-muted text-foreground\";\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b border-border bg-white sticky top-0 z-50\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={() => setLocation(\"/business\")}\n              data-testid=\"button-back\"\n            >\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n            <div className=\"flex-1\">\n              <h1 className=\"text-2xl font-bold\" data-testid=\"project-name\">{project.name}</h1>\n              <p className=\"text-sm text-muted-foreground\">{project.description}</p>\n            </div>\n            {project.jiraProjectKey && (\n              <Button \n                variant=\"outline\"\n                onClick={() => syncJiraMutation.mutate()}\n                disabled={syncJiraMutation.isPending}\n                data-testid=\"button-sync-jira\"\n              >\n                <RefreshCw className={`w-4 h-4 mr-2 ${syncJiraMutation.isPending ? 'animate-spin' : ''}`} />\n                {syncJiraMutation.isPending ? \"Syncing...\" : \"Sync Tasks from Jira\"}\n              </Button>\n            )}\n            <Badge className={getStatusColor(project.status)} data-testid=\"project-status\">\n              {project.status}\n            </Badge>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 py-8\">\n        {riskAlerts.length > 0 && (\n          <Card className=\"mb-6 border-[hsl(0,84%,60%)]\" data-testid=\"risk-alerts-card\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center gap-2\">\n                <AlertTriangle className=\"w-5 h-5 text-[hsl(0,84%,60%)]\" />\n                <CardTitle className=\"text-lg\">Risk Alerts ({riskAlerts.length})</CardTitle>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {riskAlerts.map((alert: any) => (\n                  <div key={alert.id} className=\"p-3 border border-border rounded-md\" data-testid={`risk-alert-${alert.id}`}>\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex-1\">\n                        <div className=\"font-medium\">{alert.milestoneName}</div>\n                        <div className=\"text-sm text-muted-foreground\">\n                          Delay: {alert.delayPercentage}% | Risk Level: {alert.riskLevel}\n                        </div>\n                      </div>\n                      <Badge className=\"bg-[hsl(0,84%,60%)] text-white shrink-0\">\n                        {alert.riskLevel}\n                      </Badge>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        <Tabs defaultValue=\"milestones\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-3 max-w-md\">\n            <TabsTrigger value=\"milestones\" data-testid=\"tab-milestones\">\n              <Target className=\"w-4 h-4 mr-2\" />\n              Milestones\n            </TabsTrigger>\n            <TabsTrigger value=\"candidates\" data-testid=\"tab-candidates\">\n              <Users className=\"w-4 h-4 mr-2\" />\n              Candidates\n            </TabsTrigger>\n            <TabsTrigger value=\"overview\" data-testid=\"tab-overview\">\n              Overview\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"milestones\" className=\"space-y-4\">\n            <div className=\"flex items-center justify-between mb-4 gap-4 flex-wrap\">\n              <h2 className=\"text-xl font-semibold\">Project Tasks</h2>\n              <div className=\"flex items-center gap-3\">\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant={viewMode === \"timeline\" ? \"default\" : \"outline\"}\n                    size=\"sm\"\n                    onClick={() => setViewMode(\"timeline\")}\n                    data-testid=\"button-view-timeline\"\n                  >\n                    <Target className=\"w-4 h-4 mr-2\" />\n                    Timeline\n                  </Button>\n                  <Button\n                    variant={viewMode === \"grouped\" ? \"default\" : \"outline\"}\n                    size=\"sm\"\n                    onClick={() => setViewMode(\"grouped\")}\n                    data-testid=\"button-view-grouped\"\n                  >\n                    <List className=\"w-4 h-4 mr-2\" />\n                    Grouped\n                  </Button>\n                </div>\n                {viewMode === \"grouped\" && (\n                  <Select value={groupBy} onValueChange={(value: any) => setGroupBy(value)}>\n                    <SelectTrigger className=\"w-[150px]\" data-testid=\"select-group-by\">\n                      <SelectValue placeholder=\"Group by...\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"none\">No Grouping</SelectItem>\n                      <SelectItem value=\"epic\">By Epic</SelectItem>\n                      <SelectItem value=\"sprint\">By Sprint</SelectItem>\n                    </SelectContent>\n                  </Select>\n                )}\n                <div className=\"text-sm text-muted-foreground\">\n                  {milestones.length} task{milestones.length !== 1 ? 's' : ''}\n                </div>\n              </div>\n            </div>\n            {milestones.length === 0 ? (\n              <Card className=\"py-12\">\n                <CardContent className=\"text-center text-muted-foreground\">\n                  No tasks defined yet\n                </CardContent>\n              </Card>\n            ) : viewMode === \"timeline\" ? (\n              <MilestoneTimeline milestones={milestones} />\n            ) : (\n              <GroupedTasksView milestones={milestones} groupBy={groupBy} />\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"candidates\" className=\"space-y-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h2 className=\"text-xl font-semibold\">Top Matched Candidates</h2>\n              <div className=\"text-sm text-muted-foreground\">\n                {topCandidates.length} candidate{topCandidates.length !== 1 ? 's' : ''}\n              </div>\n            </div>\n            {topCandidates.length === 0 ? (\n              <Card className=\"py-12\">\n                <CardContent className=\"text-center\">\n                  <Users className=\"w-16 h-16 mx-auto text-muted-foreground mb-4\" />\n                  <h3 className=\"text-xl font-semibold mb-2\">No candidates matched yet</h3>\n                  <p className=\"text-muted-foreground\">\n                    The AI will automatically match candidates once they register and upload their CVs.\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {topCandidates.map((candidate: any) => (\n                  <CandidateCard\n                    key={candidate.id}\n                    candidate={candidate}\n                    fitScore={candidate.fitScore}\n                    showFitScore={true}\n                  />\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"overview\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Project Information</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <div className=\"text-sm font-medium text-muted-foreground mb-1\">Description</div>\n                  <p className=\"text-sm\">{project.description}</p>\n                </div>\n                {project.jiraProjectKey && (\n                  <div>\n                    <div className=\"text-sm font-medium text-muted-foreground mb-1\">Jira Project Key</div>\n                    <p className=\"text-sm font-mono\">{project.jiraProjectKey}</p>\n                  </div>\n                )}\n                <div>\n                  <div className=\"text-sm font-medium text-muted-foreground mb-1\">Created</div>\n                  <p className=\"text-sm\">{new Date(project.createdAt).toLocaleDateString()}</p>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </main>\n    </div>\n  );\n}\n","size_bytes":12161},"design_guidelines.md":{"content":"# Lean Workforce - Design Guidelines\n\n## Design Approach\n\n**System-Based Approach**: Given the utility-focused, data-dense nature of this workforce automation platform, we're using a **minimalist monochrome design system** inspired by the user's reference, prioritizing clarity, workflow visualization, and professional enterprise aesthetics.\n\n## Core Design Principles\n\n1. **Workflow-First Visualization**: Every major feature is represented as a clear, linear process flow\n2. **Data Clarity**: Information hierarchy through typography and spacing, not color\n3. **Minimalist Enterprise**: Clean, professional, distraction-free interface\n4. **Dual-Context Design**: Consistent patterns across Business and Candidate portals with role-appropriate emphasis\n\n---\n\n## Color Palette\n\n### Monochrome Foundation\n- **Primary Black**: 0 0% 0% - Headers, primary text, workflow titles, CTAs\n- **Pure White**: 0 0% 100% - Backgrounds, card fills, modal surfaces\n- **Border Gray**: 0 0% 88% - Card borders, dividers, input outlines\n- **Muted Gray**: 0 0% 74% - Secondary text, disabled states, subtle elements\n- **Background Gray**: 0 0% 96% - Page backgrounds, alternate row colors\n\n### Functional Accents (Minimal Use)\n- **Success**: 142 76% 36% - Backup activation, high fit scores (>80%)\n- **Warning**: 38 92% 50% - Medium risk alerts, delays detected\n- **Danger**: 0 84% 60% - High risk predictions, critical issues\n- **Info**: 221 83% 53% - AI processing states, new recommendations\n\n*Use color sparingly - only for status indicators and alerts. Default to grayscale for 95% of the interface.*\n\n---\n\n## Typography\n\n**Font Family**: Inter (Google Fonts)\n- Primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif\n\n### Type Scale\n- **Hero/Display**: text-4xl (2.25rem) / font-bold - Portal landing pages, empty states\n- **Page Headers**: text-3xl (1.875rem) / font-semibold - Dashboard titles, section headers\n- **Card Titles**: text-xl (1.25rem) / font-semibold - Workflow steps, milestone names\n- **Body Text**: text-base (1rem) / font-normal - Descriptions, form labels, content\n- **Secondary**: text-sm (0.875rem) / font-normal - Metadata, timestamps, helper text\n- **Micro**: text-xs (0.75rem) / font-medium - Tags, status badges, fit scores\n\n### Text Colors\n- Primary text: black (0 0% 0%)\n- Secondary text: muted gray (0 0% 45%)\n- Disabled: border gray (0 0% 74%)\n\n---\n\n## Layout System\n\n**Spacing Primitives**: Use Tailwind units of **4, 8, 12, 16, 24** for consistency\n- Component padding: p-4, p-6, p-8\n- Section spacing: py-12, py-16, py-24\n- Grid gaps: gap-4, gap-6, gap-8\n- Margins: m-4, m-8, m-12\n\n### Container Structure\n- **Full-width sections**: w-full with max-w-7xl mx-auto\n- **Dashboard grids**: max-w-6xl for content-heavy layouts\n- **Form containers**: max-w-2xl for focused input flows\n- **Workflow columns**: 3-column grid (grid-cols-3) on desktop, stack on mobile\n\n### Responsive Breakpoints\n- Mobile: Base (single column, stacked workflows)\n- Tablet: md: (2-column grids, condensed navigation)\n- Desktop: lg: (3-column workflows, full sidebar navigation)\n\n---\n\n## Component Library\n\n### Navigation\n**Business Portal Header**\n- White background, subtle bottom border (border-gray)\n- Logo left-aligned (black text or simple icon)\n- Main nav center: Projects, Candidates, Analytics, Settings\n- Right: Notification bell + User avatar dropdown\n- Height: h-16\n\n**Candidate Portal Header**\n- Same structure, different menu items\n- Main nav: Dashboard, Opportunities, My Profile, Calendar\n- Badge on \"Opportunities\" for new recommendations (>70% fit)\n\n### Workflow Visualization Cards\n**Three-Column Flow Layout** (inspired by reference image)\n```\nStructure:\n- Black header box with white text (workflow title)\n- Vertical stack of gray-bordered cards (steps)\n- Thin vertical line connectors between steps\n- Clean spacing: gap-8 between columns, gap-2 between steps\n\nVisual Specs:\n- Header: bg-black text-white px-4 py-2 rounded-md font-semibold\n- Step cards: border border-gray-300 px-4 py-3 rounded-md bg-white\n- Connector lines: h-6 w-px bg-gray-300\n- Hover state: border-black transition (subtle interaction)\n```\n\n**Example Workflows**:\n1. **Talent Pool Automation**: Signup → CV Parse → Skill Extract → Pool Save\n2. **AI Matching**: Project Create → Skill Map → Fit Score → Ranking\n3. **Continuity AI**: Jira Sync → Delay Detect → Risk Assess → Backup Activate\n\n### Data Display Cards\n\n**Candidate Profile Card**\n- White background, subtle border\n- Header: Name (text-xl bold) + Availability tag (text-xs border px-2 py-1)\n- Skills section: Horizontal chip list (border pills, no background color)\n- Fit score: Large percentage number (text-3xl) with \"Match\" label\n- Footer: CTA buttons (outlined black border, white fill)\n\n**Project Dashboard Card**\n- Timeline visualization: Horizontal progress bars (black fill, gray background)\n- Milestone list: Collapsible accordion, chevron indicators\n- Risk indicator: Color-coded badge (top-right corner) - only when needed\n- Candidate slots: Avatar placeholders + \"Assign\" button\n\n**Skill Map Graph**\n- Node-based visualization\n- Black nodes with white text for primary skills\n- Gray outline nodes for secondary skills\n- Simple connecting lines (not arrows)\n- Clean, grid-aligned layout\n\n### Forms & Inputs\n\n**Input Fields**\n- Border: border border-gray-300 focus:border-black\n- Background: bg-white\n- Padding: px-4 py-2\n- Rounded: rounded-md\n- Label: text-sm font-medium mb-2 above input\n- Helper text: text-xs text-gray-500 mt-1\n\n**Buttons**\n- **Primary CTA**: bg-black text-white px-6 py-2 rounded-md font-medium\n- **Secondary**: border border-black text-black bg-white px-6 py-2 rounded-md\n- **Ghost**: text-black hover:bg-gray-50 px-4 py-2\n- Size: Base height h-10, large h-12 for heroes\n\n**File Upload (CV)**\n- Dashed border dropzone (border-2 border-dashed border-gray-300)\n- Upload icon (simple outline, gray)\n- \"Drag & drop or click to upload\" text\n- Accepted formats shown: text-xs text-gray-500\n\n### Dashboards\n\n**Business Portal Dashboard**\n- Top stats row: 4-column grid (Active Projects, Candidates, Avg Fit Score, Risk Alerts)\n- Main content: 2-column layout (left: Recent Projects list, right: Top Candidates)\n- Each stat card: Large number (text-4xl), small label below\n- White cards with subtle shadows (shadow-sm)\n\n**Candidate Portal Dashboard**\n- Hero section: \"Welcome back, [Name]\" + Quick stats (Applications, Matches, Availability)\n- Recommended projects section: Scrollable horizontal card row\n- Calendar widget: Month view with availability marked (simple black dots)\n\n### Modals & Overlays\n\n**Standard Modal**\n- White surface, max-w-2xl\n- Black close button (top-right X)\n- Title: text-2xl font-semibold mb-4\n- Content area: Clean spacing, scrollable if needed\n- Footer: Right-aligned button group (Cancel outline + Confirm black)\n\n**Risk Alert Modal**\n- Warning icon (simple exclamation triangle, black outline)\n- Bold headline: \"Delay Detected - Backup Required?\"\n- Details section: Project name, milestone, delay percentage\n- Recommended backup candidate card preview\n- Actions: \"Activate Backup\" (black) + \"Monitor\" (outline)\n\n### Data Visualization\n\n**Fit Score Meter**\n- Circular progress indicator (0-100%)\n- Black stroke for progress, gray for remainder\n- Center: Large number + \"Fit\" label\n- Color coding: >80% green accent, 50-80% neutral, <50% red accent\n\n**Timeline Chart**\n- Horizontal Gantt-style bars\n- Black for completed, gray outline for upcoming\n- Today marker: Vertical dashed line\n- Milestone markers: Small black dots with labels\n\n---\n\n## Animations & Interactions\n\n**Minimal Motion Philosophy**: Use only when adding clarity\n\n**Permitted Animations**:\n- Hover states: Border color transitions (150ms)\n- Modal entry: Fade in + scale from 0.95 (200ms)\n- Loading states: Simple spinner (black stroke on white)\n- Accordion expand: Height transition (300ms ease)\n- Notification toasts: Slide from top (250ms)\n\n**Forbidden**:\n- No gradient animations\n- No parallax effects\n- No carousel auto-advance\n- No decorative animations\n\n---\n\n## Images\n\n**Minimal Image Usage**: This is a data-driven enterprise tool, not a marketing site\n\n**Allowed Images**:\n1. **User Avatars**: Circular, grayscale filter applied for visual consistency\n2. **Empty State Illustrations**: Simple line art (black outline on white), e.g., \"No projects yet\" screen\n3. **Company Logos**: In candidate profiles (if pulled from LinkedIn), displayed small in grayscale\n\n**No Hero Images**: Dashboards and portals skip traditional heroes in favor of immediate data display and workflow access.\n\n---\n\n## Portal-Specific Considerations\n\n### Business Portal Emphasis\n- Project creation flow is prominent (sticky \"New Project\" button)\n- Risk dashboard gets priority position\n- Candidate rankings use tabular layout with sortable columns\n- Bulk actions available (e.g., \"Notify All Top Matches\")\n\n### Candidate Portal Emphasis\n- Calendar availability is always visible (sidebar widget)\n- Fit score displayed prominently on every opportunity card\n- Application history with status tracking (Applied → Under Review → Matched)\n- Profile completion progress bar (top of dashboard)\n\n---\n\n## Accessibility\n\n- Maintain 4.5:1 contrast ratio (black on white easily achieves this)\n- All interactive elements minimum 44px touch target\n- Focus indicators: 2px black outline offset by 2px\n- Screen reader labels for all icon-only buttons\n- Keyboard navigation: Tab order follows visual hierarchy\n- ARIA labels for dynamic content (fit scores, risk alerts)\n\n---\n\n## Design Quality Standards\n\n- Every card has consistent border-radius (rounded-md = 6px)\n- Shadows used sparingly: shadow-sm for cards, shadow-md for modals only\n- No arbitrary values - stick to Tailwind spacing scale\n- White space is intentional - never cramped layouts\n- Grid alignment: All elements snap to 4px grid\n- Loading states for all async operations (Gemini AI calls, Jira syncs)\n- Empty states designed for every list/table view","size_bytes":9993},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/FitScoreMeter.tsx":{"content":"interface FitScoreMeterProps {\n  score: number;\n  size?: \"sm\" | \"md\" | \"lg\";\n  showLabel?: boolean;\n}\n\nexport function FitScoreMeter({ score, size = \"md\", showLabel = true }: FitScoreMeterProps) {\n  const sizeClasses = {\n    sm: { container: \"w-16 h-16\", text: \"text-lg\", label: \"text-xs\" },\n    md: { container: \"w-24 h-24\", text: \"text-2xl\", label: \"text-sm\" },\n    lg: { container: \"w-32 h-32\", text: \"text-3xl\", label: \"text-base\" },\n  };\n\n  const currentSize = sizeClasses[size];\n  \n  const circumference = 2 * Math.PI * 45;\n  const offset = circumference - (score / 100) * circumference;\n\n  const getColorClass = () => {\n    if (score >= 80) return \"stroke-[hsl(142,76%,36%)]\"; // Success green\n    if (score >= 50) return \"stroke-foreground\"; // Neutral black\n    return \"stroke-[hsl(0,84%,60%)]\"; // Warning red\n  };\n\n  return (\n    <div className=\"flex flex-col items-center gap-2\">\n      <div className={`relative ${currentSize.container}`} data-testid=\"fit-score-meter\">\n        <svg className=\"w-full h-full -rotate-90\" viewBox=\"0 0 100 100\">\n          <circle\n            cx=\"50\"\n            cy=\"50\"\n            r=\"45\"\n            fill=\"none\"\n            stroke=\"hsl(var(--border))\"\n            strokeWidth=\"8\"\n          />\n          <circle\n            cx=\"50\"\n            cy=\"50\"\n            r=\"45\"\n            fill=\"none\"\n            className={getColorClass()}\n            strokeWidth=\"8\"\n            strokeLinecap=\"round\"\n            strokeDasharray={circumference}\n            strokeDashoffset={offset}\n            style={{ transition: \"stroke-dashoffset 0.5s ease\" }}\n          />\n        </svg>\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <div className={`${currentSize.text} font-bold`} data-testid=\"fit-score-value\">{score}</div>\n            {showLabel && <div className={`${currentSize.label} text-muted-foreground`}>Fit</div>}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1999},"client/src/pages/CandidateDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ArrowLeft, Upload, Calendar, Briefcase, TrendingUp, Bookmark, X, Send, ChevronDown, ChevronUp } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { JobMatchExplainer } from \"@/components/JobMatchExplainer\";\n\nexport default function CandidateDashboard() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [expandedExplainer, setExpandedExplainer] = useState<string | null>(null);\n\n  const { data: candidate } = useQuery({\n    queryKey: [\"/api/candidate/profile\"],\n  });\n\n  const { data: recommendations = [] } = useQuery({\n    queryKey: [\"/api/candidate/recommendations\"],\n  });\n\n  const { data: stats = { applications: 0, matches: 0, avgFitScore: 0 } } = useQuery({\n    queryKey: [\"/api/candidate/stats\"],\n  });\n\n  const saveJobMutation = useMutation({\n    mutationFn: async (milestoneId: string) => {\n      return await apiRequest(\"POST\", \"/api/candidate/save-job\", { milestoneId });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidate/recommendations\"] });\n      toast({ title: \"Success\", description: \"Job saved for later!\" });\n    },\n  });\n\n  const skipJobMutation = useMutation({\n    mutationFn: async (milestoneId: string) => {\n      return await apiRequest(\"POST\", \"/api/candidate/skip-job\", { milestoneId });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidate/recommendations\"] });\n      toast({ title: \"Job skipped\", description: \"We won't show this recommendation again.\" });\n    },\n  });\n\n  const applyMutation = useMutation({\n    mutationFn: async ({ milestoneId, projectId }: { milestoneId: string; projectId: string }) => {\n      return await apiRequest(\"POST\", \"/api/candidate/apply\", { milestoneId, projectId });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidate/recommendations\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidate/stats\"] });\n      toast({ title: \"Application submitted!\", description: \"The business will review your application.\" });\n    },\n  });\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b border-border bg-white sticky top-0 z-50\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                onClick={() => setLocation(\"/\")}\n                data-testid=\"button-back-home\"\n              >\n                <ArrowLeft className=\"w-5 h-5\" />\n              </Button>\n              <h1 className=\"text-2xl font-bold\" data-testid=\"candidate-dashboard-title\">Candidate Portal</h1>\n            </div>\n            <Button \n              onClick={() => setLocation(\"/candidate/profile\")}\n              data-testid=\"button-manage-profile\"\n            >\n              Manage Profile\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 py-8\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold mb-2\" data-testid=\"welcome-message\">\n            Welcome back{candidate?.name ? `, ${candidate.name}` : ''}\n          </h2>\n          <p className=\"text-muted-foreground\">\n            Discover projects that match your skills and expertise\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <Card data-testid=\"stat-applications\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Applications</CardTitle>\n                <Briefcase className=\"w-4 h-4 text-muted-foreground\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold\" data-testid=\"stat-applications-value\">{stats.applications}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"stat-matches\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Matches {'>'}70%</CardTitle>\n                <TrendingUp className=\"w-4 h-4 text-muted-foreground\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold\" data-testid=\"stat-matches-value\">{stats.matches}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"stat-avg-fit\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-sm font-medium text-muted-foreground\">Avg Fit Score</CardTitle>\n                <TrendingUp className=\"w-4 h-4 text-muted-foreground\" />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-bold\" data-testid=\"stat-avg-fit-value\">{stats.avgFitScore}%</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {!candidate?.cvFilePath && (\n          <Card className=\"mb-8 border-[hsl(0,84%,60%)]\" data-testid=\"upload-cv-alert\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-start gap-4\">\n                <Upload className=\"w-6 h-6 text-[hsl(0,84%,60%)] shrink-0 mt-0.5\" />\n                <div className=\"flex-1\">\n                  <h3 className=\"font-semibold mb-1\">Upload Your CV</h3>\n                  <p className=\"text-sm text-muted-foreground mb-4\">\n                    Upload your CV to unlock AI-powered profile analysis and get personalized project recommendations.\n                  </p>\n                  <Button onClick={() => setLocation(\"/candidate/profile\")} data-testid=\"button-upload-cv\">\n                    <Upload className=\"w-4 h-4 mr-2\" />\n                    Upload CV Now\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        <div>\n          <h2 className=\"text-2xl font-semibold mb-4\">Recommended Projects</h2>\n          {recommendations.length === 0 ? (\n            <Card className=\"py-16\">\n              <CardContent className=\"text-center\">\n                <Briefcase className=\"w-16 h-16 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-xl font-semibold mb-2\">No recommendations yet</h3>\n                <p className=\"text-muted-foreground mb-6\">\n                  {!candidate?.cvFilePath \n                    ? \"Upload your CV to receive AI-powered project recommendations based on your skills.\" \n                    : \"We're analyzing your profile to find the best project matches. Check back soon!\"}\n                </p>\n                {!candidate?.cvFilePath && (\n                  <Button onClick={() => setLocation(\"/candidate/profile\")} data-testid=\"button-upload-cv-empty\">\n                    <Upload className=\"w-4 h-4 mr-2\" />\n                    Upload CV\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {recommendations.map((rec: any) => {\n                const isExpanded = expandedExplainer === rec.id;\n                return (\n                  <Card key={rec.id} className=\"hover-elevate transition-all duration-150 flex flex-col\" data-testid={`recommendation-${rec.id}`}>\n                    <CardHeader className=\"pb-3\">\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <CardTitle className=\"text-lg\">{rec.projectName}</CardTitle>\n                        <Badge className=\"bg-[hsl(142,76%,36%)] text-white shrink-0\" data-testid={`badge-fit-score-${rec.id}`}>\n                          {rec.fitScore}% Fit\n                        </Badge>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"space-y-3 flex-1 flex flex-col\">\n                      <div className=\"flex-1\">\n                        {/* Why this job? toggle */}\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          className=\"h-auto p-0 text-xs hover:no-underline\"\n                          onClick={() => setExpandedExplainer(isExpanded ? null : rec.id)}\n                          data-testid={`button-toggle-explainer-${rec.id}`}\n                        >\n                          {isExpanded ? (\n                            <>\n                              <ChevronUp className=\"w-3 h-3 mr-1\" />\n                              Hide details\n                            </>\n                          ) : (\n                            <>\n                              <ChevronDown className=\"w-3 h-3 mr-1\" />\n                              Why this job?\n                            </>\n                          )}\n                        </Button>\n\n                        {/* Explainer component */}\n                        {isExpanded && (\n                          <div className=\"mt-3\">\n                            <JobMatchExplainer \n                              fitScore={{\n                                score: rec.fitScore,\n                                skillOverlap: rec.skillOverlap || 0,\n                                experienceMatch: rec.experienceMatch || 0,\n                                softSkillRelevance: rec.softSkillRelevance || 0,\n                                reasoning: rec.reasoning\n                              }}\n                            />\n                          </div>\n                        )}\n                      </div>\n\n                      {/* Action buttons */}\n                      <div className=\"flex gap-2 mt-3\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"flex-1\"\n                          onClick={() => skipJobMutation.mutate(rec.id)}\n                          disabled={skipJobMutation.isPending}\n                          data-testid={`button-skip-${rec.id}`}\n                        >\n                          <X className=\"w-4 h-4 mr-1\" />\n                          Skip\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"flex-1\"\n                          onClick={() => saveJobMutation.mutate(rec.id)}\n                          disabled={saveJobMutation.isPending}\n                          data-testid={`button-save-${rec.id}`}\n                        >\n                          <Bookmark className=\"w-4 h-4 mr-1\" />\n                          Save\n                        </Button>\n                        <Button\n                          variant=\"default\"\n                          size=\"sm\"\n                          className=\"flex-1\"\n                          onClick={() => applyMutation.mutate({ milestoneId: rec.id, projectId: rec.projectId })}\n                          disabled={applyMutation.isPending}\n                          data-testid={`button-apply-${rec.id}`}\n                        >\n                          <Send className=\"w-4 h-4 mr-1\" />\n                          Apply\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      </main>\n    </div>\n  );\n}\n","size_bytes":12191},"client/src/pages/CandidateProfile.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { ArrowLeft, Upload, Sparkles, CheckCircle2, Loader2 } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst profileSchema = z.object({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  email: z.string().email(\"Invalid email address\"),\n  phone: z.string().optional(),\n  linkedinUrl: z.string().url().optional().or(z.literal(\"\")),\n  githubUrl: z.string().url().optional().or(z.literal(\"\")),\n  availableFrom: z.string().optional(),\n  availableUntil: z.string().optional(),\n});\n\ntype ProfileFormValues = z.infer<typeof profileSchema>;\n\nexport default function CandidateProfile() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [parseStage, setParseStage] = useState<'idle' | 'uploading' | 'parsing' | 'analyzing' | 'complete'>('idle');\n\n  const { data: candidate, isLoading: isCandidateLoading } = useQuery({\n    queryKey: [\"/api/candidate/profile\"],\n  });\n\n  const form = useForm<ProfileFormValues>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      name: \"\",\n      email: \"\",\n      phone: \"\",\n      linkedinUrl: \"\",\n      githubUrl: \"\",\n      availableFrom: \"\",\n      availableUntil: \"\",\n    },\n  });\n\n  // Reset form when candidate data loads (handle both null and populated responses)\n  useEffect(() => {\n    if (candidate !== undefined) {\n      form.reset({\n        name: candidate?.name || \"\",\n        email: candidate?.email || \"\",\n        phone: candidate?.phone || \"\",\n        linkedinUrl: candidate?.linkedinUrl || \"\",\n        githubUrl: candidate?.githubUrl || \"\",\n        availableFrom: candidate?.availableFrom ? new Date(candidate.availableFrom).toISOString().split('T')[0] : \"\",\n        availableUntil: candidate?.availableUntil ? new Date(candidate.availableUntil).toISOString().split('T')[0] : \"\",\n      });\n    }\n  }, [candidate, form]);\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: ProfileFormValues) => {\n      return await apiRequest(\"PUT\", \"/api/candidate/profile\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidate/profile\"] });\n      toast({\n        title: \"Success\",\n        description: \"Profile updated successfully!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update profile\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const uploadCVMutation = useMutation({\n    mutationFn: async (file: File) => {\n      const formData = new FormData();\n      formData.append(\"cv\", file);\n      const response = await fetch(\"/api/candidate/upload-cv\", {\n        method: \"POST\",\n        body: formData,\n      });\n      if (!response.ok) throw new Error(\"Upload failed\");\n      return await response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidate/profile\"] });\n      setIsAnalyzing(false);\n      toast({\n        title: \"Success\",\n        description: \"CV uploaded and analyzed successfully!\",\n      });\n    },\n    onError: () => {\n      setIsAnalyzing(false);\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload CV\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type === \"application/pdf\" || file.type === \"application/msword\" || file.type === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\") {\n        setSelectedFile(file);\n      } else {\n        toast({\n          title: \"Invalid file type\",\n          description: \"Please upload a PDF or DOC file\",\n          variant: \"destructive\",\n        });\n      }\n    }\n  };\n\n  const handleUploadCV = () => {\n    if (selectedFile) {\n      setIsAnalyzing(true);\n      setUploadProgress(0);\n      setParseStage('uploading');\n      \n      // Simulate upload progress\n      const uploadInterval = setInterval(() => {\n        setUploadProgress((prev) => {\n          if (prev >= 30) {\n            clearInterval(uploadInterval);\n            return 30;\n          }\n          return prev + 10;\n        });\n      }, 200);\n      \n      uploadCVMutation.mutate(selectedFile);\n    }\n  };\n  \n  // Update progress as stages complete\n  useEffect(() => {\n    if (uploadCVMutation.isPending && parseStage === 'uploading') {\n      const timer = setTimeout(() => {\n        setUploadProgress(40);\n        setParseStage('parsing');\n      }, 800);\n      return () => clearTimeout(timer);\n    }\n    if (uploadCVMutation.isPending && parseStage === 'parsing') {\n      const timer = setTimeout(() => {\n        setUploadProgress(70);\n        setParseStage('analyzing');\n      }, 1200);\n      return () => clearTimeout(timer);\n    }\n    if (uploadCVMutation.isSuccess && parseStage !== 'complete') {\n      setUploadProgress(100);\n      setParseStage('complete');\n      setTimeout(() => {\n        setParseStage('idle');\n        setUploadProgress(0);\n      }, 2000);\n    }\n  }, [uploadCVMutation.isPending, uploadCVMutation.isSuccess, parseStage]);\n\n  const onSubmit = (data: ProfileFormValues) => {\n    updateProfileMutation.mutate(data);\n  };\n\n  // Show loading state while candidate data is being fetched\n  if (isCandidateLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <header className=\"border-b border-border bg-white sticky top-0 z-50\">\n          <div className=\"max-w-5xl mx-auto px-4 py-4\">\n            <div className=\"flex items-center gap-4\">\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                onClick={() => setLocation(\"/candidate\")}\n                data-testid=\"button-back\"\n              >\n                <ArrowLeft className=\"w-5 h-5\" />\n              </Button>\n              <h1 className=\"text-2xl font-bold\" data-testid=\"page-title\">Manage Profile</h1>\n            </div>\n          </div>\n        </header>\n        <main className=\"max-w-5xl mx-auto px-4 py-8\">\n          <Card>\n            <CardContent className=\"p-8 flex items-center justify-center\">\n              <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n              <span className=\"ml-3 text-muted-foreground\">Loading profile...</span>\n            </CardContent>\n          </Card>\n        </main>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b border-border bg-white sticky top-0 z-50\">\n        <div className=\"max-w-5xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={() => setLocation(\"/candidate\")}\n              data-testid=\"button-back\"\n            >\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n            <h1 className=\"text-2xl font-bold\" data-testid=\"page-title\">Manage Profile</h1>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-5xl mx-auto px-4 py-8 space-y-8\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Upload className=\"w-5 h-5\" />\n              CV Upload & AI Analysis\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {candidate?.cvFilePath ? (\n              <div className=\"flex items-center gap-3 p-4 border border-[hsl(142,76%,36%)] rounded-md bg-[hsl(142,76%,36%)]/5\">\n                <CheckCircle2 className=\"w-5 h-5 text-[hsl(142,76%,36%)]\" />\n                <div className=\"flex-1\">\n                  <div className=\"font-medium\">CV Uploaded Successfully</div>\n                  <div className=\"text-sm text-muted-foreground\">Your profile has been analyzed by AI</div>\n                </div>\n              </div>\n            ) : (\n              <div className=\"border-2 border-dashed border-border rounded-md p-8 text-center\">\n                {!isAnalyzing ? (\n                  <>\n                    <Upload className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                    <div className=\"mb-4\">\n                      <p className=\"font-medium mb-1\">Drag & drop or click to upload</p>\n                      <p className=\"text-sm text-muted-foreground\">PDF or DOC files only (max 10MB)</p>\n                    </div>\n                    <input\n                      type=\"file\"\n                      accept=\".pdf,.doc,.docx\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                      id=\"cv-upload\"\n                      data-testid=\"input-cv-upload\"\n                    />\n                    <label htmlFor=\"cv-upload\">\n                      <Button type=\"button\" variant=\"outline\" asChild>\n                        <span>Select File</span>\n                      </Button>\n                    </label>\n                    {selectedFile && (\n                      <div className=\"mt-4\">\n                        <p className=\"text-sm mb-3\">Selected: {selectedFile.name}</p>\n                        <Button onClick={handleUploadCV} disabled={isAnalyzing} data-testid=\"button-upload-cv\">\n                          <Sparkles className=\"w-4 h-4 mr-2\" />\n                          Upload & Analyze\n                        </Button>\n                      </div>\n                    )}\n                  </>\n                ) : (\n                  <div className=\"space-y-4\">\n                    <Loader2 className=\"w-12 h-12 mx-auto text-primary animate-spin\" />\n                    <div>\n                      <p className=\"font-medium mb-2\">\n                        {parseStage === 'uploading' && '📤 Uploading your CV...'}\n                        {parseStage === 'parsing' && '📄 Extracting text...'}\n                        {parseStage === 'analyzing' && '🤖 AI analyzing your profile...'}\n                        {parseStage === 'complete' && '✅ Complete!'}\n                      </p>\n                      <Progress value={uploadProgress} className=\"w-full max-w-md mx-auto\" data-testid=\"upload-progress\" />\n                      <p className=\"text-sm text-muted-foreground mt-2\">{uploadProgress}% complete</p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n            {candidate?.cvAnalysis && (\n              <div className=\"p-4 border border-border rounded-md bg-muted/30\">\n                <div className=\"text-sm font-medium mb-2\">AI Analysis Results</div>\n                <div className=\"text-sm text-muted-foreground space-y-1\">\n                  {candidate.skills && candidate.skills.length > 0 && (\n                    <div><strong>Skills:</strong> {candidate.skills.slice(0, 10).join(\", \")}</div>\n                  )}\n                  {candidate.experience && (\n                    <div><strong>Experience:</strong> {candidate.experience}</div>\n                  )}\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Personal Information</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Full Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"John Doe\" {...field} data-testid=\"input-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"email\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input type=\"email\" placeholder=\"john@example.com\" {...field} disabled data-testid=\"input-email\" />\n                      </FormControl>\n                      <FormDescription>\n                        Email cannot be changed as it's used as your account identifier\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"phone\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Phone (Optional)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"+1 234 567 8900\" {...field} data-testid=\"input-phone\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Professional Links</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"linkedinUrl\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>LinkedIn URL (Optional)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"https://linkedin.com/in/johndoe\" {...field} data-testid=\"input-linkedin\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"githubUrl\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>GitHub URL (Optional)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"https://github.com/johndoe\" {...field} data-testid=\"input-github\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Availability</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"availableFrom\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Available From</FormLabel>\n                      <FormControl>\n                        <Input type=\"date\" {...field} data-testid=\"input-available-from\" />\n                      </FormControl>\n                      <FormDescription>When are you available to start?</FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"availableUntil\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Available Until</FormLabel>\n                      <FormControl>\n                        <Input type=\"date\" {...field} data-testid=\"input-available-until\" />\n                      </FormControl>\n                      <FormDescription>How long are you available?</FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            <div className=\"flex gap-3\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => setLocation(\"/candidate\")}\n                data-testid=\"button-cancel\"\n              >\n                Cancel\n              </Button>\n              <Button \n                type=\"submit\" \n                className=\"flex-1\"\n                disabled={updateProfileMutation.isPending}\n                data-testid=\"button-save-profile\"\n              >\n                {updateProfileMutation.isPending ? \"Saving...\" : \"Save Profile\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </main>\n    </div>\n  );\n}\n","size_bytes":17570},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ProtectedRoute } from \"@/components/ProtectedRoute\";\nimport NotFound from \"@/pages/not-found\";\nimport LandingPage from \"@/pages/LandingPage\";\nimport BusinessDashboard from \"@/pages/BusinessDashboard\";\nimport CandidateDashboard from \"@/pages/CandidateDashboard\";\nimport CreateProject from \"@/pages/CreateProject\";\nimport ProjectDetail from \"@/pages/ProjectDetail\";\nimport CandidateProfile from \"@/pages/CandidateProfile\";\nimport Login from \"@/pages/Login\";\nimport BusinessLogin from \"@/pages/BusinessLogin\";\nimport CandidateLogin from \"@/pages/CandidateLogin\";\nimport VerifyMagicLink from \"@/pages/VerifyMagicLink\";\nimport CandidateUpload from \"@/pages/CandidateUpload\";\nimport CandidateLanding from \"@/pages/CandidateLanding\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={LandingPage} />\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/business-login\" component={BusinessLogin} />\n      <Route path=\"/candidate-login\" component={CandidateLogin} />\n      <Route path=\"/auth/verify\" component={VerifyMagicLink} />\n      \n      {/* Business routes - require authentication */}\n      <Route path=\"/business\">\n        <ProtectedRoute requireBusiness>\n          <BusinessDashboard />\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/business/projects/new\">\n        <ProtectedRoute requireBusiness>\n          <CreateProject />\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/business/projects/:id\">\n        <ProtectedRoute requireBusiness>\n          <ProjectDetail />\n        </ProtectedRoute>\n      </Route>\n      \n      {/* Candidate routes - /candidate landing page, dashboard requires auth */}\n      <Route path=\"/candidate\" component={CandidateLanding} />\n      <Route path=\"/candidate/upload\" component={CandidateUpload} />\n      <Route path=\"/candidate/dashboard\">\n        <ProtectedRoute requireCandidate>\n          <CandidateDashboard />\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/candidate/profile\">\n        <ProtectedRoute requireCandidate>\n          <CandidateProfile />\n        </ProtectedRoute>\n      </Route>\n      \n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2666},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/WorkflowVisualization.tsx":{"content":"interface WorkflowStep {\n  title: string;\n  description?: string;\n}\n\ninterface WorkflowColumn {\n  title: string;\n  steps: WorkflowStep[];\n}\n\ninterface WorkflowVisualizationProps {\n  workflows: WorkflowColumn[];\n}\n\nexport function WorkflowVisualization({ workflows }: WorkflowVisualizationProps) {\n  return (\n    <div className=\"w-full max-w-6xl mx-auto px-4 py-12\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n        {workflows.map((workflow, idx) => (\n          <div key={idx} className=\"flex flex-col items-center\">\n            <div className=\"bg-black text-white font-semibold rounded-md px-4 py-2 mb-6 text-center w-full max-w-xs\" data-testid={`workflow-header-${idx}`}>\n              {workflow.title}\n            </div>\n            <div className=\"flex flex-col items-center w-full max-w-xs\">\n              {workflow.steps.map((step, stepIdx) => (\n                <div key={stepIdx} className=\"flex flex-col items-center w-full\">\n                  <div \n                    className=\"border border-border rounded-md px-4 py-3 w-full text-center text-foreground bg-white hover-elevate transition-all duration-150\"\n                    data-testid={`workflow-step-${idx}-${stepIdx}`}\n                  >\n                    <div className=\"font-medium\">{step.title}</div>\n                    {step.description && (\n                      <div className=\"text-xs text-muted-foreground mt-1\">{step.description}</div>\n                    )}\n                  </div>\n                  {stepIdx < workflow.steps.length - 1 && (\n                    <div className=\"h-4 w-px bg-border my-2\" />\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","size_bytes":1764},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"server/storage.ts":{"content":"import {\n  projects, milestones, candidates, fitScores, riskAlerts, jiraSettings,\n  savedJobs, applications, candidateActions, magicLinks, backgroundJobs, jiraSyncLogs,\n  businessInterests,\n  type Project, type InsertProject,\n  type Milestone, type InsertMilestone,\n  type Candidate, type InsertCandidate,\n  type FitScore, type InsertFitScore,\n  type RiskAlert, type InsertRiskAlert,\n  type JiraSettings, type InsertJiraSettings,\n  type SavedJob, type InsertSavedJob,\n  type Application, type InsertApplication,\n  type CandidateAction, type InsertCandidateAction,\n  type MagicLink, type InsertMagicLink,\n  type BackgroundJob, type InsertBackgroundJob,\n  type JiraSyncLog, type InsertJiraSyncLog,\n  type BusinessInterest, type InsertBusinessInterest\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, and, gte } from \"drizzle-orm\";\n\n// Storage interface for Lean Workforce\nexport interface IStorage {\n  // Projects\n  getProject(id: string): Promise<Project | undefined>;\n  getAllProjects(): Promise<Project[]>;\n  createProject(project: InsertProject): Promise<Project>;\n  updateProject(id: string, data: Partial<InsertProject>): Promise<Project | undefined>;\n  \n  // Milestones\n  getMilestone(id: string): Promise<Milestone | undefined>;\n  getMilestonesByProject(projectId: string): Promise<Milestone[]>;\n  createMilestone(milestone: InsertMilestone): Promise<Milestone>;\n  updateMilestone(id: string, data: Partial<InsertMilestone>): Promise<Milestone | undefined>;\n  \n  // Candidates\n  getCandidate(id: string): Promise<Candidate | undefined>;\n  getCandidateByEmail(email: string): Promise<Candidate | undefined>;\n  getAllCandidates(): Promise<Candidate[]>;\n  createCandidate(candidate: InsertCandidate): Promise<Candidate>;\n  updateCandidate(id: string, data: Partial<InsertCandidate>): Promise<Candidate | undefined>;\n  \n  // Fit Scores\n  getFitScore(id: string): Promise<FitScore | undefined>;\n  getFitScoresByMilestone(milestoneId: string): Promise<FitScore[]>;\n  getFitScoresByCandidate(candidateId: string): Promise<FitScore[]>;\n  createFitScore(fitScore: InsertFitScore): Promise<FitScore>;\n  updateFitScore(id: string, data: Partial<InsertFitScore>): Promise<FitScore | undefined>;\n  getTopCandidatesForMilestone(milestoneId: string, limit: number): Promise<Array<FitScore & { candidate: Candidate }>>;\n  \n  // Risk Alerts\n  getRiskAlert(id: string): Promise<RiskAlert | undefined>;\n  getRiskAlertsByMilestone(milestoneId: string): Promise<RiskAlert[]>;\n  createRiskAlert(riskAlert: InsertRiskAlert): Promise<RiskAlert>;\n  \n  // Jira Settings\n  getJiraSettings(businessUserId: string): Promise<JiraSettings | undefined>;\n  saveJiraSettings(settings: InsertJiraSettings): Promise<JiraSettings>;\n  updateJiraSettings(businessUserId: string, data: Partial<InsertJiraSettings>): Promise<JiraSettings | undefined>;\n  \n  // Saved Jobs\n  saveJob(candidateId: string, milestoneId: string): Promise<SavedJob>;\n  unsaveJob(candidateId: string, milestoneId: string): Promise<void>;\n  getSavedJobs(candidateId: string): Promise<SavedJob[]>;\n  isJobSaved(candidateId: string, milestoneId: string): Promise<boolean>;\n  \n  // Applications\n  createApplication(application: InsertApplication): Promise<Application>;\n  getApplication(id: string): Promise<Application | undefined>;\n  getApplicationsByCandidate(candidateId: string): Promise<Application[]>;\n  getApplicationsByMilestone(milestoneId: string): Promise<Application[]>;\n  updateApplicationStatus(id: string, status: string): Promise<Application | undefined>;\n  \n  // Candidate Actions (Save/Skip/View tracking)\n  recordAction(candidateId: string, milestoneId: string, action: string): Promise<CandidateAction>;\n  getActions(candidateId: string): Promise<CandidateAction[]>;\n  hasAction(candidateId: string, milestoneId: string, action: string): Promise<boolean>;\n  \n  // Magic Links\n  createMagicLink(magicLink: InsertMagicLink): Promise<MagicLink>;\n  getMagicLinkByToken(token: string): Promise<MagicLink | undefined>;\n  markMagicLinkAsUsed(token: string): Promise<MagicLink | undefined>;\n  invalidateOldMagicLinks(email: string): Promise<void>;\n  getRecentMagicLinksByEmail(email: string, sinceMinutes: number): Promise<MagicLink[]>;\n  \n  // Background Jobs\n  createJob(job: InsertBackgroundJob): Promise<BackgroundJob>;\n  getJob(id: string): Promise<BackgroundJob | undefined>;\n  updateJob(id: string, data: Partial<InsertBackgroundJob>): Promise<BackgroundJob | undefined>;\n  getPendingJobs(limit: number): Promise<BackgroundJob[]>;\n  getJobsByUser(userId: string): Promise<BackgroundJob[]>;\n  \n  // Jira Sync Logs\n  createJiraSyncLog(log: InsertJiraSyncLog): Promise<JiraSyncLog>;\n  updateJiraSyncLog(id: string, data: Partial<InsertJiraSyncLog>): Promise<JiraSyncLog | undefined>;\n  getJiraSyncLogs(businessUserId: string, limit?: number): Promise<JiraSyncLog[]>;\n  getJiraSyncLogsByProject(projectId: string): Promise<JiraSyncLog[]>;\n  getFailedJiraSyncLogs(businessUserId: string): Promise<JiraSyncLog[]>;\n  \n  // Business Interests (Multi-Business Competition)\n  createBusinessInterest(interest: InsertBusinessInterest): Promise<BusinessInterest>;\n  updateBusinessInterest(id: string, data: Partial<InsertBusinessInterest>): Promise<BusinessInterest | undefined>;\n  getBusinessInterest(id: string): Promise<BusinessInterest | undefined>;\n  getBusinessInterestsByCandidate(candidateId: string): Promise<BusinessInterest[]>;\n  getBusinessInterestsByMilestone(milestoneId: string): Promise<BusinessInterest[]>;\n  getCompetingOffersForCandidate(candidateId: string): Promise<BusinessInterest[]>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Projects\n  async getProject(id: string): Promise<Project | undefined> {\n    const [project] = await db.select().from(projects).where(eq(projects.id, id));\n    return project || undefined;\n  }\n\n  async getAllProjects(): Promise<Project[]> {\n    return await db.select().from(projects).orderBy(desc(projects.createdAt));\n  }\n\n  async createProject(insertProject: InsertProject): Promise<Project> {\n    const [project] = await db.insert(projects).values(insertProject).returning();\n    return project;\n  }\n\n  async updateProject(id: string, data: Partial<InsertProject>): Promise<Project | undefined> {\n    const [project] = await db.update(projects).set(data).where(eq(projects.id, id)).returning();\n    return project || undefined;\n  }\n\n  // Milestones\n  async getMilestone(id: string): Promise<Milestone | undefined> {\n    const [milestone] = await db.select().from(milestones).where(eq(milestones.id, id));\n    return milestone || undefined;\n  }\n\n  async getMilestonesByProject(projectId: string): Promise<Milestone[]> {\n    return await db.select().from(milestones).where(eq(milestones.projectId, projectId)).orderBy(desc(milestones.createdAt));\n  }\n\n  async createMilestone(insertMilestone: InsertMilestone): Promise<Milestone> {\n    const [milestone] = await db.insert(milestones).values(insertMilestone).returning();\n    return milestone;\n  }\n\n  async updateMilestone(id: string, data: Partial<InsertMilestone>): Promise<Milestone | undefined> {\n    const [milestone] = await db.update(milestones).set(data).where(eq(milestones.id, id)).returning();\n    return milestone || undefined;\n  }\n\n  // Candidates\n  async getCandidate(id: string): Promise<Candidate | undefined> {\n    const [candidate] = await db.select().from(candidates).where(eq(candidates.id, id));\n    return candidate || undefined;\n  }\n\n  async getCandidateByEmail(email: string): Promise<Candidate | undefined> {\n    const [candidate] = await db.select().from(candidates).where(eq(candidates.email, email));\n    return candidate || undefined;\n  }\n\n  async getAllCandidates(): Promise<Candidate[]> {\n    return await db.select().from(candidates).orderBy(desc(candidates.createdAt));\n  }\n\n  async createCandidate(insertCandidate: InsertCandidate): Promise<Candidate> {\n    const [candidate] = await db.insert(candidates).values(insertCandidate).returning();\n    return candidate;\n  }\n\n  async updateCandidate(id: string, data: Partial<InsertCandidate>): Promise<Candidate | undefined> {\n    const [candidate] = await db.update(candidates).set(data).where(eq(candidates.id, id)).returning();\n    return candidate || undefined;\n  }\n\n  // Fit Scores\n  async getFitScore(id: string): Promise<FitScore | undefined> {\n    const [fitScore] = await db.select().from(fitScores).where(eq(fitScores.id, id));\n    return fitScore || undefined;\n  }\n\n  async getFitScoresByMilestone(milestoneId: string): Promise<FitScore[]> {\n    return await db.select().from(fitScores).where(eq(fitScores.milestoneId, milestoneId)).orderBy(desc(fitScores.score));\n  }\n\n  async getFitScoresByCandidate(candidateId: string): Promise<FitScore[]> {\n    return await db.select().from(fitScores).where(eq(fitScores.candidateId, candidateId)).orderBy(desc(fitScores.score));\n  }\n\n  async createFitScore(insertFitScore: InsertFitScore): Promise<FitScore> {\n    const [fitScore] = await db.insert(fitScores).values(insertFitScore).returning();\n    return fitScore;\n  }\n\n  async updateFitScore(id: string, data: Partial<InsertFitScore>): Promise<FitScore | undefined> {\n    const [fitScore] = await db.update(fitScores).set(data).where(eq(fitScores.id, id)).returning();\n    return fitScore || undefined;\n  }\n\n  async getTopCandidatesForMilestone(milestoneId: string, limit: number = 10): Promise<Array<FitScore & { candidate: Candidate }>> {\n    const scores = await db\n      .select()\n      .from(fitScores)\n      .where(and(eq(fitScores.milestoneId, milestoneId), gte(fitScores.score, 50)))\n      .orderBy(desc(fitScores.score))\n      .limit(limit);\n\n    const results = [];\n    for (const score of scores) {\n      const candidate = await this.getCandidate(score.candidateId);\n      if (candidate) {\n        results.push({ ...score, candidate });\n      }\n    }\n\n    return results;\n  }\n\n  // Risk Alerts\n  async getRiskAlert(id: string): Promise<RiskAlert | undefined> {\n    const [riskAlert] = await db.select().from(riskAlerts).where(eq(riskAlerts.id, id));\n    return riskAlert || undefined;\n  }\n\n  async getRiskAlertsByMilestone(milestoneId: string): Promise<RiskAlert[]> {\n    return await db.select().from(riskAlerts).where(eq(riskAlerts.milestoneId, milestoneId)).orderBy(desc(riskAlerts.createdAt));\n  }\n\n  async createRiskAlert(insertRiskAlert: InsertRiskAlert): Promise<RiskAlert> {\n    const [riskAlert] = await db.insert(riskAlerts).values(insertRiskAlert).returning();\n    return riskAlert;\n  }\n\n  // Jira Settings\n  async getJiraSettings(businessUserId: string): Promise<JiraSettings | undefined> {\n    const [settings] = await db.select().from(jiraSettings).where(eq(jiraSettings.businessUserId, businessUserId));\n    return settings || undefined;\n  }\n\n  async saveJiraSettings(insertSettings: InsertJiraSettings): Promise<JiraSettings> {\n    const existing = await this.getJiraSettings(insertSettings.businessUserId);\n    \n    if (existing) {\n      // Preserve existing API token if new one is not provided\n      const updateData: any = { ...insertSettings, updatedAt: new Date() };\n      if (!insertSettings.jiraApiToken && existing.jiraApiToken) {\n        updateData.jiraApiToken = existing.jiraApiToken;\n      }\n      \n      const [updated] = await db\n        .update(jiraSettings)\n        .set(updateData)\n        .where(eq(jiraSettings.businessUserId, insertSettings.businessUserId))\n        .returning();\n      return updated;\n    } else {\n      const [created] = await db.insert(jiraSettings).values(insertSettings).returning();\n      return created;\n    }\n  }\n\n  async updateJiraSettings(businessUserId: string, data: Partial<InsertJiraSettings>): Promise<JiraSettings | undefined> {\n    const [settings] = await db\n      .update(jiraSettings)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(jiraSettings.businessUserId, businessUserId))\n      .returning();\n    return settings || undefined;\n  }\n\n  // Saved Jobs\n  async saveJob(candidateId: string, milestoneId: string): Promise<SavedJob> {\n    const [savedJob] = await db.insert(savedJobs).values({ candidateId, milestoneId }).returning();\n    return savedJob;\n  }\n\n  async unsaveJob(candidateId: string, milestoneId: string): Promise<void> {\n    await db.delete(savedJobs).where(\n      and(\n        eq(savedJobs.candidateId, candidateId),\n        eq(savedJobs.milestoneId, milestoneId)\n      )\n    );\n  }\n\n  async getSavedJobs(candidateId: string): Promise<SavedJob[]> {\n    return await db.select().from(savedJobs).where(eq(savedJobs.candidateId, candidateId)).orderBy(desc(savedJobs.createdAt));\n  }\n\n  async isJobSaved(candidateId: string, milestoneId: string): Promise<boolean> {\n    const [saved] = await db.select().from(savedJobs).where(\n      and(\n        eq(savedJobs.candidateId, candidateId),\n        eq(savedJobs.milestoneId, milestoneId)\n      )\n    );\n    return !!saved;\n  }\n\n  // Applications\n  async createApplication(insertApplication: InsertApplication): Promise<Application> {\n    const [application] = await db.insert(applications).values(insertApplication).returning();\n    return application;\n  }\n\n  async getApplication(id: string): Promise<Application | undefined> {\n    const [application] = await db.select().from(applications).where(eq(applications.id, id));\n    return application || undefined;\n  }\n\n  async getApplicationsByCandidate(candidateId: string): Promise<Application[]> {\n    return await db.select().from(applications).where(eq(applications.candidateId, candidateId)).orderBy(desc(applications.createdAt));\n  }\n\n  async getApplicationsByMilestone(milestoneId: string): Promise<Application[]> {\n    return await db.select().from(applications).where(eq(applications.milestoneId, milestoneId)).orderBy(desc(applications.createdAt));\n  }\n\n  async updateApplicationStatus(id: string, status: string): Promise<Application | undefined> {\n    const [application] = await db\n      .update(applications)\n      .set({ status, updatedAt: new Date() })\n      .where(eq(applications.id, id))\n      .returning();\n    return application || undefined;\n  }\n\n  // Candidate Actions\n  async recordAction(candidateId: string, milestoneId: string, action: string): Promise<CandidateAction> {\n    const [candidateAction] = await db.insert(candidateActions).values({ candidateId, milestoneId, action }).returning();\n    return candidateAction;\n  }\n\n  async getActions(candidateId: string): Promise<CandidateAction[]> {\n    return await db.select().from(candidateActions).where(eq(candidateActions.candidateId, candidateId)).orderBy(desc(candidateActions.createdAt));\n  }\n\n  async hasAction(candidateId: string, milestoneId: string, action: string): Promise<boolean> {\n    const [candidateAction] = await db.select().from(candidateActions).where(\n      and(\n        eq(candidateActions.candidateId, candidateId),\n        eq(candidateActions.milestoneId, milestoneId),\n        eq(candidateActions.action, action)\n      )\n    );\n    return !!candidateAction;\n  }\n\n  // Magic Links\n  async createMagicLink(insertMagicLink: InsertMagicLink): Promise<MagicLink> {\n    const [magicLink] = await db.insert(magicLinks).values(insertMagicLink).returning();\n    return magicLink;\n  }\n\n  async getMagicLinkByToken(token: string): Promise<MagicLink | undefined> {\n    const [magicLink] = await db.select().from(magicLinks).where(eq(magicLinks.token, token));\n    return magicLink || undefined;\n  }\n\n  async markMagicLinkAsUsed(token: string): Promise<MagicLink | undefined> {\n    const [magicLink] = await db\n      .update(magicLinks)\n      .set({ used: true, usedAt: new Date() })\n      .where(eq(magicLinks.token, token))\n      .returning();\n    return magicLink || undefined;\n  }\n\n  async invalidateOldMagicLinks(email: string): Promise<void> {\n    await db\n      .update(magicLinks)\n      .set({ used: true, usedAt: new Date() })\n      .where(\n        and(\n          eq(magicLinks.email, email),\n          eq(magicLinks.used, false)\n        )\n      );\n  }\n\n  async getRecentMagicLinksByEmail(email: string, sinceMinutes: number): Promise<MagicLink[]> {\n    const since = new Date(Date.now() - sinceMinutes * 60 * 1000);\n    return await db\n      .select()\n      .from(magicLinks)\n      .where(\n        and(\n          eq(magicLinks.email, email),\n          gte(magicLinks.createdAt, since)\n        )\n      )\n      .orderBy(desc(magicLinks.createdAt));\n  }\n\n  // Background Jobs\n  async createJob(insertJob: InsertBackgroundJob): Promise<BackgroundJob> {\n    const [job] = await db.insert(backgroundJobs).values(insertJob).returning();\n    return job;\n  }\n\n  async getJob(id: string): Promise<BackgroundJob | undefined> {\n    const [job] = await db.select().from(backgroundJobs).where(eq(backgroundJobs.id, id));\n    return job || undefined;\n  }\n\n  async updateJob(id: string, data: Partial<InsertBackgroundJob>): Promise<BackgroundJob | undefined> {\n    const [job] = await db\n      .update(backgroundJobs)\n      .set(data)\n      .where(eq(backgroundJobs.id, id))\n      .returning();\n    return job || undefined;\n  }\n\n  async getPendingJobs(limit: number): Promise<BackgroundJob[]> {\n    return await db\n      .select()\n      .from(backgroundJobs)\n      .where(eq(backgroundJobs.status, \"pending\"))\n      .orderBy(backgroundJobs.createdAt)\n      .limit(limit);\n  }\n\n  async getJobsByUser(userId: string): Promise<BackgroundJob[]> {\n    return await db\n      .select()\n      .from(backgroundJobs)\n      .where(eq(backgroundJobs.userId, userId))\n      .orderBy(desc(backgroundJobs.createdAt));\n  }\n  \n  // Jira Sync Logs\n  async createJiraSyncLog(insertLog: InsertJiraSyncLog): Promise<JiraSyncLog> {\n    const [log] = await db.insert(jiraSyncLogs).values(insertLog).returning();\n    return log;\n  }\n  \n  async updateJiraSyncLog(id: string, data: Partial<InsertJiraSyncLog>): Promise<JiraSyncLog | undefined> {\n    const [log] = await db.update(jiraSyncLogs).set(data).where(eq(jiraSyncLogs.id, id)).returning();\n    return log || undefined;\n  }\n  \n  async getJiraSyncLogs(businessUserId: string, limit: number = 50): Promise<JiraSyncLog[]> {\n    return await db\n      .select()\n      .from(jiraSyncLogs)\n      .where(eq(jiraSyncLogs.businessUserId, businessUserId))\n      .orderBy(desc(jiraSyncLogs.createdAt))\n      .limit(limit);\n  }\n  \n  async getJiraSyncLogsByProject(projectId: string): Promise<JiraSyncLog[]> {\n    return await db\n      .select()\n      .from(jiraSyncLogs)\n      .where(eq(jiraSyncLogs.projectId, projectId))\n      .orderBy(desc(jiraSyncLogs.createdAt));\n  }\n  \n  async getFailedJiraSyncLogs(businessUserId: string): Promise<JiraSyncLog[]> {\n    return await db\n      .select()\n      .from(jiraSyncLogs)\n      .where(\n        and(\n          eq(jiraSyncLogs.businessUserId, businessUserId),\n          eq(jiraSyncLogs.status, \"failed\")\n        )\n      )\n      .orderBy(desc(jiraSyncLogs.createdAt));\n  }\n  \n  // Business Interests (Multi-Business Competition)\n  async createBusinessInterest(insertInterest: InsertBusinessInterest): Promise<BusinessInterest> {\n    const [interest] = await db.insert(businessInterests).values(insertInterest).returning();\n    return interest;\n  }\n  \n  async updateBusinessInterest(id: string, data: Partial<InsertBusinessInterest>): Promise<BusinessInterest | undefined> {\n    const [interest] = await db.update(businessInterests).set({\n      ...data,\n      updatedAt: new Date()\n    }).where(eq(businessInterests.id, id)).returning();\n    return interest || undefined;\n  }\n  \n  async getBusinessInterest(id: string): Promise<BusinessInterest | undefined> {\n    const [interest] = await db\n      .select()\n      .from(businessInterests)\n      .where(eq(businessInterests.id, id));\n    return interest || undefined;\n  }\n  \n  async getBusinessInterestsByCandidate(candidateId: string): Promise<BusinessInterest[]> {\n    return await db\n      .select()\n      .from(businessInterests)\n      .where(eq(businessInterests.candidateId, candidateId))\n      .orderBy(desc(businessInterests.createdAt));\n  }\n  \n  async getBusinessInterestsByMilestone(milestoneId: string): Promise<BusinessInterest[]> {\n    return await db\n      .select()\n      .from(businessInterests)\n      .where(eq(businessInterests.milestoneId, milestoneId))\n      .orderBy(desc(businessInterests.createdAt));\n  }\n  \n  async getCompetingOffersForCandidate(candidateId: string): Promise<BusinessInterest[]> {\n    return await db\n      .select()\n      .from(businessInterests)\n      .where(\n        and(\n          eq(businessInterests.candidateId, candidateId),\n          eq(businessInterests.status, \"interested\")\n        )\n      )\n      .orderBy(desc(businessInterests.priorityScore));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":20615},"server/jira-client.ts":{"content":"// Jira client setup - Reference: jira blueprint\nimport { Version3Client } from 'jira.js';\nimport { storage } from './storage';\nimport { safeDecrypt } from './encryption';\n\nlet connectionSettings: any;\n\n// Try to get credentials from Replit connector\nasync function getAccessTokenFromConnector() {\n  if (connectionSettings && connectionSettings.settings.expires_at && new Date(connectionSettings.settings.expires_at).getTime() > Date.now()) {\n    return connectionSettings.settings.access_token;\n  }\n  \n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    return null;\n  }\n\n  try {\n    connectionSettings = await fetch(\n      'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=jira',\n      {\n        headers: {\n          'Accept': 'application/json',\n          'X_REPLIT_TOKEN': xReplitToken\n        }\n      }\n    ).then(res => res.json()).then(data => data.items?.[0]);\n\n    const accessToken = connectionSettings?.settings?.access_token || connectionSettings?.settings?.oauth?.credentials?.access_token;\n    const hostName = connectionSettings?.settings?.site_url;\n\n    if (connectionSettings && accessToken && hostName) {\n      return { accessToken, hostName, type: 'oauth' };\n    }\n  } catch (error) {\n    console.log('Replit connector not available, trying manual credentials...');\n  }\n\n  return null;\n}\n\n// Try to get credentials from database (manual configuration)\nasync function getManualCredentials(businessUserId: string = 'demo-business-user') {\n  try {\n    const settings = await storage.getJiraSettings(businessUserId);\n    \n    if (settings && settings.jiraDomain && settings.jiraEmail && settings.jiraApiToken && settings.isConfigured) {\n      // Decrypt API token before use\n      const decryptedToken = safeDecrypt(settings.jiraApiToken);\n      \n      return {\n        hostName: settings.jiraDomain.startsWith('https://') ? settings.jiraDomain : `https://${settings.jiraDomain}`,\n        email: settings.jiraEmail,\n        apiToken: decryptedToken,\n        type: 'basic'\n      };\n    }\n  } catch (error) {\n    console.error('Error fetching manual Jira credentials:', error);\n  }\n  \n  return null;\n}\n\n// WARNING: Never cache this client.\n// Access tokens expire, so a new client must be created each time.\n// Always call this function again to get a fresh client.\nexport async function getUncachableJiraClient(businessUserId: string = 'demo-business-user') {\n  // Try Replit connector first\n  const connectorAuth = await getAccessTokenFromConnector();\n  \n  if (connectorAuth && connectorAuth.type === 'oauth') {\n    return new Version3Client({\n      host: connectorAuth.hostName,\n      authentication: {\n        oauth2: { accessToken: connectorAuth.accessToken },\n      },\n    });\n  }\n\n  // Fall back to manual credentials\n  const manualAuth = await getManualCredentials(businessUserId);\n  \n  if (manualAuth && manualAuth.type === 'basic') {\n    return new Version3Client({\n      host: manualAuth.hostName,\n      authentication: {\n        basic: {\n          email: manualAuth.email,\n          apiToken: manualAuth.apiToken,\n        },\n      },\n    });\n  }\n\n  throw new Error('Jira not connected. Please configure Jira credentials in the settings.');\n}\n","size_bytes":3419},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"server/db.ts":{"content":"// PostgreSQL database setup - Reference: javascript_database blueprint\nimport { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\n// Provide a default empty string to prevent import-time errors\n// The actual validation happens in server/index.ts with better error handling\nconst connectionString = process.env.DATABASE_URL || '';\n\nexport const pool = new Pool({ connectionString });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":597},"server/gemini.ts":{"content":"import { GoogleGenAI } from \"@google/genai\";\nimport { geminiRateLimiter } from \"./rate-limiter\";\n\n// Gemini AI integration for Lean Workforce\n// Reference: javascript_gemini blueprint\n\nconst ai = new GoogleGenAI({ apiKey: process.env.GEMINI_API_KEY || \"\" });\n\nexport interface SkillMap {\n  milestone: string;\n  required_skills: string[];\n  experience_level: string;\n  soft_skills: string[];\n}\n\nexport interface CVAnalysis {\n  name: string;\n  email?: string;\n  skills: string[];\n  experience: string;\n  education: string;\n  soft_skills?: string[];\n  domain_expertise?: string[];\n}\n\nexport interface FitScoreAnalysis {\n  score: number;\n  skillOverlap: number;\n  experienceMatch: number;\n  softSkillRelevance: number;\n  reasoning: string;\n}\n\nexport interface RiskAnalysis {\n  risk_level: \"low\" | \"medium\" | \"high\" | \"critical\";\n  delay_percentage: number;\n  predicted_issues: string[];\n  recommendations: string[];\n  backup_required: boolean;\n}\n\n// Generate AI skill map from milestone description\nexport async function generateSkillMap(milestoneName: string, milestoneDescription: string): Promise<SkillMap> {\n  return geminiRateLimiter.executeWithRetry(async () => {\n    try {\n      const prompt = `Analyze this project milestone and extract structured skill requirements:\n\nMilestone: ${milestoneName}\nDescription: ${milestoneDescription}\n\nExtract and return:\n1. Required technical skills (programming languages, frameworks, tools)\n2. Experience level needed (Entry, Intermediate, Advanced, Expert)\n3. Soft skills required (communication, problem-solving, etc.)\n\nReturn ONLY valid JSON in this exact format:\n{\n  \"milestone\": \"${milestoneName}\",\n  \"required_skills\": [\"skill1\", \"skill2\", \"skill3\"],\n  \"experience_level\": \"Intermediate\",\n  \"soft_skills\": [\"soft_skill1\", \"soft_skill2\"]\n}`;\n\n      const response = await ai.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        config: {\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              milestone: { type: \"string\" },\n              required_skills: { \n                type: \"array\",\n                items: { type: \"string\" }\n              },\n              experience_level: { type: \"string\" },\n              soft_skills: {\n                type: \"array\",\n                items: { type: \"string\" }\n              }\n            },\n            required: [\"milestone\", \"required_skills\", \"experience_level\", \"soft_skills\"]\n          }\n        },\n        contents: prompt,\n      });\n\n      const result = JSON.parse(response.text || \"{}\");\n      return result as SkillMap;\n    } catch (error) {\n      console.error(\"Error generating skill map:\", error);\n      throw new Error(\"Failed to generate skill map with AI\");\n    }\n  });\n}\n\n// Analyze CV text and extract candidate profile\nexport async function analyzeCVText(cvText: string): Promise<CVAnalysis> {\n  return geminiRateLimiter.executeWithRetry(async () => {\n    try {\n      const prompt = `Analyze this CV/resume text and extract the candidate's profile:\n\n${cvText}\n\nExtract and return:\n1. Full name\n2. Email address (if present)\n3. Technical skills (programming languages, frameworks, tools)\n4. Work experience summary\n5. Education background\n6. Soft skills\n7. Domain expertise areas\n\nReturn ONLY valid JSON in this exact format:\n{\n  \"name\": \"Full Name\",\n  \"email\": \"email@example.com\",\n  \"skills\": [\"skill1\", \"skill2\", \"skill3\"],\n  \"experience\": \"Brief summary of work experience\",\n  \"education\": \"Education background\",\n  \"soft_skills\": [\"soft_skill1\", \"soft_skill2\"],\n  \"domain_expertise\": [\"domain1\", \"domain2\"]\n}`;\n\n      const response = await ai.models.generateContent({\n        model: \"gemini-2.5-pro\",\n        config: {\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              name: { type: \"string\" },\n              email: { type: \"string\" },\n              skills: {\n                type: \"array\",\n                items: { type: \"string\" }\n              },\n              experience: { type: \"string\" },\n              education: { type: \"string\" },\n              soft_skills: {\n                type: \"array\",\n                items: { type: \"string\" }\n              },\n              domain_expertise: {\n                type: \"array\",\n                items: { type: \"string\" }\n              }\n            },\n            required: [\"name\", \"skills\", \"experience\", \"education\"]\n          }\n        },\n        contents: prompt,\n      });\n\n      const result = JSON.parse(response.text || \"{}\");\n      return result as CVAnalysis;\n    } catch (error) {\n      console.error(\"Error analyzing CV:\", error);\n      throw new Error(\"Failed to analyze CV with AI\");\n    }\n  });\n}\n\n// Calculate fit score between candidate and milestone\nexport async function calculateFitScore(\n  candidateSkills: string[],\n  candidateExperience: string,\n  skillMap: SkillMap\n): Promise<FitScoreAnalysis> {\n  return geminiRateLimiter.executeWithRetry(async () => {\n    try {\n      const prompt = `Analyze the fit between this candidate and milestone requirements:\n\nCandidate Skills: ${candidateSkills.join(\", \")}\nCandidate Experience: ${candidateExperience}\n\nMilestone Requirements:\n- Required Skills: ${skillMap.required_skills.join(\", \")}\n- Experience Level: ${skillMap.experience_level}\n- Soft Skills: ${skillMap.soft_skills.join(\", \")}\n\nCalculate:\n1. Skill Overlap (0-100): How many required skills does the candidate have?\n2. Experience Match (0-100): Does their experience level match?\n3. Soft Skill Relevance (0-100): Do they have relevant soft skills?\n4. Overall Fit Score (0-100): Weighted average (60% skills, 30% experience, 10% soft skills)\n5. Brief reasoning for the score\n\nReturn ONLY valid JSON:\n{\n  \"score\": 85,\n  \"skillOverlap\": 90,\n  \"experienceMatch\": 80,\n  \"softSkillRelevance\": 75,\n  \"reasoning\": \"Brief explanation of why this score was given\"\n}`;\n\n      const response = await ai.models.generateContent({\n        model: \"gemini-2.5-pro\",\n        config: {\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              score: { type: \"number\" },\n              skillOverlap: { type: \"number\" },\n              experienceMatch: { type: \"number\" },\n              softSkillRelevance: { type: \"number\" },\n              reasoning: { type: \"string\" }\n            },\n            required: [\"score\", \"skillOverlap\", \"experienceMatch\", \"softSkillRelevance\", \"reasoning\"]\n          }\n        },\n        contents: prompt,\n      });\n\n      const result = JSON.parse(response.text || \"{}\");\n      // Ensure all scores are integers\n      return {\n        score: Math.round(result.score || 0),\n        skillOverlap: Math.round(result.skillOverlap || 0),\n        experienceMatch: Math.round(result.experienceMatch || 0),\n        softSkillRelevance: Math.round(result.softSkillRelevance || 0),\n        reasoning: result.reasoning || \"\",\n      };\n    } catch (error) {\n      console.error(\"Error calculating fit score:\", error);\n      throw new Error(\"Failed to calculate fit score with AI\");\n    }\n  });\n}\n\n// Predict project risk based on delay\nexport async function predictRisk(\n  milestoneName: string,\n  milestoneDescription: string,\n  delayPercentage: number,\n  estimatedHours: number\n): Promise<RiskAnalysis> {\n  return geminiRateLimiter.executeWithRetry(async () => {\n    try {\n      const prompt = `Analyze this project milestone for risk:\n\nMilestone: ${milestoneName}\nDescription: ${milestoneDescription}\nEstimated Hours: ${estimatedHours}\nCurrent Delay: ${delayPercentage}%\n\nAnalyze the risk and provide:\n1. Risk Level (low, medium, high, critical)\n2. Predicted Issues (what could go wrong)\n3. Recommendations (how to mitigate)\n4. Whether backup talent should be activated (true/false)\n\nRisk criteria (4-tier escalation):\n- Delay <10%: No significant risk\n- Delay 10-20%: Low risk (monitor only, notify business)\n- Delay 20-30%: Medium risk (notify + prepare backup list)\n- Delay 30-40%: High risk (notify + backup ready, require decision)\n- Delay >40%: Critical risk (auto-activate backup + escalate)\n\nReturn ONLY valid JSON:\n{\n  \"risk_level\": \"high\",\n  \"delay_percentage\": ${delayPercentage},\n  \"predicted_issues\": [\"issue1\", \"issue2\"],\n  \"recommendations\": [\"recommendation1\", \"recommendation2\"],\n  \"backup_required\": true\n}`;\n\n      const response = await ai.models.generateContent({\n        model: \"gemini-2.5-pro\",\n        config: {\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              risk_level: { \n                type: \"string\",\n                enum: [\"low\", \"medium\", \"high\", \"critical\"]\n              },\n              delay_percentage: { type: \"number\" },\n              predicted_issues: {\n                type: \"array\",\n                items: { type: \"string\" }\n              },\n              recommendations: {\n                type: \"array\",\n                items: { type: \"string\" }\n              },\n              backup_required: { type: \"boolean\" }\n            },\n            required: [\"risk_level\", \"delay_percentage\", \"predicted_issues\", \"recommendations\", \"backup_required\"]\n          }\n        },\n        contents: prompt,\n      });\n\n      const result = JSON.parse(response.text || \"{}\");\n      return result as RiskAnalysis;\n    } catch (error) {\n      console.error(\"Error predicting risk:\", error);\n      throw new Error(\"Failed to predict risk with AI\");\n    }\n  });\n}\n","size_bytes":9552},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE - Pure Monochrome: Black, White, Gray */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  --opaque-button-border-intensity: -8;\n\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  /* Pure White Background (#FFFFFF) */\n  --background: 0 0% 100%;\n  /* Pure Black Foreground (#000000) */\n  --foreground: 0 0% 0%;\n  /* Gray Border (#E0E0E0 = 88% lightness) */\n  --border: 0 0% 88%;\n\n  /* Card: Off-white for subtle elevation */\n  --card: 0 0% 98%;\n  --card-foreground: 0 0% 0%;\n  --card-border: 0 0% 88%;\n\n  /* Sidebar: Light gray background */\n  --sidebar: 0 0% 97%;\n  --sidebar-foreground: 0 0% 0%;\n  --sidebar-border: 0 0% 88%;\n  --sidebar-primary: 0 0% 0%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 0 0% 93%;\n  --sidebar-accent-foreground: 0 0% 0%;\n  --sidebar-ring: 0 0% 0%;\n\n  /* Popover */\n  --popover: 0 0% 97%;\n  --popover-foreground: 0 0% 0%;\n  --popover-border: 0 0% 88%;\n\n  /* Primary: Black (#000000) */\n  --primary: 0 0% 0%;\n  --primary-foreground: 0 0% 100%;\n\n  /* Secondary: Mid Gray */\n  --secondary: 0 0% 93%;\n  --secondary-foreground: 0 0% 0%;\n\n  /* Muted: Light Gray */\n  --muted: 0 0% 96%;\n  --muted-foreground: 0 0% 45%;\n\n  /* Accent: Light Gray (#E0E0E0) */\n  --accent: 0 0% 88%;\n  --accent-foreground: 0 0% 0%;\n\n  /* Destructive: Keep for error states */\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 0 0% 100%;\n\n  /* Input: Gray */\n  --input: 0 0% 88%;\n  --ring: 0 0% 0%;\n\n  /* Charts: Grayscale */\n  --chart-1: 0 0% 20%;\n  --chart-2: 0 0% 35%;\n  --chart-3: 0 0% 50%;\n  --chart-4: 0 0% 65%;\n  --chart-5: 0 0% 80%;\n\n  /* Font: Inter for minimalist professional feel */\n  --font-sans: 'Inter', sans-serif;\n  --font-serif: 'Inter', sans-serif;\n  --font-mono: Menlo, monospace;\n  --radius: 0.5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00), 0px 1px 2px -1px hsl(9, 75%, 61% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00), 0px 1px 2px -1px hsl(9, 75%, 61% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00), 0px 2px 4px -1px hsl(9, 75%, 61% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00), 0px 4px 6px -1px hsl(9, 75%, 61% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00), 0px 8px 10px -1px hsl(9, 75%, 61% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(9, 75%, 61% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n/* DARK MODE - Pure Monochrome: Black, White, Gray */\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;\n\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  /* Dark background */\n  --background: 0 0% 5%;\n  /* Light foreground */\n  --foreground: 0 0% 95%;\n  --border: 0 0% 15%;\n\n  /* Card: Slightly lighter than background */\n  --card: 0 0% 8%;\n  --card-foreground: 0 0% 95%;\n  --card-border: 0 0% 15%;\n\n  /* Sidebar */\n  --sidebar: 0 0% 8%;\n  --sidebar-foreground: 0 0% 95%;\n  --sidebar-border: 0 0% 15%;\n  --sidebar-primary: 0 0% 95%;\n  --sidebar-primary-foreground: 0 0% 5%;\n  --sidebar-accent: 0 0% 15%;\n  --sidebar-accent-foreground: 0 0% 95%;\n  --sidebar-ring: 0 0% 95%;\n\n  /* Popover */\n  --popover: 0 0% 5%;\n  --popover-foreground: 0 0% 95%;\n  --popover-border: 0 0% 15%;\n\n  /* Primary: White on dark */\n  --primary: 0 0% 95%;\n  --primary-foreground: 0 0% 5%;\n\n  /* Secondary: Mid Gray */\n  --secondary: 0 0% 20%;\n  --secondary-foreground: 0 0% 95%;\n\n  /* Muted */\n  --muted: 0 0% 15%;\n  --muted-foreground: 0 0% 60%;\n\n  /* Accent: Dark Gray */\n  --accent: 0 0% 15%;\n  --accent-foreground: 0 0% 95%;\n\n  /* Destructive: Keep red for error states */\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 0 0% 100%;\n\n  /* Input */\n  --input: 0 0% 15%;\n  --ring: 0 0% 95%;\n\n  /* Charts: Grayscale */\n  --chart-1: 0 0% 80%;\n  --chart-2: 0 0% 65%;\n  --chart-3: 0 0% 50%;\n  --chart-4: 0 0% 35%;\n  --chart-5: 0 0% 20%;\n\n  --shadow-2xs: 0px 1px 2px 0px rgba(0, 0, 0, 0.3);\n  --shadow-xs: 0px 1px 2px 0px rgba(0, 0, 0, 0.3);\n  --shadow-sm: 0px 1px 3px 0px rgba(0, 0, 0, 0.4), 0px 1px 2px -1px rgba(0, 0, 0, 0.4);\n  --shadow: 0px 1px 3px 0px rgba(0, 0, 0, 0.4), 0px 1px 2px -1px rgba(0, 0, 0, 0.4);\n  --shadow-md: 0px 4px 6px -1px rgba(0, 0, 0, 0.5), 0px 2px 4px -2px rgba(0, 0, 0, 0.5);\n  --shadow-lg: 0px 10px 15px -3px rgba(0, 0, 0, 0.6), 0px 4px 6px -4px rgba(0, 0, 0, 0.6);\n  --shadow-xl: 0px 20px 25px -5px rgba(0, 0, 0, 0.7), 0px 8px 10px -6px rgba(0, 0, 0, 0.7);\n  --shadow-2xl: 0px 25px 50px -12px rgba(0, 0, 0, 0.8);\n\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n@layer utilities {\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: -1;\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: 999;\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}","size_bytes":9138},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"server/routes.ts":{"content":"import type { Express, Request, Response, NextFunction } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport multer from \"multer\";\nimport { readFileSync, writeFileSync, mkdirSync } from \"fs\";\nimport { join } from \"path\";\nimport { generateSkillMap, analyzeCVText, calculateFitScore, predictRisk } from \"./gemini\";\nimport { syncJiraMilestones, getIssueProgress, monitorProjectDelays, fetchAllJiraProjects, fetchProjectSprints, fetchSprintIssues } from \"./jira-service\";\nimport { insertProjectSchema, insertMilestoneSchema, insertCandidateSchema, insertFitScoreSchema, insertJiraSettingsSchema, type Milestone } from \"@shared/schema\";\nimport { validateFileType } from \"./document-parser\";\nimport { calculateFallbackFitScore, extractFallbackSkillMap } from \"./fallback-scoring\";\nimport { encrypt, decrypt, safeEncrypt, safeDecrypt } from \"./encryption\";\nimport { startJobWorker } from \"./job-worker\";\n\n// ========== AUTH MIDDLEWARE ==========\nfunction requireAuth(req: Request, res: Response, next: NextFunction) {\n  if (!req.session.userId || !req.session.email || !req.session.role) {\n    return res.status(401).json({ error: \"Unauthorized. Please log in.\" });\n  }\n  next();\n}\n\nfunction requireBusiness(req: Request, res: Response, next: NextFunction) {\n  if (!req.session.userId || !req.session.email || !req.session.role) {\n    return res.status(401).json({ error: \"Unauthorized. Please log in.\" });\n  }\n  if (req.session.role !== \"business\") {\n    return res.status(403).json({ error: \"Forbidden. Business access required.\" });\n  }\n  next();\n}\n\nfunction requireCandidate(req: Request, res: Response, next: NextFunction) {\n  if (!req.session.userId || !req.session.email || !req.session.role) {\n    return res.status(401).json({ error: \"Unauthorized. Please log in.\" });\n  }\n  if (req.session.role !== \"candidate\") {\n    return res.status(403).json({ error: \"Forbidden. Candidate access required.\" });\n  }\n  next();\n}\n\n// Configure multer to accept PDF, DOC, DOCX, TXT files\nconst upload = multer({ \n  dest: \"uploads/\",\n  limits: {\n    fileSize: 10 * 1024 * 1024, // 10MB max file size\n  },\n  fileFilter: (req, file, cb) => {\n    const validation = validateFileType(file.originalname, file.mimetype);\n    if (!validation.valid) {\n      cb(new Error(validation.error || \"Invalid file type\"));\n    } else {\n      cb(null, true);\n    }\n  }\n});\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // ========== PROJECTS ==========\n  \n  // Get all projects\n  app.get(\"/api/projects\", async (req, res) => {\n    try {\n      const projects = await storage.getAllProjects();\n      res.json(projects);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Get project by ID\n  app.get(\"/api/projects/:id\", async (req, res) => {\n    try {\n      const project = await storage.getProject(req.params.id);\n      if (!project) {\n        return res.status(404).json({ error: \"Project not found\" });\n      }\n      res.json(project);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Create project with milestones and AI skill map generation\n  app.post(\"/api/projects\", async (req, res) => {\n    try {\n      const validated = insertProjectSchema.parse({\n        name: req.body.name,\n        description: req.body.description,\n        businessUserId: req.body.businessUserId,\n        jiraProjectKey: req.body.jiraProjectKey,\n      });\n\n      const project = await storage.createProject(validated);\n\n      // Create milestones with AI-generated skill maps\n      if (req.body.milestones && Array.isArray(req.body.milestones)) {\n        for (const m of req.body.milestones) {\n          // Generate skill map using Gemini AI\n          let skillMap = null;\n          try {\n            skillMap = await generateSkillMap(m.name, m.description);\n          } catch (error) {\n            console.error(\"Failed to generate skill map:\", error);\n          }\n\n          const milestone = await storage.createMilestone({\n            projectId: project.id,\n            name: m.name,\n            description: m.description,\n            estimatedHours: m.estimatedHours,\n            skillMap: skillMap as any,\n          });\n\n          // Auto-match candidates if skill map was generated\n          if (skillMap) {\n            const candidates = await storage.getAllCandidates();\n            for (const candidate of candidates) {\n              if (candidate.skills && candidate.skills.length > 0) {\n                try {\n                  const fitAnalysis = await calculateFitScore(\n                    candidate.skills,\n                    candidate.experience || \"\",\n                    skillMap\n                  );\n\n                  await storage.createFitScore({\n                    candidateId: candidate.id,\n                    milestoneId: milestone.id,\n                    score: Math.round(fitAnalysis.score),\n                    skillOverlap: Math.round(fitAnalysis.skillOverlap),\n                    experienceMatch: Math.round(fitAnalysis.experienceMatch),\n                    softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n                    reasoning: fitAnalysis.reasoning,\n                  });\n                } catch (error) {\n                  console.error(`Failed to calculate fit score for candidate ${candidate.id}:`, error);\n                }\n              }\n            }\n          }\n        }\n      }\n\n      // Sync with Jira if project key is provided\n      if (validated.jiraProjectKey) {\n        try {\n          await syncJiraMilestones(validated.jiraProjectKey, validated.businessUserId);\n        } catch (error) {\n          console.error(\"Failed to sync with Jira:\", error);\n        }\n      }\n\n      res.json(project);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Get Jira settings for business user\n  app.get(\"/api/jira/settings/:businessUserId\", async (req, res) => {\n    try {\n      const { businessUserId } = req.params;\n      const settings = await storage.getJiraSettings(businessUserId);\n      \n      if (!settings) {\n        return res.json({ \n          isConfigured: false,\n          connectionType: \"replit_connector\"\n        });\n      }\n      \n      // Don't send API token in response\n      const { jiraApiToken, ...safeSettings } = settings;\n      res.json(safeSettings);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Save Jira settings (with encryption for API token)\n  app.post(\"/api/jira/settings\", async (req, res) => {\n    try {\n      const validated = insertJiraSettingsSchema.parse(req.body);\n      \n      // Encrypt API token before saving\n      if (validated.jiraApiToken) {\n        validated.jiraApiToken = safeEncrypt(validated.jiraApiToken);\n      }\n      \n      const settings = await storage.saveJiraSettings(validated);\n      \n      // Don't send API token in response\n      const { jiraApiToken, ...safeSettings } = settings;\n      res.json(safeSettings);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Test Jira connection\n  app.post(\"/api/jira/test-connection\", async (req, res) => {\n    try {\n      const { businessUserId } = req.body;\n      \n      // Try to fetch projects to test connection\n      const jiraProjects = await fetchAllJiraProjects(businessUserId);\n      \n      // Update last synced time\n      await storage.updateJiraSettings(businessUserId, {\n        isConfigured: true,\n        lastSyncedAt: new Date()\n      });\n      \n      res.json({ \n        success: true, \n        projectCount: jiraProjects.length,\n        message: `Successfully connected! Found ${jiraProjects.length} Jira projects.`\n      });\n    } catch (error: any) {\n      res.status(400).json({ \n        success: false,\n        error: error.message \n      });\n    }\n  });\n\n  // Import projects from Jira\n  app.post(\"/api/jira/import-projects\", async (req, res) => {\n    const businessUserId = req.body.businessUserId || \"demo-business-user\";\n    \n    try {\n      // Fetch all projects from Jira\n      const jiraProjects = await fetchAllJiraProjects(businessUserId);\n\n      const importedProjects = [];\n\n      for (const jiraProject of jiraProjects) {\n        // Check if project already exists\n        const existingProjects = await storage.getAllProjects();\n        let project = existingProjects.find(p => p.jiraProjectKey === jiraProject.key);\n\n        if (project) {\n          console.log(`Project ${jiraProject.key} already exists, re-syncing tasks...`);\n        } else {\n          // Create project in database\n          project = await storage.createProject({\n            name: jiraProject.name,\n            description: jiraProject.description || `Imported from Jira project ${jiraProject.key}`,\n            businessUserId,\n            jiraProjectKey: jiraProject.key,\n          });\n        }\n\n        // Fetch and create milestones from Jira sprints\n        try {\n          const sprints = await fetchProjectSprints(jiraProject.key, businessUserId);\n          \n          if (sprints.length === 0) {\n            console.log(`No sprints found for project ${jiraProject.key}, falling back to issue-based import`);\n            // Fallback: use legacy approach for projects without sprints\n            const issues = await syncJiraMilestones(jiraProject.key, businessUserId);\n            \n            for (const issue of issues) {\n              let skillMap = null;\n              try {\n                skillMap = await generateSkillMap(issue.summary, issue.description || \"\");\n              } catch (error) {\n                console.error(`Failed to generate skill map for issue ${issue.key}:`, error);\n              }\n\n              const milestone = await storage.createMilestone({\n                projectId: project.id,\n                name: issue.summary,\n                description: issue.description || \"\",\n                estimatedHours: issue.timeEstimate ? issue.timeEstimate / 3600 : 40,\n                skillMap: skillMap as any,\n              });\n\n              if (skillMap) {\n                const candidates = await storage.getAllCandidates();\n                for (const candidate of candidates) {\n                  if (candidate.skills && candidate.skills.length > 0) {\n                    try {\n                      const fitAnalysis = await calculateFitScore(\n                        candidate.skills,\n                        candidate.experience || \"\",\n                        skillMap\n                      );\n\n                      await storage.createFitScore({\n                        candidateId: candidate.id,\n                        milestoneId: milestone.id,\n                        score: Math.round(fitAnalysis.score),\n                        skillOverlap: Math.round(fitAnalysis.skillOverlap),\n                        experienceMatch: Math.round(fitAnalysis.experienceMatch),\n                        softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n                        reasoning: fitAnalysis.reasoning,\n                      });\n                    } catch (error) {\n                      console.error(`Failed to calculate fit score for candidate ${candidate.id}:`, error);\n                    }\n                  }\n                }\n              }\n            }\n          } else {\n            // Sprint-based import: Each sprint becomes a milestone\n            // Get existing milestones to check for duplicates\n            const existingMilestones = await storage.getMilestonesByProject(project.id);\n            \n            for (const sprint of sprints) {\n              // Fetch all issues in this sprint\n              const sprintIssues = await fetchSprintIssues(sprint.id, businessUserId);\n              \n              if (sprintIssues.length === 0) {\n                console.log(`No issues found in sprint ${sprint.name}`);\n                continue;\n              }\n              \n              // Calculate total estimated hours for the sprint\n              const totalHours = sprintIssues.reduce((sum, issue) => {\n                return sum + (issue.timeEstimate ? issue.timeEstimate / 3600 : 0);\n              }, 0);\n              \n              // Create description with all tasks listed\n              const tasksDescription = sprintIssues\n                .map(issue => `- [${issue.status}] ${issue.key}: ${issue.summary}`)\n                .join('\\n');\n              \n              const sprintDescription = `${sprint.goal || 'Sprint tasks'}\\n\\n**Tasks (${sprintIssues.length}):**\\n${tasksDescription}`;\n              \n              // Generate skill map from all sprint tasks combined\n              const combinedTaskSummary = sprintIssues.map(i => i.summary).join('; ');\n              let skillMap = null;\n              try {\n                skillMap = await generateSkillMap(sprint.name, combinedTaskSummary);\n              } catch (error) {\n                console.error(`Failed to generate skill map for sprint ${sprint.name}:`, error);\n              }\n\n              // Check if milestone for this sprint already exists\n              const existingMilestone = existingMilestones.find(m => m.name === sprint.name);\n              \n              let milestone: Milestone;\n              if (existingMilestone) {\n                // Update existing milestone with latest data\n                console.log(`Updating existing milestone: ${sprint.name}`);\n                const updated = await storage.updateMilestone(existingMilestone.id, {\n                  description: sprintDescription,\n                  estimatedHours: totalHours || 80,\n                  skillMap: skillMap as any,\n                });\n                milestone = updated || existingMilestone;\n              } else {\n                // Create new milestone\n                milestone = await storage.createMilestone({\n                  projectId: project.id,\n                  name: sprint.name,\n                  description: sprintDescription,\n                  estimatedHours: totalHours || 80,\n                  skillMap: skillMap as any,\n                });\n              }\n\n              // Auto-match candidates if skill map was generated\n              if (skillMap && milestone) {\n                const candidates = await storage.getAllCandidates();\n                for (const candidate of candidates) {\n                  if (candidate.skills && candidate.skills.length > 0) {\n                    try {\n                      const fitAnalysis = await calculateFitScore(\n                        candidate.skills,\n                        candidate.experience || \"\",\n                        skillMap\n                      );\n\n                      // Check if fit score already exists for this candidate-milestone pair\n                      const existingFitScores = await storage.getTopCandidatesForMilestone(milestone.id, 1000);\n                      const existingFitScore = existingFitScores.find(fs => fs.candidate.id === candidate.id);\n\n                      if (existingFitScore) {\n                        // Update existing fit score\n                        await storage.updateFitScore(existingFitScore.id, {\n                          score: Math.round(fitAnalysis.score),\n                          skillOverlap: Math.round(fitAnalysis.skillOverlap),\n                          experienceMatch: Math.round(fitAnalysis.experienceMatch),\n                          softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n                          reasoning: fitAnalysis.reasoning,\n                        });\n                      } else {\n                        // Create new fit score\n                        await storage.createFitScore({\n                          candidateId: candidate.id,\n                          milestoneId: milestone.id,\n                          score: fitAnalysis.score,\n                          skillOverlap: fitAnalysis.skillOverlap,\n                          experienceMatch: fitAnalysis.experienceMatch,\n                          softSkillRelevance: fitAnalysis.softSkillRelevance,\n                          reasoning: fitAnalysis.reasoning,\n                        });\n                      }\n                    } catch (error) {\n                      console.error(`Failed to calculate fit score for candidate ${candidate.id}:`, error);\n                    }\n                  }\n                }\n              }\n            }\n          }\n        } catch (error) {\n          console.error(`Failed to sync milestones for project ${jiraProject.key}:`, error);\n        }\n\n        importedProjects.push(project);\n      }\n\n      res.json({\n        success: true,\n        imported: importedProjects.length,\n        projects: importedProjects,\n      });\n    } catch (error: any) {\n      console.error(\"Error importing Jira projects:\", error);\n      \n      // Log the failed sync\n      await storage.createJiraSyncLog({\n        businessUserId,\n        syncType: 'import_projects',\n        status: 'failed',\n        error: error.message,\n        errorDetails: {\n          stack: error.stack,\n          statusCode: error?.response?.status\n        } as any,\n        canRetry: true,\n        startedAt: new Date(),\n        completedAt: new Date(),\n      });\n      \n      res.status(500).json({ \n        error: error.message,\n        canRetry: true,\n        message: 'Jira import failed. You can retry from the dashboard.'\n      });\n    }\n  });\n\n  // Get milestones for a project\n  app.get(\"/api/projects/:id/milestones\", async (req, res) => {\n    try {\n      const milestones = await storage.getMilestonesByProject(req.params.id);\n      res.json(milestones);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Get top candidates for a project\n  app.get(\"/api/projects/:id/candidates\", async (req, res) => {\n    try {\n      const milestones = await storage.getMilestonesByProject(req.params.id);\n      const allCandidates: any[] = [];\n\n      for (const milestone of milestones) {\n        const topCandidates = await storage.getTopCandidatesForMilestone(milestone.id, 5);\n        for (const tc of topCandidates) {\n          if (!allCandidates.find(c => c.id === tc.candidate.id)) {\n            allCandidates.push({\n              ...tc.candidate,\n              fitScore: tc.score,\n            });\n          }\n        }\n      }\n\n      res.json(allCandidates);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Get risk alerts for a project\n  app.get(\"/api/projects/:id/risks\", async (req, res) => {\n    try {\n      const milestones = await storage.getMilestonesByProject(req.params.id);\n      const allRisks = [];\n\n      for (const milestone of milestones) {\n        const risks = await storage.getRiskAlertsByMilestone(milestone.id);\n        for (const risk of risks) {\n          allRisks.push({\n            ...risk,\n            milestoneName: milestone.name,\n          });\n        }\n      }\n\n      res.json(allRisks);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // ========== BUSINESS REVIEW WORKFLOW (P1-7) ==========\n  \n  // Approve/edit skill map for a milestone\n  app.patch(\"/api/milestones/:id/approve-skillmap\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { skillMap, approved } = req.body;\n      \n      // Validate approved flag if provided\n      if (approved !== undefined && typeof approved !== 'boolean') {\n        return res.status(400).json({ error: \"approved must be a boolean\" });\n      }\n      \n      const milestone = await storage.getMilestone(id);\n      if (!milestone) {\n        return res.status(404).json({ error: \"Milestone not found\" });\n      }\n      \n      // Build update object - only update fields that are provided\n      const updateData: any = {};\n      if (skillMap !== undefined) {\n        updateData.skillMap = skillMap;\n      }\n      if (approved !== undefined) {\n        updateData.skillMapApproved = approved;\n      }\n      \n      // Update milestone\n      const updated = await storage.updateMilestone(id, updateData);\n      \n      // If approved, always recalculate fit scores using the current skill map\n      const finalSkillMap = skillMap || milestone.skillMap;\n      if (approved && finalSkillMap) {\n        const candidates = await storage.getAllCandidates();\n        for (const candidate of candidates) {\n          if (candidate.skills && candidate.skills.length > 0) {\n            try {\n              const { calculateFitScore } = await import(\"./gemini.js\");\n              const fitAnalysis = await calculateFitScore(\n                candidate.skills,\n                candidate.experience || \"\",\n                finalSkillMap // Use finalSkillMap, not skillMap!\n              );\n              \n              // Check if fit score exists\n              const existingFitScores = await storage.getTopCandidatesForMilestone(id, 1000);\n              const existingFitScore = existingFitScores.find(fs => fs.candidate.id === candidate.id);\n              \n              if (existingFitScore) {\n                await storage.updateFitScore(existingFitScore.id, {\n                  score: Math.round(fitAnalysis.score),\n                  skillOverlap: Math.round(fitAnalysis.skillOverlap),\n                  experienceMatch: Math.round(fitAnalysis.experienceMatch),\n                  softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n                  reasoning: fitAnalysis.reasoning,\n                });\n              } else {\n                await storage.createFitScore({\n                  candidateId: candidate.id,\n                  milestoneId: id,\n                  score: fitAnalysis.score,\n                  skillOverlap: fitAnalysis.skillOverlap,\n                  experienceMatch: fitAnalysis.experienceMatch,\n                  softSkillRelevance: fitAnalysis.softSkillRelevance,\n                  reasoning: fitAnalysis.reasoning,\n                });\n              }\n            } catch (error) {\n              console.error(`Failed to calculate fit score for candidate ${candidate.id}:`, error);\n            }\n          }\n        }\n      }\n      \n      res.json(updated);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Mark candidates as notified for a milestone\n  app.post(\"/api/milestones/:id/notify-candidates\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { candidateIds } = req.body; // Array of candidate IDs to notify\n      \n      if (!candidateIds || !Array.isArray(candidateIds)) {\n        return res.status(400).json({ error: \"candidateIds array is required\" });\n      }\n      \n      const milestone = await storage.getMilestone(id);\n      if (!milestone) {\n        return res.status(404).json({ error: \"Milestone not found\" });\n      }\n      \n      if (!milestone.skillMapApproved) {\n        return res.status(400).json({ error: \"Skill map must be approved before notifying candidates\" });\n      }\n      \n      // Mark as notified\n      await storage.updateMilestone(id, {\n        candidatesNotified: true,\n      });\n      \n      // In a real system, this would send email notifications to selected candidates\n      // For now, we just mark the milestone as having notified candidates\n      \n      res.json({ \n        success: true, \n        notifiedCount: candidateIds.length,\n        message: `Notified ${candidateIds.length} candidates about this opportunity`\n      });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Sync Jira tasks for a specific project\n  app.post(\"/api/projects/:id/sync-jira\", async (req, res) => {\n    try {\n      const projectId = req.params.id;\n      const project = await storage.getProject(projectId);\n\n      if (!project) {\n        return res.status(404).json({ error: \"Project not found\" });\n      }\n\n      if (!project.jiraProjectKey) {\n        return res.status(400).json({ error: \"Project is not linked to Jira\" });\n      }\n\n      const businessUserId = project.businessUserId || \"demo-business-user\";\n\n      // Fetch issues from Jira\n      const issues = await syncJiraMilestones(project.jiraProjectKey, businessUserId);\n      \n      // Get existing milestones to check for duplicates\n      const existingMilestones = await storage.getMilestonesByProject(projectId);\n      let createdCount = 0;\n      let updatedCount = 0;\n\n      for (const issue of issues) {\n        let skillMap = null;\n        try {\n          skillMap = await generateSkillMap(issue.summary, issue.description || \"\");\n        } catch (error) {\n          console.error(`Failed to generate skill map for issue ${issue.key}:`, error);\n        }\n\n        // Check if milestone already exists (by name)\n        const existingMilestone = existingMilestones.find(m => m.name === issue.summary);\n\n        let milestone: Milestone;\n        if (existingMilestone) {\n          // Update existing milestone\n          console.log(`Updating existing milestone: ${issue.summary}`);\n          const updated = await storage.updateMilestone(existingMilestone.id, {\n            description: issue.description || \"\",\n            estimatedHours: issue.timeEstimate ? issue.timeEstimate / 3600 : 40,\n            skillMap: skillMap as any,\n            jiraIssueKey: issue.key,\n            jiraEpicKey: issue.epicKey || null,\n            jiraSprintId: issue.sprintId || null,\n            jiraSprintName: issue.sprintName || null,\n          });\n          milestone = updated || existingMilestone;\n          updatedCount++;\n        } else {\n          // Create new milestone\n          milestone = await storage.createMilestone({\n            projectId: project.id,\n            name: issue.summary,\n            description: issue.description || \"\",\n            estimatedHours: issue.timeEstimate ? issue.timeEstimate / 3600 : 40,\n            skillMap: skillMap as any,\n            jiraIssueKey: issue.key,\n            jiraEpicKey: issue.epicKey || null,\n            jiraSprintId: issue.sprintId || null,\n            jiraSprintName: issue.sprintName || null,\n          });\n          createdCount++;\n        }\n\n        // Auto-match candidates if skill map was generated\n        if (skillMap) {\n          const candidates = await storage.getAllCandidates();\n          for (const candidate of candidates) {\n            if (candidate.skills && candidate.skills.length > 0) {\n              try {\n                const fitAnalysis = await calculateFitScore(\n                  candidate.skills,\n                  candidate.experience || \"\",\n                  skillMap\n                );\n\n                // Check if fit score already exists\n                const existingFitScores = await storage.getFitScoresByMilestone(milestone.id);\n                const existingScore = existingFitScores.find(fs => fs.candidateId === candidate.id);\n\n                if (existingScore) {\n                  // Update existing fit score\n                  await storage.updateFitScore(existingScore.id, {\n                    score: fitAnalysis.score,\n                    skillOverlap: fitAnalysis.skillOverlap,\n                    experienceMatch: fitAnalysis.experienceMatch,\n                    softSkillRelevance: fitAnalysis.softSkillRelevance,\n                    reasoning: fitAnalysis.reasoning,\n                  });\n                } else {\n                  // Create new fit score\n                  await storage.createFitScore({\n                    candidateId: candidate.id,\n                    milestoneId: milestone.id,\n                    score: Math.round(fitAnalysis.score),\n                    skillOverlap: Math.round(fitAnalysis.skillOverlap),\n                    experienceMatch: Math.round(fitAnalysis.experienceMatch),\n                    softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n                    reasoning: fitAnalysis.reasoning,\n                  });\n                }\n              } catch (error) {\n                console.error(`Failed to calculate fit score for candidate ${candidate.id}:`, error);\n              }\n            }\n          }\n        }\n      }\n\n      res.json({\n        success: true,\n        synced: issues.length,\n        created: createdCount,\n        updated: updatedCount,\n        message: `Synced ${issues.length} tasks from Jira (${createdCount} new, ${updatedCount} updated)`,\n      });\n    } catch (error: any) {\n      console.error(\"Error syncing Jira tasks:\", error);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // ========== AI ENDPOINTS ==========\n\n  // Generate skill map using Gemini AI\n  app.post(\"/api/ai/generate-skill-map\", async (req, res) => {\n    try {\n      const { name, description } = req.body;\n      \n      if (!name || !description) {\n        return res.status(400).json({ error: \"Name and description are required\" });\n      }\n\n      const skillMap = await generateSkillMap(name, description);\n      res.json({ skillMap });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Calculate fit score between candidate and milestone\n  app.post(\"/api/ai/calculate-fit-score\", async (req, res) => {\n    try {\n      const { candidateId, milestoneId } = req.body;\n\n      const candidate = await storage.getCandidate(candidateId);\n      const milestone = await storage.getMilestone(milestoneId);\n\n      if (!candidate || !milestone) {\n        return res.status(404).json({ error: \"Candidate or milestone not found\" });\n      }\n\n      if (!milestone.skillMap || !candidate.skills) {\n        return res.status(400).json({ error: \"Missing skill data\" });\n      }\n\n      const fitAnalysis = await calculateFitScore(\n        candidate.skills,\n        candidate.experience || \"\",\n        milestone.skillMap as any\n      );\n\n      const fitScore = await storage.createFitScore({\n        candidateId,\n        milestoneId,\n        score: Math.round(fitAnalysis.score),\n        skillOverlap: Math.round(fitAnalysis.skillOverlap),\n        experienceMatch: Math.round(fitAnalysis.experienceMatch),\n        softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n        reasoning: fitAnalysis.reasoning,\n      });\n\n      res.json(fitScore);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Predict risk for a milestone\n  app.post(\"/api/ai/predict-risk\", async (req, res) => {\n    try {\n      const { milestoneId, delayPercentage } = req.body;\n\n      const milestone = await storage.getMilestone(milestoneId);\n      if (!milestone) {\n        return res.status(404).json({ error: \"Milestone not found\" });\n      }\n\n      const riskAnalysis = await predictRisk(\n        milestone.name,\n        milestone.description,\n        delayPercentage || milestone.delayPercentage || 0,\n        milestone.estimatedHours || 40\n      );\n\n      // Update milestone risk level\n      await storage.updateMilestone(milestoneId, {\n        riskLevel: riskAnalysis.risk_level,\n        delayPercentage: riskAnalysis.delay_percentage,\n        status: riskAnalysis.risk_level === \"high\" ? \"delayed\" : milestone.status,\n      });\n\n      // Create risk alert\n      const riskAlert = await storage.createRiskAlert({\n        milestoneId,\n        riskLevel: riskAnalysis.risk_level,\n        delayPercentage: riskAnalysis.delay_percentage,\n        aiAnalysis: riskAnalysis as any,\n        backupActivated: false,\n      });\n\n      res.json({ riskAlert, analysis: riskAnalysis });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // ========== CANDIDATES ==========\n\n  // Get candidate profile (demo - using email param)\n  app.get(\"/api/candidate/profile\", async (req, res) => {\n    try {\n      const email = req.query.email as string || \"demo@example.com\";\n      let candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        candidate = await storage.createCandidate({\n          email,\n          name: \"Demo Candidate\",\n          isAvailable: true,\n        });\n      }\n\n      res.json(candidate);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Update candidate profile\n  app.put(\"/api/candidate/profile\", async (req, res) => {\n    try {\n      const email = req.query.email as string || \"demo@example.com\";\n      let candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        candidate = await storage.createCandidate({\n          email,\n          name: req.body.name,\n        });\n      } else {\n        candidate = await storage.updateCandidate(candidate.id, {\n          name: req.body.name,\n          phone: req.body.phone,\n          linkedinUrl: req.body.linkedinUrl,\n          githubUrl: req.body.githubUrl,\n          availableFrom: req.body.availableFrom ? new Date(req.body.availableFrom) : undefined,\n          availableUntil: req.body.availableUntil ? new Date(req.body.availableUntil) : undefined,\n        });\n      }\n\n      res.json(candidate);\n    } catch (error: any) {\n      res.status(400).json({ error: error.message });\n    }\n  });\n\n  // Upload and analyze CV with AI and auto-match to projects (Background Job)\n  app.post(\"/api/candidate/upload-cv\", upload.single(\"cv\"), async (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"No file uploaded\" });\n      }\n\n      const email = req.query.email as string || \"demo@example.com\";\n      let candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        return res.status(404).json({ error: \"Candidate not found. Please create profile first.\" });\n      }\n\n      // Update candidate with file path immediately\n      candidate = await storage.updateCandidate(candidate.id, {\n        cvFilePath: req.file.path,\n      });\n\n      if (!candidate) {\n        return res.status(500).json({ error: \"Failed to update candidate\" });\n      }\n\n      // Create background job for CV processing\n      const job = await storage.createJob({\n        jobType: \"cv_processing\",\n        userId: candidate.id,\n        userEmail: candidate.email,\n        status: \"pending\",\n        payload: {\n          candidateId: candidate.id,\n          filePath: req.file.path,\n          mimeType: req.file.mimetype,\n        } as any,\n        progress: 0,\n        maxAttempts: 3,\n      });\n\n      console.log(`✓ CV upload job ${job.id} created for candidate ${candidate.id}`);\n\n      // Return immediately - processing happens in background\n      res.json({ \n        success: true, \n        candidate,\n        jobId: job.id,\n        message: \"CV uploaded successfully. Processing in background...\"\n      });\n    } catch (error: any) {\n      console.error(\"CV upload error:\", error);\n      res.status(500).json({ \n        error: \"Failed to upload CV. Please try again.\",\n        details: error.message \n      });\n    }\n  });\n\n  // Get candidate recommendations (projects with >70% fit)\n  app.get(\"/api/candidate/recommendations\", async (req, res) => {\n    try {\n      const email = req.query.email as string || \"demo@example.com\";\n      const candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        return res.json([]);\n      }\n\n      const fitScores = await storage.getFitScoresByCandidate(candidate.id);\n      const recommendations = [];\n\n      // Get skipped jobs to filter them out\n      const actions = await storage.getActions(candidate.id);\n      const skippedMilestoneIds = actions\n        .filter(a => a.action === \"skip\")\n        .map(a => a.milestoneId);\n\n      for (const score of fitScores) {\n        // Filter out skipped jobs and only show high fit scores\n        if (score.score >= 70 && !skippedMilestoneIds.includes(score.milestoneId)) {\n          const milestone = await storage.getMilestone(score.milestoneId);\n          if (milestone) {\n            const project = await storage.getProject(milestone.projectId);\n            recommendations.push({\n              id: milestone.id,\n              projectId: project?.id,\n              projectName: project?.name,\n              milestoneName: milestone.name,\n              description: milestone.description,\n              fitScore: score.score,\n              skillOverlap: score.skillOverlap,\n              experienceMatch: score.experienceMatch,\n              softSkillRelevance: score.softSkillRelevance,\n              reasoning: score.reasoning,\n            });\n          }\n        }\n      }\n\n      // Sort by fit score descending\n      recommendations.sort((a, b) => b.fitScore - a.fitScore);\n\n      res.json(recommendations);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Get candidate stats\n  app.get(\"/api/candidate/stats\", async (req, res) => {\n    try {\n      const email = req.query.email as string || \"demo@example.com\";\n      const candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        return res.json({ applications: 0, matches: 0, avgFitScore: 0 });\n      }\n\n      const fitScores = await storage.getFitScoresByCandidate(candidate.id);\n      const applications = await storage.getApplicationsByCandidate(candidate.id);\n      const matches = fitScores.filter(s => s.score >= 70).length;\n      const avgFitScore = fitScores.length > 0\n        ? Math.round(fitScores.reduce((sum, s) => sum + s.score, 0) / fitScores.length)\n        : 0;\n\n      res.json({\n        applications: applications.length,\n        matches,\n        avgFitScore,\n      });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Save job for later\n  app.post(\"/api/candidate/save-job\", async (req, res) => {\n    try {\n      const { milestoneId } = req.body;\n      const email = req.query.email as string || \"demo@example.com\";\n      const candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        return res.status(404).json({ error: \"Candidate profile not found\" });\n      }\n\n      // Check if already saved\n      const isSaved = await storage.isJobSaved(candidate.id, milestoneId);\n      if (isSaved) {\n        return res.status(400).json({ error: \"Job already saved\" });\n      }\n\n      const savedJob = await storage.saveJob(candidate.id, milestoneId);\n      await storage.recordAction(candidate.id, milestoneId, \"save\");\n\n      res.json(savedJob);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Skip job\n  app.post(\"/api/candidate/skip-job\", async (req, res) => {\n    try {\n      const { milestoneId } = req.body;\n      const email = req.query.email as string || \"demo@example.com\";\n      const candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        return res.status(404).json({ error: \"Candidate profile not found\" });\n      }\n\n      await storage.recordAction(candidate.id, milestoneId, \"skip\");\n      res.json({ success: true });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Apply to job\n  app.post(\"/api/candidate/apply\", async (req, res) => {\n    try {\n      const { milestoneId, projectId } = req.body;\n      const email = req.query.email as string || \"demo@example.com\";\n      const candidate = await storage.getCandidateByEmail(email);\n\n      if (!candidate) {\n        return res.status(404).json({ error: \"Candidate profile not found\" });\n      }\n\n      // Create application\n      const application = await storage.createApplication({\n        candidateId: candidate.id,\n        milestoneId,\n        projectId,\n        status: \"pending\",\n      });\n\n      // Record action\n      await storage.recordAction(candidate.id, milestoneId, \"apply\");\n\n      res.json(application);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // ========== BUSINESS STATS ==========\n  \n  app.get(\"/api/business/stats\", async (req, res) => {\n    try {\n      const projects = await storage.getAllProjects();\n      const candidates = await storage.getAllCandidates();\n      \n      let totalScore = 0;\n      let scoreCount = 0;\n      let riskCount = 0;\n\n      for (const project of projects) {\n        const milestones = await storage.getMilestonesByProject(project.id);\n        for (const milestone of milestones) {\n          const scores = await storage.getFitScoresByMilestone(milestone.id);\n          totalScore += scores.reduce((sum, s) => sum + s.score, 0);\n          scoreCount += scores.length;\n\n          const risks = await storage.getRiskAlertsByMilestone(milestone.id);\n          riskCount += risks.filter(r => r.riskLevel === \"high\" || r.riskLevel === \"medium\").length;\n        }\n      }\n\n      res.json({\n        totalProjects: projects.length,\n        totalCandidates: candidates.length,\n        avgFitScore: scoreCount > 0 ? Math.round(totalScore / scoreCount) : 0,\n        riskAlerts: riskCount,\n      });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // ========== JIRA INTEGRATION ==========\n\n  // Sync Jira project\n  app.post(\"/api/jira/sync/:projectKey\", async (req, res) => {\n    try {\n      const businessUserId = req.body.businessUserId || \"demo-business-user\";\n      const issues = await syncJiraMilestones(req.params.projectKey, businessUserId);\n      res.json({ issues, count: issues.length });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Monitor project delays\n  app.get(\"/api/jira/monitor/:projectKey\", async (req, res) => {\n    try {\n      const delays = await monitorProjectDelays(req.params.projectKey);\n      res.json(delays);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Get Jira sync logs for business user\n  app.get(\"/api/jira/sync-logs/:businessUserId\", async (req, res) => {\n    try {\n      const { businessUserId } = req.params;\n      const limit = parseInt(req.query.limit as string) || 50;\n      \n      const logs = await storage.getJiraSyncLogs(businessUserId, limit);\n      res.json({ logs, count: logs.length });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Get failed Jira syncs (for retry UI)\n  app.get(\"/api/jira/failed-syncs/:businessUserId\", async (req, res) => {\n    try {\n      const { businessUserId } = req.params;\n      const failedLogs = await storage.getFailedJiraSyncLogs(businessUserId);\n      res.json({ logs: failedLogs, count: failedLogs.length });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // ========== MAGIC LINK AUTHENTICATION ==========\n  \n  const { generateMagicLinkToken, generateMagicLinkUrl, sendMagicLinkEmail } = await import(\"./magic-link-utils\");\n  \n  // Request a magic link\n  app.post(\"/api/auth/request-magic-link\", async (req, res) => {\n    try {\n      const { email, requestedRole } = req.body;\n      \n      if (!email || !email.includes(\"@\")) {\n        return res.status(400).json({ error: \"Valid email is required\" });\n      }\n\n      const emailLower = email.toLowerCase().trim();\n\n      // Rate limiting: Check recent requests (max 5 per hour)\n      const recentLinks = await storage.getRecentMagicLinksByEmail(emailLower, 60);\n      if (recentLinks.length >= 5) {\n        return res.status(429).json({ \n          error: \"Too many requests. Please wait before requesting another link.\" \n        });\n      }\n\n      // Invalidate all previous unused magic links for this email\n      await storage.invalidateOldMagicLinks(emailLower);\n\n      // Check if user exists and determine available roles\n      const candidate = await storage.getCandidateByEmail(emailLower);\n      const allProjects = await storage.getAllProjects();\n      const userProjects = allProjects.filter(p => p.businessUserId === emailLower);\n      \n      const hasCandidate = !!candidate;\n      const hasBusiness = userProjects.length > 0;\n      \n      console.log(`🔍 Role detection for ${emailLower}: candidate=${hasCandidate}, business=${hasBusiness}, requested=${requestedRole}`);\n      \n      // Determine final role\n      let role: \"candidate\" | \"business\" = \"candidate\";\n      let userId: string | null = null;\n      \n      if (requestedRole === \"business\" && hasBusiness) {\n        // User requested business and has business access\n        role = \"business\";\n        userId = emailLower;\n        console.log(`✅ Using requested role: business`);\n      } else if (requestedRole === \"candidate\" && hasCandidate) {\n        // User requested candidate and has candidate access\n        role = \"candidate\";\n        userId = candidate.id;\n        console.log(`✅ Using requested role: candidate`);\n      } else if (hasBusiness && !hasCandidate) {\n        // Only business access available\n        role = \"business\";\n        userId = emailLower;\n        console.log(`✅ Only business access available`);\n      } else if (hasCandidate && !hasBusiness) {\n        // Only candidate access available\n        role = \"candidate\";\n        userId = candidate.id;\n        console.log(`✅ Only candidate access available`);\n      } else if (hasBusiness && hasCandidate) {\n        // Dual-role user - default to candidate if no preference\n        role = \"candidate\";\n        userId = candidate.id;\n        console.log(`⚠️ Dual-role user, defaulting to candidate`);\n      } else {\n        // New user - use requested role\n        if (requestedRole === \"business\") {\n          role = \"business\";\n          userId = emailLower;\n          console.log(`🆕 New business user with requested role: business`);\n        } else {\n          role = \"candidate\";\n          console.log(`🆕 New candidate user (shadow account will be created)`);\n        }\n      }\n\n      // Generate cryptographically secure token\n      const token = generateMagicLinkToken();\n      const expiresAt = new Date(Date.now() + 10 * 60 * 1000); // 10 minutes\n\n      // Get client info for tracking\n      const ipAddress = req.ip || req.socket.remoteAddress || \"unknown\";\n      const userAgent = req.get(\"user-agent\") || \"unknown\";\n\n      // Save magic link to database\n      await storage.createMagicLink({\n        token,\n        email: emailLower,\n        userId,\n        role,\n        used: false,\n        ipAddress,\n        userAgent,\n        expiresAt,\n      });\n\n      // Generate magic link URL\n      // Use REPLIT_DOMAINS for production deployment URL\n      const baseUrl = process.env.REPLIT_DOMAINS \n        ? `https://${process.env.REPLIT_DOMAINS.split(',')[0]}`\n        : `http://localhost:5000`;\n      const magicLinkUrl = generateMagicLinkUrl(token, baseUrl);\n      \n      console.log(`🔗 Magic link URL created: ${magicLinkUrl}`);\n\n      // Send email (mock in development)\n      await sendMagicLinkEmail(emailLower, magicLinkUrl);\n\n      res.json({ \n        success: true, \n        message: \"Magic link sent to your email. Please check your inbox.\" \n      });\n    } catch (error: any) {\n      console.error(\"Error requesting magic link:\", error);\n      res.status(500).json({ error: \"Failed to send magic link. Please try again.\" });\n    }\n  });\n\n  // Verify magic link token\n  app.get(\"/api/auth/verify-magic-link\", async (req, res) => {\n    try {\n      const { token } = req.query;\n\n      if (!token || typeof token !== \"string\") {\n        return res.status(400).json({ error: \"Token is required\" });\n      }\n\n      // Fetch magic link from database\n      const magicLink = await storage.getMagicLinkByToken(token);\n\n      if (!magicLink) {\n        return res.status(404).json({ error: \"Invalid link. This link is not valid.\" });\n      }\n\n      // Check if already used\n      if (magicLink.used) {\n        return res.status(400).json({ error: \"This link has already been used.\" });\n      }\n\n      // Check if expired\n      const now = new Date();\n      if (now > magicLink.expiresAt) {\n        return res.status(400).json({ error: \"This link has expired. Please request a new one.\" });\n      }\n\n      // Mark as used\n      await storage.markMagicLinkAsUsed(token);\n\n      // Get or create user account with cross-portal email uniqueness check\n      let userId: string;\n      let actualRole: \"business\" | \"candidate\";\n      \n      // Check if email exists in candidate portal\n      const existingCandidate = await storage.getCandidateByEmail(magicLink.email);\n      \n      // Check magic_links history to detect previous business registrations\n      // (More reliable than checking jiraSettings which only exists after Jira config)\n      const previousMagicLinks = await storage.db\n        .select()\n        .from(schema.magicLinks)\n        .where(eq(schema.magicLinks.email, magicLink.email.toLowerCase())) // Case-insensitive\n        .orderBy(desc(schema.magicLinks.createdAt))\n        .limit(10); // Check recent history\n      \n      const hasBusinessHistory = previousMagicLinks.some(\n        (link) => link.role === \"business\" && link.used\n      );\n      const hasCandidateHistory = previousMagicLinks.some(\n        (link) => link.role === \"candidate\" && link.used\n      );\n      \n      // Enforce \"one email = one role\" architecture based on history\n      if (hasCandidateHistory && magicLink.role === \"business\") {\n        // Email already used as candidate, preserve candidate role\n        console.log(`⚠️  Email ${magicLink.email} already registered as candidate (history check). Preserving candidate role.`);\n        let user = existingCandidate;\n        if (!user) {\n          // Shouldn't happen, but handle gracefully\n          user = await storage.createCandidate({\n            email: magicLink.email,\n            name: magicLink.email.split(\"@\")[0],\n          });\n        }\n        userId = user.id;\n        actualRole = \"candidate\";\n      } else if (hasBusinessHistory && magicLink.role === \"candidate\") {\n        // Email already used as business, preserve business role\n        console.log(`⚠️  Email ${magicLink.email} already registered as business (history check). Preserving business role.`);\n        userId = magicLink.email;\n        actualRole = \"business\";\n      } else if (magicLink.role === \"candidate\") {\n        // New or existing candidate (no conflicts)\n        let user = existingCandidate;\n        if (!user) {\n          user = await storage.createCandidate({\n            email: magicLink.email,\n            name: magicLink.email.split(\"@\")[0],\n          });\n          console.log(`✨ New candidate user created: ${magicLink.email}`);\n        }\n        userId = user.id;\n        actualRole = \"candidate\";\n      } else {\n        // Business user - use email as userId\n        userId = magicLink.email;\n        actualRole = \"business\";\n        if (!hasBusinessHistory) {\n          console.log(`✨ New business user: ${magicLink.email}`);\n        }\n      }\n\n      // Create server-side session with ACTUAL role (may differ from requested)\n      req.session.userId = userId;\n      req.session.email = magicLink.email;\n      req.session.role = actualRole; // Use actualRole, not magicLink.role\n\n      console.log(`✅ Session created for ${magicLink.email} (role: ${actualRole}${actualRole !== magicLink.role ? `, requested: ${magicLink.role}` : ''})`);\n\n      res.json({\n        success: true,\n        user: {\n          id: userId,\n          email: magicLink.email,\n          role: actualRole, // Return actual role\n        },\n        redirectTo: actualRole === \"business\" ? \"/business\" : \"/candidate/dashboard\",\n      });\n    } catch (error: any) {\n      console.error(\"Error verifying magic link:\", error);\n      res.status(500).json({ error: \"Something went wrong. Please try again later.\" });\n    }\n  });\n\n  // Get current session\n  app.get(\"/api/auth/session\", async (req, res) => {\n    try {\n      if (!req.session.userId || !req.session.email || !req.session.role) {\n        return res.json({ user: null });\n      }\n\n      res.json({\n        user: {\n          id: req.session.userId,\n          email: req.session.email,\n          role: req.session.role,\n        },\n      });\n    } catch (error: any) {\n      console.error(\"Error fetching session:\", error);\n      res.status(500).json({ error: \"Failed to fetch session\" });\n    }\n  });\n\n  // Logout (destroy session)\n  app.post(\"/api/auth/logout\", async (req, res) => {\n    try {\n      const userEmail = req.session.email;\n      \n      req.session.destroy((err) => {\n        if (err) {\n          console.error(\"Error destroying session:\", err);\n          return res.status(500).json({ error: \"Failed to logout\" });\n        }\n\n        res.clearCookie(\"connect.sid\");\n        console.log(`✅ Session destroyed for ${userEmail}`);\n        res.json({ success: true, message: \"Logged out successfully\" });\n      });\n    } catch (error: any) {\n      console.error(\"Error logging out:\", error);\n      res.status(500).json({ error: \"Failed to logout\" });\n    }\n  });\n\n  // ========== BUSINESS INTERESTS (Multi-Business Competition) ==========\n  \n  // Business expresses interest in a candidate for a milestone\n  app.post(\"/api/business-interests\", async (req, res) => {\n    try {\n      const { businessUserId, candidateId, milestoneId, projectId, offerBudget, notes } = req.body;\n      \n      // Get fit score to calculate priority\n      const fitScores = await storage.getFitScoresByCandidate(candidateId);\n      const fitScore = fitScores.find(f => f.milestoneId === milestoneId);\n      \n      if (!fitScore) {\n        return res.status(404).json({ error: \"Fit score not found for this candidate\" });\n      }\n      \n      // Calculate initial priority score (no candidate preference yet)\n      const { calculatePriorityScore } = await import(\"./priority-scorer.js\");\n      const { priorityScore } = calculatePriorityScore({\n        fitScore: fitScore.score,\n        offerBudget: offerBudget || 0,\n      });\n      \n      const interest = await storage.createBusinessInterest({\n        businessUserId,\n        candidateId,\n        milestoneId,\n        projectId,\n        status: \"interested\",\n        offerBudget: offerBudget || null,\n        priorityScore,\n        notes: notes || null,\n      });\n      \n      res.json(interest);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Get competing offers for a candidate (top 3)\n  app.get(\"/api/business-interests/candidate/:candidateId/competing\", async (req, res) => {\n    try {\n      const { candidateId } = req.params;\n      const interests = await storage.getCompetingOffersForCandidate(candidateId);\n      \n      // Recalculate priority scores with normalized budgets\n      const { calculateCompetingPriorityScores, getTopCompetingOffers } = await import(\"./priority-scorer.js\");\n      \n      // Get fit scores for each interest\n      const enrichedInterests = await Promise.all(\n        interests.map(async (interest) => {\n          const fitScores = await storage.getFitScoresByCandidate(interest.candidateId);\n          const fitScore = fitScores.find(f => f.milestoneId === interest.milestoneId);\n          const milestone = await storage.getMilestone(interest.milestoneId);\n          const project = await storage.getProject(interest.projectId);\n          \n          return {\n            ...interest,\n            fitScore: fitScore?.score || 0,\n            milestone,\n            project,\n          };\n        })\n      );\n      \n      // Recalculate scores\n      const scoredInterests = calculateCompetingPriorityScores(\n        enrichedInterests.map(i => ({\n          id: i.id,\n          fitScore: i.fitScore,\n          offerBudget: i.offerBudget || 0,\n          candidatePreference: i.candidatePreference || undefined,\n        }))\n      );\n      \n      // Merge scores back into interests\n      const interestsWithScores = enrichedInterests.map(interest => {\n        const scored = scoredInterests.find(s => s.id === interest.id);\n        return {\n          ...interest,\n          priorityScore: scored?.priorityScore || interest.priorityScore || 0,\n          breakdown: scored?.breakdown,\n        };\n      });\n      \n      // Get top 3\n      const topOffers = getTopCompetingOffers(interestsWithScores, 3);\n      \n      res.json(topOffers);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Get all business interests for a milestone\n  app.get(\"/api/business-interests/milestone/:milestoneId\", async (req, res) => {\n    try {\n      const { milestoneId } = req.params;\n      const interests = await storage.getBusinessInterestsByMilestone(milestoneId);\n      res.json(interests);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Update business interest (e.g., adjust offer)\n  app.patch(\"/api/business-interests/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { offerBudget, status, notes } = req.body;\n      \n      // Get existing interest\n      const existing = await storage.getBusinessInterest(id);\n      if (!existing) {\n        return res.status(404).json({ error: \"Business interest not found\" });\n      }\n      \n      // Recalculate priority score if budget changed\n      let priorityScore = existing.priorityScore;\n      if (offerBudget !== undefined) {\n        const fitScores = await storage.getFitScoresByCandidate(existing.candidateId);\n        const fitScore = fitScores.find(f => f.milestoneId === existing.milestoneId);\n        \n        if (fitScore) {\n          const { calculatePriorityScore } = await import(\"./priority-scorer.js\");\n          const result = calculatePriorityScore({\n            fitScore: fitScore.score,\n            offerBudget,\n            candidatePreference: existing.candidatePreference || undefined,\n          });\n          priorityScore = result.priorityScore;\n        }\n      }\n      \n      const updated = await storage.updateBusinessInterest(id, {\n        offerBudget: offerBudget !== undefined ? offerBudget : existing.offerBudget,\n        status: status || existing.status,\n        notes: notes !== undefined ? notes : existing.notes,\n        priorityScore,\n      });\n      \n      res.json(updated);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Candidate rates an opportunity\n  app.post(\"/api/business-interests/:id/rate\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { rating } = req.body; // 1-5 stars\n      \n      if (!rating || rating < 1 || rating > 5) {\n        return res.status(400).json({ error: \"Rating must be between 1 and 5\" });\n      }\n      \n      const existing = await storage.getBusinessInterest(id);\n      if (!existing) {\n        return res.status(404).json({ error: \"Business interest not found\" });\n      }\n      \n      // Recalculate priority score with candidate preference\n      const fitScores = await storage.getFitScoresByCandidate(existing.candidateId);\n      const fitScore = fitScores.find(f => f.milestoneId === existing.milestoneId);\n      \n      if (!fitScore) {\n        return res.status(404).json({ error: \"Fit score not found\" });\n      }\n      \n      const { calculatePriorityScore } = await import(\"./priority-scorer.js\");\n      const { priorityScore } = calculatePriorityScore({\n        fitScore: fitScore.score,\n        offerBudget: existing.offerBudget || 0,\n        candidatePreference: rating,\n      });\n      \n      const updated = await storage.updateBusinessInterest(id, {\n        candidatePreference: rating,\n        priorityScore,\n      });\n      \n      res.json(updated);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // ========== BACKGROUND JOBS ==========\n  \n  // Get job status\n  app.get(\"/api/jobs/:jobId\", async (req, res) => {\n    try {\n      const job = await storage.getJob(req.params.jobId);\n      if (!job) {\n        return res.status(404).json({ error: \"Job not found\" });\n      }\n      res.json(job);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n  \n  // Get user's jobs\n  app.get(\"/api/jobs/user/:userId\", async (req, res) => {\n    try {\n      const jobs = await storage.getJobsByUser(req.params.userId);\n      res.json(jobs);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Start background job worker\n  console.log('[Server] Starting background job worker...');\n  startJobWorker();\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":60457},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/CandidateCard.tsx":{"content":"import { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Mail, Calendar, ExternalLink } from \"lucide-react\";\nimport { FitScoreMeter } from \"./FitScoreMeter\";\nimport type { Candidate } from \"@shared/schema\";\n\ninterface CandidateCardProps {\n  candidate: Candidate;\n  fitScore?: number;\n  onViewProfile?: (id: string) => void;\n  onContact?: (id: string) => void;\n  showFitScore?: boolean;\n}\n\nexport function CandidateCard({ candidate, fitScore, onViewProfile, onContact, showFitScore = false }: CandidateCardProps) {\n  const initials = candidate.name\n    .split(\" \")\n    .map(n => n[0])\n    .join(\"\")\n    .toUpperCase()\n    .slice(0, 2);\n\n  return (\n    <Card className=\"hover-elevate transition-all duration-150\" data-testid={`candidate-card-${candidate.id}`}>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-start gap-4\">\n          <Avatar className=\"w-12 h-12 border border-border\">\n            <AvatarFallback className=\"bg-muted text-foreground font-medium\">\n              {initials}\n            </AvatarFallback>\n          </Avatar>\n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-lg font-semibold truncate\" data-testid={`candidate-name-${candidate.id}`}>\n              {candidate.name}\n            </h3>\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground mt-1\">\n              <Mail className=\"w-3 h-3\" />\n              <span className=\"truncate\">{candidate.email}</span>\n            </div>\n          </div>\n          {showFitScore && fitScore !== undefined && (\n            <FitScoreMeter score={fitScore} size=\"sm\" showLabel={false} />\n          )}\n        </div>\n      </CardHeader>\n      <CardContent className=\"pb-3 space-y-3\">\n        {candidate.skills && candidate.skills.length > 0 && (\n          <div>\n            <div className=\"text-xs text-muted-foreground mb-2\">Skills</div>\n            <div className=\"flex flex-wrap gap-2\">\n              {candidate.skills.slice(0, 6).map((skill, idx) => (\n                <Badge key={idx} variant=\"outline\" className=\"text-xs\" data-testid={`candidate-skill-${idx}`}>\n                  {skill}\n                </Badge>\n              ))}\n              {candidate.skills.length > 6 && (\n                <Badge variant=\"outline\" className=\"text-xs\">\n                  +{candidate.skills.length - 6} more\n                </Badge>\n              )}\n            </div>\n          </div>\n        )}\n        {candidate.availableFrom && (\n          <div className=\"flex items-center gap-2 text-sm\">\n            <Calendar className=\"w-4 h-4 text-muted-foreground\" />\n            <span className=\"text-muted-foreground\">Available: </span>\n            <span className=\"font-medium\" data-testid={`candidate-availability-${candidate.id}`}>\n              {new Date(candidate.availableFrom).toLocaleDateString()}\n            </span>\n          </div>\n        )}\n      </CardContent>\n      <CardFooter className=\"pt-0 flex gap-2\">\n        {onViewProfile && (\n          <Button \n            variant=\"outline\" \n            className=\"flex-1\" \n            onClick={() => onViewProfile(candidate.id)}\n            data-testid={`button-view-candidate-${candidate.id}`}\n          >\n            <ExternalLink className=\"w-4 h-4 mr-2\" />\n            View Profile\n          </Button>\n        )}\n        {onContact && (\n          <Button \n            className=\"flex-1\" \n            onClick={() => onContact(candidate.id)}\n            data-testid={`button-contact-candidate-${candidate.id}`}\n          >\n            Contact\n          </Button>\n        )}\n      </CardFooter>\n    </Card>\n  );\n}\n","size_bytes":3790},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"server/jira-service.ts":{"content":"import { getUncachableJiraClient } from \"./jira-client\";\n\n// Jira integration service for Lean Workforce\n\nexport interface JiraIssue {\n  key: string;\n  summary: string;\n  description?: string;\n  status: string;\n  timeEstimate?: number;\n  timeSpent?: number;\n  epicKey?: string;\n  epicName?: string;\n  sprintId?: string;\n  sprintName?: string;\n}\n\nexport interface JiraSprint {\n  id: number;\n  name: string;\n  state: string;\n  startDate?: string;\n  endDate?: string;\n  goal?: string;\n}\n\nexport interface JiraProject {\n  key: string;\n  name: string;\n  description?: string;\n  projectTypeKey: string;\n  lead?: {\n    displayName: string;\n    emailAddress: string;\n  };\n}\n\n// Fetch all Jira projects\nexport async function fetchAllJiraProjects(businessUserId: string = 'demo-business-user'): Promise<JiraProject[]> {\n  try {\n    const client = await getUncachableJiraClient(businessUserId);\n    \n    const response = await client.projects.searchProjects({});\n    \n    const projects: JiraProject[] = ((response as any).values || []).map((project: any) => ({\n      key: project.key,\n      name: project.name,\n      description: project.description || \"\",\n      projectTypeKey: project.projectTypeKey || \"software\",\n      lead: project.lead ? {\n        displayName: project.lead.displayName,\n        emailAddress: project.lead.emailAddress,\n      } : undefined,\n    }));\n\n    return projects;\n  } catch (error) {\n    console.error(\"Error fetching Jira projects:\", error);\n    throw new Error(\"Failed to fetch projects from Jira. Please check your Jira credentials.\");\n  }\n}\n\n// Fetch all sprints for a project (sprint field deprecated - returns empty for now)\nexport async function fetchProjectSprints(projectKey: string, businessUserId: string = 'demo-business-user'): Promise<JiraSprint[]> {\n  // NOTE: Sprint field has been deprecated in Jira API v3\n  // For now, return empty array and let system fallback to issue-based import\n  // Future enhancement: Use Jira Agile API board endpoints for sprint detection\n  console.log(`Sprint detection skipped for ${projectKey} - using issue-based import instead`);\n  return [];\n}\n\n// Fetch issues for a specific sprint (not used since sprint detection is disabled)\nexport async function fetchSprintIssues(sprintId: number, businessUserId: string = 'demo-business-user'): Promise<JiraIssue[]> {\n  return [];\n}\n\n// Sync all issues from Jira project using NEW enhanced JQL search API\nexport async function syncJiraMilestones(projectKey: string, businessUserId: string = 'demo-business-user'): Promise<JiraIssue[]> {\n  try {\n    const client = await getUncachableJiraClient(businessUserId);\n    \n    const allIssues: JiraIssue[] = [];\n    let nextPageToken: string | undefined = undefined;\n    const maxResults = 100; // New API allows up to 100 per page\n    let pageCount = 0;\n    const maxPages = 50; // Limit to 5000 issues max (50 pages × 100)\n\n    // Use cursor-based pagination with new enhanced JQL API\n    do {\n      try {\n        // Use the NEW enhanced JQL search endpoint (POST /rest/api/3/search/jql)\n        const searchBody: any = {\n          jql: `project=${projectKey}`,\n          fields: ['*navigable'], // Explicitly request fields (new API default changed)\n          maxResults,\n        };\n        \n        if (nextPageToken) {\n          searchBody.nextPageToken = nextPageToken;\n        }\n\n        // Call the new endpoint directly using sendRequest\n        const response: any = await (client as any).sendRequest({\n          url: '/rest/api/3/search/jql',\n          method: 'POST',\n          data: searchBody,\n        });\n\n        console.log(`Fetched ${response.issues?.length || 0} issues for project ${projectKey} (page ${pageCount + 1})`);\n\n        if (response.issues && response.issues.length > 0) {\n          // Filter and map issues\n          const batchIssues = response.issues\n            .filter((issue: any) => {\n              const issueType = issue.fields?.issuetype?.name || \"\";\n              return issueType.toLowerCase() !== \"epic\";\n            })\n            .map((issue: any) => {\n              // Extract epic information\n              const epicKey = issue.fields?.parent?.key || issue.fields?.epic?.key || null;\n              const epicName = issue.fields?.parent?.fields?.summary || issue.fields?.epic?.name || null;\n              \n              // Extract sprint information (from sprint field or customfield)\n              let sprintId = null;\n              let sprintName = null;\n              \n              // Try to get sprint from various possible fields\n              const sprintField = issue.fields?.sprint || \n                                 issue.fields?.customfield_10020 || \n                                 issue.fields?.customfield_10010;\n              \n              if (sprintField) {\n                if (Array.isArray(sprintField) && sprintField.length > 0) {\n                  // Take the latest sprint\n                  const latestSprint = sprintField[sprintField.length - 1];\n                  sprintId = latestSprint.id?.toString() || null;\n                  sprintName = latestSprint.name || null;\n                } else if (typeof sprintField === 'object' && sprintField.id) {\n                  sprintId = sprintField.id.toString();\n                  sprintName = sprintField.name || null;\n                }\n              }\n              \n              return {\n                key: issue.key,\n                summary: issue.fields?.summary || \"Untitled\",\n                description: issue.fields?.description || \"\",\n                status: issue.fields?.status?.name || \"To Do\",\n                timeEstimate: issue.fields?.timeestimate,\n                timeSpent: issue.fields?.timespent,\n                epicKey,\n                epicName,\n                sprintId,\n                sprintName,\n              };\n            });\n\n          allIssues.push(...batchIssues);\n        }\n\n        // Get next page token for cursor-based pagination\n        nextPageToken = response.nextPageToken;\n        pageCount++;\n\n        // Safety check to avoid infinite loops\n        if (!nextPageToken || pageCount >= maxPages) {\n          break;\n        }\n      } catch (batchError) {\n        console.error(`Error fetching page ${pageCount + 1}:`, batchError);\n        break;\n      }\n    } while (nextPageToken);\n\n    console.log(`Total fetched: ${allIssues.length} non-Epic issues from project ${projectKey} (${pageCount} pages)`);\n    return allIssues;\n  } catch (error) {\n    console.error(\"Error syncing Jira milestones:\", error);\n    return [];\n  }\n}\n\n// Get issue status and calculate delay\nexport async function getIssueProgress(issueKey: string, businessUserId: string = 'demo-business-user'): Promise<{\n  status: string;\n  delayPercentage: number;\n  timeEstimate: number;\n  timeSpent: number;\n}> {\n  try {\n    const client = await getUncachableJiraClient(businessUserId);\n    \n    const issue = await client.issues.getIssue({\n      issueIdOrKey: issueKey,\n      fields: [\"status\", \"timeestimate\", \"timespent\"],\n    });\n\n    const timeEstimate = issue.fields.timeestimate || 0;\n    const timeSpent = issue.fields.timespent || 0;\n    \n    let delayPercentage = 0;\n    if (timeEstimate > 0 && timeSpent > timeEstimate) {\n      delayPercentage = Math.round(((timeSpent - timeEstimate) / timeEstimate) * 100);\n    }\n\n    return {\n      status: issue.fields.status?.name || \"Unknown\",\n      delayPercentage,\n      timeEstimate,\n      timeSpent,\n    };\n  } catch (error) {\n    console.error(\"Error getting issue progress:\", error);\n    return {\n      status: \"Unknown\",\n      delayPercentage: 0,\n      timeEstimate: 0,\n      timeSpent: 0,\n    };\n  }\n}\n\n// Monitor all issues in a project for delays\nexport async function monitorProjectDelays(projectKey: string, businessUserId: string = 'demo-business-user'): Promise<Array<{\n  issueKey: string;\n  delayPercentage: number;\n  riskLevel: string;\n}>> {\n  try {\n    const issues = await syncJiraMilestones(projectKey, businessUserId);\n    const delayedIssues = [];\n\n    for (const issue of issues) {\n      const progress = await getIssueProgress(issue.key, businessUserId);\n      \n      if (progress.delayPercentage > 0) {\n        let riskLevel = \"low\";\n        if (progress.delayPercentage > 20) {\n          riskLevel = \"high\";\n        } else if (progress.delayPercentage >= 10) {\n          riskLevel = \"medium\";\n        }\n\n        delayedIssues.push({\n          issueKey: issue.key,\n          delayPercentage: progress.delayPercentage,\n          riskLevel,\n        });\n      }\n    }\n\n    return delayedIssues;\n  } catch (error) {\n    console.error(\"Error monitoring project delays:\", error);\n    return [];\n  }\n}\n","size_bytes":8653},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/MilestoneTimeline.tsx":{"content":"import { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { AlertTriangle, CheckCircle2, Clock } from \"lucide-react\";\nimport type { Milestone } from \"@shared/schema\";\nimport { parseADFToText } from \"@/lib/adf-parser\";\n\ninterface MilestoneTimelineProps {\n  milestones: Milestone[];\n  onMilestoneClick?: (id: string) => void;\n}\n\nexport function MilestoneTimeline({ milestones, onMilestoneClick }: MilestoneTimelineProps) {\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"completed\": return <CheckCircle2 className=\"w-4 h-4 text-[hsl(142,76%,36%)]\" />;\n      case \"in-progress\": return <Clock className=\"w-4 h-4 text-foreground\" />;\n      case \"delayed\": return <AlertTriangle className=\"w-4 h-4 text-[hsl(0,84%,60%)]\" />;\n      default: return <div className=\"w-4 h-4 rounded-full border-2 border-border\" />;\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"completed\": return \"bg-[hsl(142,76%,36%)] text-white\";\n      case \"in-progress\": return \"bg-foreground text-background\";\n      case \"delayed\": return \"bg-[hsl(0,84%,60%)] text-white\";\n      default: return \"bg-muted text-muted-foreground\";\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {milestones.map((milestone, idx) => (\n        <Card \n          key={milestone.id} \n          className={`hover-elevate transition-all duration-150 ${onMilestoneClick ? 'cursor-pointer' : ''}`}\n          onClick={() => onMilestoneClick?.(milestone.id)}\n          data-testid={`milestone-card-${milestone.id}`}\n        >\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-start gap-3\">\n              <div className=\"mt-0.5\">\n                {getStatusIcon(milestone.status)}\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"flex items-center gap-2 flex-wrap\">\n                  <h3 className=\"text-base font-semibold\" data-testid={`milestone-name-${milestone.id}`}>\n                    {milestone.name}\n                  </h3>\n                  <Badge className={`${getStatusColor(milestone.status)} text-xs`} data-testid={`milestone-status-${milestone.id}`}>\n                    {milestone.status}\n                  </Badge>\n                  {milestone.riskLevel === \"high\" && (\n                    <Badge className=\"bg-[hsl(0,84%,60%)] text-white text-xs\" data-testid={`milestone-risk-${milestone.id}`}>\n                      High Risk\n                    </Badge>\n                  )}\n                </div>\n                <p className=\"text-sm text-muted-foreground mt-1 line-clamp-2\">\n                  {parseADFToText(milestone.description)}\n                </p>\n              </div>\n            </div>\n          </CardHeader>\n          {milestone.estimatedHours && (\n            <CardContent className=\"pt-0 pb-3\">\n              <div className=\"flex items-center gap-4 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground\">Original Estimate: </span>\n                  <span className=\"font-medium\">{milestone.estimatedHours}h</span>\n                </div>\n                {milestone.delayPercentage !== null && milestone.delayPercentage > 0 && (\n                  <div className=\"text-[hsl(0,84%,60%)]\">\n                    <span className=\"font-medium\">+{milestone.delayPercentage}% delayed</span>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          )}\n        </Card>\n      ))}\n    </div>\n  );\n}\n","size_bytes":3569},"client/src/components/SkillMapDisplay.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport type { SkillMap } from \"@shared/schema\";\n\ninterface SkillMapDisplayProps {\n  skillMap: SkillMap;\n}\n\nexport function SkillMapDisplay({ skillMap }: SkillMapDisplayProps) {\n  return (\n    <Card data-testid=\"skill-map-display\">\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-lg\">{skillMap.milestone}</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div>\n          <div className=\"text-sm font-medium mb-2\">Required Skills</div>\n          <div className=\"flex flex-wrap gap-2\">\n            {skillMap.required_skills.map((skill, idx) => (\n              <Badge \n                key={idx} \n                className=\"bg-black text-white\" \n                data-testid={`skill-${idx}`}\n              >\n                {skill}\n              </Badge>\n            ))}\n          </div>\n        </div>\n        \n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <div className=\"text-sm font-medium mb-2\">Experience Level</div>\n            <Badge variant=\"outline\" data-testid=\"experience-level\">\n              {skillMap.experience_level}\n            </Badge>\n          </div>\n          \n          {skillMap.soft_skills && skillMap.soft_skills.length > 0 && (\n            <div>\n              <div className=\"text-sm font-medium mb-2\">Soft Skills</div>\n              <div className=\"flex flex-wrap gap-2\">\n                {skillMap.soft_skills.map((skill, idx) => (\n                  <Badge \n                    key={idx} \n                    variant=\"outline\" \n                    className=\"text-xs\"\n                    data-testid={`soft-skill-${idx}`}\n                  >\n                    {skill}\n                  </Badge>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":1961},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"replit.md":{"content":"# Lean Workforce\n\n## Overview\n\nLean Workforce is an intelligent talent matching and project continuity platform that automates workforce allocation. It connects businesses with projects to candidates, using AI for skill extraction, candidate-project matching, and real-time risk prediction via Jira integration. The platform features dual Business and Candidate portals, automated skill mapping, fit score calculation, and proactive project risk management.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend\n\n**Technology Stack**: React with TypeScript, Vite, shadcn/ui (Radix UI + Tailwind CSS).\n\n**Design Philosophy**: Workflow-first, minimalist monochrome design with functional color accents. Inter font family with clear typographic hierarchy.\n\n**State Management**: TanStack Query for server state and data fetching.\n\n**Routing**: Wouter for client-side routing, distinguishing `/business/*` and `/candidate/*` paths.\n\n**Key Features**:\n- **CV Upload**: Multi-stage visual feedback and progress tracking.\n- **Job Recommendations**: AI-powered matches (>70% fit score) with explainability (skill, experience, soft skill breakdown).\n- **Project Detail View**: Grouped task view (defaulting to sprint), milestone list timeline, Jira description parsing (ADF).\n- **Profile Management**: AI-extracted skills and experience displayed post-CV upload.\n\n### Backend\n\n**Runtime**: Node.js with Express.js, TypeScript, ES modules.\n\n**API Design**: RESTful API with endpoints for projects, milestones, candidates, fit scores, and Jira integration.\n\n**File Upload**: Multer middleware for PDF, DOC, DOCX, TXT with validation and 10MB limit.\n\n**Document Processing**: Multi-format CV parser with retry logic and error recovery.\n\n**Background Job Queue**: Async processing for CV analysis, fit score calculation, and skill map generation, with progress tracking and email notifications (SendGrid).\n\n**AI Integration**: Google Gemini for skill mapping, CV analysis, fit score calculation, and risk prediction.\n\n**Storage Layer**: Abstracted interface using Drizzle ORM with PostgreSQL.\n\n### Data Storage\n\n**Database**: PostgreSQL via Neon serverless driver.\n\n**ORM**: Drizzle ORM for type-safe operations.\n\n**Schema Design**: Tables for `projects`, `milestones`, `candidates`, `fitScores`, `riskAlerts`, `savedJobs`, `applications`, and `candidateActions`.\n\n**Relationships**: One-to-many between projects and milestones; implicit many-to-many between candidates and milestones.\n\n**Migrations**: Drizzle Kit for schema management.\n\n### Authentication and Authorization\n\n**Authentication**: Magic Link passwordless system with 10-minute TTL, single-use tokens, and rate limiting.\n\n**Separate Login Portals** (October 2025):\n- `/business-login` - Business user login with `requestedRole='business'`\n- `/candidate-login` - Candidate user login with `requestedRole='candidate'`\n- Architecture: One account = One role (no dual-role users)\n- New users are assigned role based on which login portal they use\n- Backend respects `requestedRole` parameter for new user creation\n- Auto-redirect: Logged-in users cannot access login pages (auto-redirected to dashboard)\n\n**Session Management** (October 2025):\n- Server-side sessions stored in PostgreSQL via `express-session` + `connect-pg-simple`\n- HttpOnly cookies with 7-day expiration for security\n- Session data: `userId`, `email`, `role`\n- Middleware protection: `requireAuth`, `requireBusiness`, `requireCandidate`\n- API endpoints: `GET /api/auth/session`, `POST /api/auth/logout`\n- Frontend: `useAuth()` hook with TanStack Query for session state\n\n**Authentication Guards**: Role-based access control for business and candidate routes; public access for guest CV upload.\n\n## External Dependencies\n\n**Google Gemini AI**: Primary AI service for NLP tasks (skill extraction, matching, risk analysis). Rate-limited with retries.\n\n**Jira Cloud API**: Integration via `jira.js` with dual authentication (Replit OAuth Connector or manual credentials).\n\n**Jira Integration Features**:\n- Project import and issue synchronization (non-Epic issues as milestones).\n- Epic & Sprint tracking for task organization.\n- Progress monitoring and risk management.\n- Uses enhanced JQL search API for issue fetching.\n\n**Database**: Neon PostgreSQL serverless database.\n\n**Third-party UI Libraries**: Radix UI primitives, react-hook-form (Zod validation), date-fns.\n\n## Recent Production Enhancements (P0/P1 Features)\n\n### P0: Critical Production Features\n\n**Jira Sync Error Handling** (October 2025):\n- Added `jiraSyncLogs` table to track all Jira synchronization attempts with full error details and retry capability.\n- Added sync status tracking fields to projects: `lastJiraSyncAt`, `lastJiraSyncStatus`, `lastJiraSyncError`.\n- Created `jira-error-handler.ts` utility for error categorization (auth, network, rate-limit, validation).\n- Added API endpoints: `/api/jira/sync-logs` (all logs) and `/api/jira/failed-syncs` (failed only).\n- Storage methods: `createJiraSyncLog`, `getJiraSyncLogsByProject`, `getAllJiraSyncLogs`.\n\n**Encryption Key Production Requirement** (October 2025):\n- `ENCRYPTION_KEY` now mandatory in production environments (fails hard on startup if missing).\n- Development mode allows temporary key with console warning for developer convenience.\n- Prevents production deployments without proper encryption security.\n\n**Candidate Double-Booking Prevention** (October 2025):\n- Added assignment lifecycle fields to milestones: `assignmentStatus`, `assignmentConfirmedAt`, `backupAssignmentStatus`.\n- Created `assignment-validator.ts` utility with validation functions:\n  - `validateCandidateAssignment`: Prevents assigning candidates to overlapping projects.\n  - `validateBackupAssignment`: Ensures backups don't conflict with primary assignments.\n  - `confirmCandidateAssignment`: Marks assignment as confirmed (locks it in).\n  - `rejectCandidateAssignment`: Frees up candidate for other opportunities.\n- **Integration pending**: Validator functions created but not yet wired into assignment API endpoints.\n\n### P1: High Priority Features\n\n**Application Status Workflow** (October 2025):\n- Leverages existing `applications` table with comprehensive status tracking.\n- Status values: pending, under_review, interview_scheduled, accepted, rejected, withdrawn.\n- Business can track candidate application lifecycle through existing infrastructure.\n\n**4-Tier Risk Escalation System** (October 2025):\n- Updated AI risk analysis from 3-tier to 4-tier escalation:\n  - **Low** (10-20% delay): Monitor only, notify business.\n  - **Medium** (20-30% delay): Notify + prepare backup candidate list.\n  - **High** (30-40% delay): Notify + backup ready, require business decision within 24h.\n  - **Critical** (>40% delay): Auto-activate backup + escalate to management.\n- Updated `RiskAnalysis` type and Gemini AI prompt to support all four tiers.\n- **Integration pending**: Downstream logic in `monitorProjectDelays` needs updates to implement tier-specific escalation behaviors.\n\n**Multi-Business Competition** (October 2025):\n- Added `businessInterests` table to track multiple businesses competing for same candidate.\n- Priority scoring algorithm: 40% fit score + 30% budget + 30% candidate preference.\n- Normalizes budgets across competing offers for fair comparison.\n- API endpoints for creating interests, adjusting offers, rating opportunities, viewing top 3.\n- **UI pending**: Candidate dashboard integration to display competing offers.\n\n**Business Review Workflow** (October 2025):\n- Added human-in-the-loop validation to prevent spam notifications.\n- Schema: `skillMapApproved` and `candidatesNotified` flags on milestones.\n- Workflow enforces:\n  1. Business reviews/edits AI-generated skill map → Approve\n  2. System recalculates fit scores with approved skill map\n  3. Business reviews top candidates → Selects who to notify\n  4. Notification requires both skill map approval and candidate selection\n- API endpoints: PATCH `/api/milestones/:id/approve-skillmap`, POST `/api/milestones/:id/notify-candidates`.\n- **UI pending**: Business dashboard integration for skill map review and candidate selection.","size_bytes":8209},"client/src/components/GroupedTasksView.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ChevronDown, ChevronRight } from \"lucide-react\";\nimport { useState } from \"react\";\nimport type { Milestone } from \"@shared/schema\";\nimport { parseADFToText } from \"@/lib/adf-parser\";\n\ninterface GroupedTasksViewProps {\n  milestones: Milestone[];\n  groupBy: \"epic\" | \"sprint\" | \"none\";\n}\n\ninterface TaskGroup {\n  key: string;\n  name: string;\n  tasks: Milestone[];\n}\n\nexport function GroupedTasksView({ milestones, groupBy }: GroupedTasksViewProps) {\n  const [expandedGroups, setExpandedGroups] = useState<Set<string>>(new Set());\n\n  const toggleGroup = (groupKey: string) => {\n    const newExpanded = new Set(expandedGroups);\n    if (newExpanded.has(groupKey)) {\n      newExpanded.delete(groupKey);\n    } else {\n      newExpanded.add(groupKey);\n    }\n    setExpandedGroups(newExpanded);\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"completed\": return \"bg-[hsl(142,76%,36%)] text-white\";\n      case \"in-progress\": return \"bg-foreground text-background\";\n      case \"delayed\": return \"bg-[hsl(0,84%,60%)] text-white\";\n      default: return \"bg-muted text-muted-foreground\";\n    }\n  };\n\n  const groupTasks = (): TaskGroup[] => {\n    if (groupBy === \"none\") {\n      return [{\n        key: \"all\",\n        name: \"All Tasks\",\n        tasks: milestones,\n      }];\n    }\n\n    const groups: { [key: string]: TaskGroup } = {};\n\n    milestones.forEach((milestone) => {\n      let groupKey: string;\n      let groupName: string;\n\n      if (groupBy === \"epic\") {\n        groupKey = milestone.jiraEpicKey || \"no-epic\";\n        groupName = milestone.jiraEpicKey || \"No Epic\";\n      } else {\n        groupKey = milestone.jiraSprintId || \"no-sprint\";\n        groupName = milestone.jiraSprintName || \"No Sprint\";\n      }\n\n      if (!groups[groupKey]) {\n        groups[groupKey] = {\n          key: groupKey,\n          name: groupName,\n          tasks: [],\n        };\n      }\n\n      groups[groupKey].tasks.push(milestone);\n    });\n\n    return Object.values(groups).sort((a, b) => {\n      // Put \"No Epic/Sprint\" group at the end\n      if (a.key.startsWith(\"no-\")) return 1;\n      if (b.key.startsWith(\"no-\")) return -1;\n      return a.name.localeCompare(b.name);\n    });\n  };\n\n  const groups = groupTasks();\n\n  if (groupBy === \"none\") {\n    return (\n      <div className=\"space-y-3\">\n        {milestones.map((task) => (\n          <Card key={task.id} className=\"hover-elevate\" data-testid={`task-card-${task.id}`}>\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-start justify-between gap-2\">\n                <div className=\"flex-1\">\n                  <CardTitle className=\"text-base font-medium\">{task.name}</CardTitle>\n                  {task.description && (\n                    <p className=\"text-sm text-muted-foreground mt-1 line-clamp-2\">\n                      {parseADFToText(task.description)}\n                    </p>\n                  )}\n                </div>\n                <Badge className={getStatusColor(task.status)} data-testid={`task-status-${task.id}`}>\n                  {task.status}\n                </Badge>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                {task.estimatedHours && (\n                  <span data-testid={`task-hours-${task.id}`}>\n                    {task.estimatedHours}h estimated\n                  </span>\n                )}\n                {task.jiraIssueKey && (\n                  <span className=\"font-mono text-xs\" data-testid={`task-jira-key-${task.id}`}>\n                    {task.jiraIssueKey}\n                  </span>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {groups.map((group) => {\n        const isExpanded = expandedGroups.has(group.key);\n        const totalHours = group.tasks.reduce((sum, task) => sum + (task.estimatedHours || 0), 0);\n        \n        return (\n          <Card key={group.key} data-testid={`group-${group.key}`}>\n            <CardHeader\n              className=\"cursor-pointer hover-elevate pb-3\"\n              onClick={() => toggleGroup(group.key)}\n              data-testid={`group-header-${group.key}`}\n            >\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  {isExpanded ? (\n                    <ChevronDown className=\"w-5 h-5 text-muted-foreground\" />\n                  ) : (\n                    <ChevronRight className=\"w-5 h-5 text-muted-foreground\" />\n                  )}\n                  <CardTitle className=\"text-lg\">{group.name}</CardTitle>\n                  <Badge variant=\"outline\" data-testid={`group-count-${group.key}`}>\n                    {group.tasks.length} {group.tasks.length === 1 ? \"task\" : \"tasks\"}\n                  </Badge>\n                </div>\n                {totalHours > 0 && (\n                  <span className=\"text-sm text-muted-foreground\" data-testid={`group-hours-${group.key}`}>\n                    {totalHours}h total\n                  </span>\n                )}\n              </div>\n            </CardHeader>\n            \n            {isExpanded && (\n              <CardContent className=\"space-y-2\">\n                {group.tasks.map((task) => (\n                  <div\n                    key={task.id}\n                    className=\"p-3 border border-border rounded-md hover-elevate\"\n                    data-testid={`task-${task.id}`}\n                  >\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex-1\">\n                        <div className=\"font-medium text-sm\">{task.name}</div>\n                        {task.description && (\n                          <p className=\"text-xs text-muted-foreground mt-1 line-clamp-2\">\n                            {parseADFToText(task.description)}\n                          </p>\n                        )}\n                        <div className=\"flex items-center gap-3 mt-2 text-xs text-muted-foreground\">\n                          {task.estimatedHours && (\n                            <span data-testid={`task-hours-${task.id}`}>\n                              <strong>Original Estimate:</strong> {task.estimatedHours}h\n                            </span>\n                          )}\n                          {task.jiraIssueKey && (\n                            <span className=\"font-mono\">{task.jiraIssueKey}</span>\n                          )}\n                        </div>\n                      </div>\n                      <Badge className={getStatusColor(task.status)} data-testid={`status-${task.id}`}>\n                        {task.status}\n                      </Badge>\n                    </div>\n                  </div>\n                ))}\n              </CardContent>\n            )}\n          </Card>\n        );\n      })}\n    </div>\n  );\n}\n","size_bytes":7128},"server/rate-limiter.ts":{"content":"// Simple rate limiter for Gemini API to respect free tier quota\n// Free tier: 2 requests per minute for gemini-2.5-pro/flash\n\nclass RateLimiter {\n  private queue: Array<() => Promise<any>> = [];\n  private processing = false;\n  private lastRequestTime = 0;\n  private minDelay = 30000; // 30 seconds between requests (2 per minute = 1 every 30s)\n\n  async execute<T>(fn: () => Promise<T>): Promise<T> {\n    return new Promise((resolve, reject) => {\n      this.queue.push(async () => {\n        try {\n          const result = await fn();\n          resolve(result);\n        } catch (error) {\n          reject(error);\n        }\n      });\n\n      if (!this.processing) {\n        this.processQueue();\n      }\n    });\n  }\n\n  private async processQueue() {\n    if (this.processing || this.queue.length === 0) {\n      return;\n    }\n\n    this.processing = true;\n\n    while (this.queue.length > 0) {\n      const now = Date.now();\n      const timeSinceLastRequest = now - this.lastRequestTime;\n      \n      // Wait if we need to respect the rate limit\n      if (this.lastRequestTime > 0 && timeSinceLastRequest < this.minDelay) {\n        const waitTime = this.minDelay - timeSinceLastRequest;\n        console.log(`Rate limiting: waiting ${Math.round(waitTime / 1000)}s before next Gemini API call`);\n        await new Promise(resolve => setTimeout(resolve, waitTime));\n      }\n\n      const task = this.queue.shift();\n      if (task) {\n        this.lastRequestTime = Date.now();\n        await task();\n      }\n    }\n\n    this.processing = false;\n  }\n\n  // Retry with exponential backoff\n  async executeWithRetry<T>(\n    fn: () => Promise<T>,\n    maxRetries = 3,\n    baseDelay = 1000\n  ): Promise<T> {\n    let lastError: any;\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        return await this.execute(fn);\n      } catch (error: any) {\n        lastError = error;\n\n        // Check if it's a rate limit error (429)\n        if (error.status === 429) {\n          if (attempt < maxRetries) {\n            const delay = baseDelay * Math.pow(2, attempt);\n            console.log(`Rate limit hit (429), retrying in ${delay / 1000}s (attempt ${attempt + 1}/${maxRetries})`);\n            await new Promise(resolve => setTimeout(resolve, delay));\n          }\n        } else {\n          // Non-rate-limit error, don't retry\n          throw error;\n        }\n      }\n    }\n\n    throw lastError;\n  }\n}\n\nexport const geminiRateLimiter = new RateLimiter();\n","size_bytes":2455},"client/src/lib/adf-parser.ts":{"content":"/**\n * Atlassian Document Format (ADF) to plain text converter\n * Jira stores descriptions as structured JSON (ADF), this converts it to readable text\n */\n\ninterface ADFNode {\n  type: string;\n  content?: ADFNode[];\n  text?: string;\n  attrs?: any;\n}\n\n/**\n * Converts ADF JSON to plain text\n * @param adfString - ADF JSON string or plain text\n * @returns Plain text representation\n */\nexport function parseADFToText(adfString: string | null | undefined): string {\n  if (!adfString) return \"\";\n  \n  // If it's already plain text (not JSON), return as-is\n  if (!adfString.trim().startsWith(\"{\")) {\n    return adfString;\n  }\n  \n  try {\n    const adf: ADFNode = JSON.parse(adfString);\n    return extractTextFromNode(adf);\n  } catch (e) {\n    // If parsing fails, return the original string\n    return adfString;\n  }\n}\n\nfunction extractTextFromNode(node: ADFNode): string {\n  if (!node) return \"\";\n  \n  // If node has text directly, return it\n  if (node.text) {\n    return node.text;\n  }\n  \n  // If node has content, recursively extract text\n  if (node.content && Array.isArray(node.content)) {\n    const texts = node.content.map(child => extractTextFromNode(child));\n    \n    // Add spacing based on node type\n    switch (node.type) {\n      case \"paragraph\":\n        return texts.join(\"\") + \"\\n\";\n      case \"heading\":\n        return texts.join(\"\") + \"\\n\\n\";\n      case \"bulletList\":\n      case \"orderedList\":\n        return texts.join(\"\");\n      case \"listItem\":\n        return \"• \" + texts.join(\"\").trim() + \"\\n\";\n      case \"codeBlock\":\n        return texts.join(\"\") + \"\\n\";\n      case \"blockquote\":\n        return \"> \" + texts.join(\"\") + \"\\n\";\n      case \"hardBreak\":\n        return \"\\n\";\n      default:\n        return texts.join(\"\");\n    }\n  }\n  \n  return \"\";\n}\n","size_bytes":1763},"client/src/components/JobMatchExplainer.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { CheckCircle2, TrendingUp, Users, Lightbulb } from \"lucide-react\";\n\ninterface JobMatchExplainerProps {\n  fitScore: {\n    score: number;\n    skillOverlap: number;\n    experienceMatch: number;\n    softSkillRelevance: number;\n    reasoning?: string;\n  };\n  className?: string;\n}\n\nexport function JobMatchExplainer({ fitScore, className }: JobMatchExplainerProps) {\n  const getScoreColor = (score: number) => {\n    if (score >= 80) return \"text-[hsl(142,76%,36%)]\";\n    if (score >= 60) return \"text-foreground\";\n    return \"text-muted-foreground\";\n  };\n\n  const getScoreBgColor = (score: number) => {\n    if (score >= 80) return \"bg-[hsl(142,76%,36%)]/10\";\n    if (score >= 60) return \"bg-muted/50\";\n    return \"bg-muted/30\";\n  };\n\n  return (\n    <Card className={className} data-testid=\"job-match-explainer\">\n      <CardContent className=\"p-4 space-y-3\">\n        <div className=\"flex items-center gap-2 mb-2\">\n          <Lightbulb className=\"w-4 h-4 text-primary\" />\n          <h4 className=\"font-semibold text-sm\">Why this job?</h4>\n        </div>\n\n        <div className=\"space-y-2\">\n          {/* Skill Overlap */}\n          <div className=\"flex items-start gap-3\">\n            <CheckCircle2 className={`w-4 h-4 mt-0.5 shrink-0 ${getScoreColor(fitScore.skillOverlap)}`} />\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center justify-between gap-2\">\n                <span className=\"text-sm font-medium\">Skills Match</span>\n                <Badge variant=\"outline\" className={`${getScoreBgColor(fitScore.skillOverlap)} border-0`}>\n                  {fitScore.skillOverlap}%\n                </Badge>\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-0.5\">\n                Your technical skills align with project requirements\n              </p>\n            </div>\n          </div>\n\n          {/* Experience Match */}\n          <div className=\"flex items-start gap-3\">\n            <TrendingUp className={`w-4 h-4 mt-0.5 shrink-0 ${getScoreColor(fitScore.experienceMatch)}`} />\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center justify-between gap-2\">\n                <span className=\"text-sm font-medium\">Experience Level</span>\n                <Badge variant=\"outline\" className={`${getScoreBgColor(fitScore.experienceMatch)} border-0`}>\n                  {fitScore.experienceMatch}%\n                </Badge>\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-0.5\">\n                Your background matches the complexity needed\n              </p>\n            </div>\n          </div>\n\n          {/* Soft Skills */}\n          <div className=\"flex items-start gap-3\">\n            <Users className={`w-4 h-4 mt-0.5 shrink-0 ${getScoreColor(fitScore.softSkillRelevance)}`} />\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center justify-between gap-2\">\n                <span className=\"text-sm font-medium\">Soft Skills</span>\n                <Badge variant=\"outline\" className={`${getScoreBgColor(fitScore.softSkillRelevance)} border-0`}>\n                  {fitScore.softSkillRelevance}%\n                </Badge>\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-0.5\">\n                Communication and teamwork alignment\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {fitScore.reasoning && (\n          <div className=\"pt-2 border-t border-border\">\n            <p className=\"text-xs text-muted-foreground italic\">\n              {fitScore.reasoning}\n            </p>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":3793},"client/src/pages/VerifyMagicLink.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, CheckCircle2, XCircle, AlertCircle } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/useAuth\";\n\nexport default function VerifyMagicLink() {\n  const [, setLocation] = useLocation();\n  const { refetch } = useAuth();\n  const [status, setStatus] = useState<\"loading\" | \"success\" | \"error\">(\"loading\");\n  const [error, setError] = useState(\"\");\n  const [redirectPath, setRedirectPath] = useState(\"\");\n\n  useEffect(() => {\n    const verifyToken = async () => {\n      // Get token from URL query params\n      const params = new URLSearchParams(window.location.search);\n      const token = params.get(\"token\");\n\n      if (!token) {\n        setStatus(\"error\");\n        setError(\"No token provided in the link.\");\n        return;\n      }\n\n      try {\n        const response = await fetch(`/api/auth/verify-magic-link?token=${token}`, {\n          credentials: \"include\",\n        });\n        const data = await response.json();\n\n        if (!response.ok) {\n          throw new Error(data.error || \"Verification failed\");\n        }\n\n        // Success! Session created on server, refetch to update client\n        await refetch();\n        \n        setStatus(\"success\");\n        setRedirectPath(data.redirectTo);\n\n        // Auto-redirect after 2 seconds\n        setTimeout(() => {\n          setLocation(data.redirectTo);\n        }, 2000);\n      } catch (err: any) {\n        setStatus(\"error\");\n        setError(err.message || \"Something went wrong. Please try again.\");\n      }\n    };\n\n    verifyToken();\n  }, [setLocation, refetch]);\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Lean Workforce</h1>\n          <p className=\"text-muted-foreground\">Verifying your login link...</p>\n        </div>\n\n        <Card>\n          <CardHeader className=\"text-center\">\n            {status === \"loading\" && (\n              <div className=\"mx-auto w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-4\">\n                <Loader2 className=\"w-8 h-8 text-primary animate-spin\" />\n              </div>\n            )}\n            {status === \"success\" && (\n              <div className=\"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n                <CheckCircle2 className=\"w-8 h-8 text-green-600\" />\n              </div>\n            )}\n            {status === \"error\" && (\n              <div className=\"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4\">\n                <XCircle className=\"w-8 h-8 text-red-600\" />\n              </div>\n            )}\n            <CardTitle data-testid=\"status-title\">\n              {status === \"loading\" && \"Verifying Link...\"}\n              {status === \"success\" && \"Login Successful!\"}\n              {status === \"error\" && \"Verification Failed\"}\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"text-center space-y-4\">\n            {status === \"loading\" && (\n              <p className=\"text-muted-foreground\">\n                Please wait while we verify your login link...\n              </p>\n            )}\n\n            {status === \"success\" && (\n              <>\n                <p className=\"text-muted-foreground\" data-testid=\"success-message\">\n                  You're being redirected to your dashboard...\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Redirecting to {redirectPath}\n                </p>\n              </>\n            )}\n\n            {status === \"error\" && (\n              <>\n                <div className=\"bg-destructive/10 border border-destructive/20 rounded-md p-4\">\n                  <div className=\"flex items-start gap-2\">\n                    <AlertCircle className=\"w-5 h-5 text-destructive shrink-0 mt-0.5\" />\n                    <div className=\"text-left\">\n                      <p className=\"font-medium text-destructive mb-1\">Error</p>\n                      <p className=\"text-sm text-destructive/90\" data-testid=\"error-message\">{error}</p>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Button\n                    className=\"w-full\"\n                    onClick={() => setLocation(\"/login\")}\n                    data-testid=\"button-request-new-link\"\n                  >\n                    Request a New Link\n                  </Button>\n                  \n                  <p className=\"text-xs text-muted-foreground\">\n                    {error.includes(\"expired\") && \"The link may have expired (10 minute limit)\"}\n                    {error.includes(\"used\") && \"Each link can only be used once\"}\n                    {error.includes(\"Invalid\") && \"The link may be incorrect or tampered with\"}\n                  </p>\n                </div>\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5279},"server/magic-link-utils.ts":{"content":"import { randomBytes } from \"crypto\";\nimport { sendMagicLinkEmail as sendEmailViaSendGrid } from \"./sendgrid.js\";\n\n/**\n * Generate a cryptographically secure token for magic links\n * Returns a 32-character URL-safe token\n */\nexport function generateMagicLinkToken(): string {\n  return randomBytes(32).toString('base64url');\n}\n\n/**\n * Generate the magic link URL for email\n */\nexport function generateMagicLinkUrl(token: string, baseUrl: string): string {\n  return `${baseUrl}/auth/verify?token=${token}`;\n}\n\n/**\n * Send magic link email via SendGrid\n * Falls back to console.log if SendGrid is not configured\n */\nexport async function sendMagicLinkEmail(email: string, magicLinkUrl: string): Promise<void> {\n  try {\n    await sendEmailViaSendGrid(email, magicLinkUrl);\n  } catch (error) {\n    console.error('❌ SendGrid email failed, falling back to console log:', error);\n    console.log(`\n=================================================================\n🔐 MAGIC LINK EMAIL (Fallback Mode - SendGrid Failed)\n=================================================================\nTo: ${email}\nSubject: Your Login Link for Lean Workforce\n\nClick the link below to log in to your account:\n\n${magicLinkUrl}\n\nThis link will expire in 10 minutes and can only be used once.\n\nIf you didn't request this link, you can safely ignore this email.\n=================================================================\n    `);\n  }\n}\n","size_bytes":1415},"client/src/lib/auth.ts":{"content":"import { apiRequest } from \"./queryClient\";\n\ninterface User {\n  id: string;\n  email: string;\n  role: 'candidate' | 'business';\n}\n\nlet cachedUser: User | null | undefined = undefined;\n\nexport async function fetchSession(): Promise<User | null> {\n  try {\n    const response = await fetch(\"/api/auth/session\", {\n      credentials: \"include\",\n    });\n    \n    if (!response.ok) {\n      return null;\n    }\n    \n    const data = await response.json();\n    cachedUser = data.user || null;\n    return cachedUser ?? null;\n  } catch (error) {\n    console.error(\"Failed to fetch session:\", error);\n    return null;\n  }\n}\n\nexport function getCachedUser(): User | null | undefined {\n  return cachedUser;\n}\n\nexport async function logout(): Promise<void> {\n  try {\n    await apiRequest(\"POST\", \"/api/auth/logout\");\n    cachedUser = null;\n  } catch (error) {\n    console.error(\"Logout failed:\", error);\n    throw error;\n  }\n}\n\nexport async function isAuthenticated(): Promise<boolean> {\n  const user = await fetchSession();\n  return user !== null;\n}\n\nexport async function isBusinessUser(): Promise<boolean> {\n  const user = await fetchSession();\n  return user?.role === 'business';\n}\n\nexport async function isCandidateUser(): Promise<boolean> {\n  const user = await fetchSession();\n  return user?.role === 'candidate';\n}\n","size_bytes":1306},"client/src/pages/CandidateLanding.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { \n  Upload, \n  CheckCircle2, \n  AlertCircle, \n  Loader2, \n  ArrowRight,\n  Briefcase,\n  Target,\n  Zap,\n  TrendingUp,\n  FileText,\n  Brain\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isAuthenticated } from \"@/lib/auth\";\n\ntype UploadState = 'idle' | 'uploading' | 'parsing' | 'analyzing' | 'complete' | 'error';\n\nexport default function CandidateLanding() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [uploadState, setUploadState] = useState<UploadState>('idle');\n  const [progress, setProgress] = useState(0);\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const [showUploadSection, setShowUploadSection] = useState(false);\n  const isLoggedIn = isAuthenticated();\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    if (!file.name.endsWith('.pdf')) {\n      toast({\n        title: \"Invalid File\",\n        description: \"Please upload a PDF file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('cv', file);\n\n    try {\n      setUploadState('uploading');\n      setProgress(25);\n\n      setTimeout(() => {\n        setUploadState('parsing');\n        setProgress(50);\n      }, 500);\n\n      setTimeout(() => {\n        setUploadState('analyzing');\n        setProgress(75);\n      }, 1000);\n\n      const res = await fetch('/api/candidate/upload-cv', {\n        method: 'POST',\n        body: formData,\n        credentials: 'include',\n      });\n\n      if (!res.ok) {\n        const text = await res.text();\n        throw new Error(text || 'Upload failed');\n      }\n\n      setProgress(100);\n      setUploadState('complete');\n\n      toast({\n        title: \"CV Uploaded Successfully\",\n        description: \"Your profile has been created with AI-extracted skills\",\n      });\n\n      if (isLoggedIn) {\n        setTimeout(() => setLocation('/candidate/dashboard'), 1500);\n      } else {\n        setTimeout(() => setLocation('/login'), 2000);\n      }\n    } catch (error: any) {\n      setUploadState('error');\n      setErrorMessage(error.message || 'Upload failed');\n      toast({\n        title: \"Upload Failed\",\n        description: error.message || \"Failed to upload CV\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (isLoggedIn) {\n    setLocation('/candidate/dashboard');\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <header className=\"border-b\">\n        <div className=\"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-14 sm:h-16\">\n            <div className=\"flex items-center gap-1.5 sm:gap-2\">\n              <Briefcase className=\"w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0\" />\n              <span className=\"text-base sm:text-xl font-bold\">Lean Workforce</span>\n            </div>\n            <div className=\"flex gap-2 sm:gap-3\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setLocation('/login')}\n                data-testid=\"button-login\"\n                className=\"text-xs sm:text-sm px-2 sm:px-4\"\n              >\n                Sign In\n              </Button>\n              <Button\n                size=\"sm\"\n                onClick={() => {\n                  setShowUploadSection(true);\n                  setTimeout(() => {\n                    document.getElementById('upload-section')?.scrollIntoView({ \n                      behavior: 'smooth' \n                    });\n                  }, 100);\n                }}\n                data-testid=\"button-get-started\"\n                className=\"text-xs sm:text-sm px-2.5 sm:px-4\"\n              >\n                <span className=\"hidden sm:inline\">Get Started</span>\n                <span className=\"sm:hidden\">Start</span>\n                <ArrowRight className=\"w-3 h-3 sm:w-4 sm:h-4 ml-1 sm:ml-2\" />\n              </Button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Hero Section */}\n      <section className=\"py-12 sm:py-16 md:py-24\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center max-w-3xl mx-auto\">\n            <h1 className=\"text-3xl sm:text-4xl md:text-5xl font-bold mb-4 sm:mb-6\" data-testid=\"hero-title\">\n              Find Projects That Match Your Skills\n            </h1>\n            <p className=\"text-lg sm:text-xl text-muted-foreground mb-6 sm:mb-8 px-4 sm:px-0\">\n              AI-powered talent matching connects you with opportunities that fit your expertise. \n              Upload your CV and get matched with projects in seconds.\n            </p>\n            <div className=\"flex gap-3 sm:gap-4 justify-center flex-wrap px-4 sm:px-0\">\n              <Button \n                size=\"lg\"\n                onClick={() => {\n                  setShowUploadSection(true);\n                  setTimeout(() => {\n                    document.getElementById('upload-section')?.scrollIntoView({ \n                      behavior: 'smooth' \n                    });\n                  }, 100);\n                }}\n                data-testid=\"button-hero-cta\"\n              >\n                <Upload className=\"w-5 h-5 mr-2\" />\n                Upload Your CV\n              </Button>\n              <Button \n                size=\"lg\"\n                variant=\"outline\"\n                onClick={() => setLocation('/login')}\n                data-testid=\"button-hero-login\"\n              >\n                I Already Have an Account\n              </Button>\n            </div>\n          </div>\n\n          {/* Stats */}\n          <div className=\"grid grid-cols-3 gap-4 sm:gap-8 mt-12 sm:mt-16 max-w-3xl mx-auto\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl sm:text-3xl font-bold mb-2\" data-testid=\"stat-matches\">500+</div>\n              <div className=\"text-xs sm:text-sm text-muted-foreground\">Projects Available</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl sm:text-3xl font-bold mb-2\" data-testid=\"stat-ai\">AI-Powered</div>\n              <div className=\"text-xs sm:text-sm text-muted-foreground\">Smart Matching</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl sm:text-3xl font-bold mb-2\" data-testid=\"stat-time\">&lt; 60s</div>\n              <div className=\"text-xs sm:text-sm text-muted-foreground\">Time to Match</div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* How It Works - Workflow Visualization */}\n      <section className=\"py-12 sm:py-16 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-8 sm:mb-12\">\n            <h2 className=\"text-2xl sm:text-3xl font-bold mb-3 sm:mb-4\">How It Works</h2>\n            <p className=\"text-base sm:text-lg text-muted-foreground px-4 sm:px-0\">\n              Three simple steps to your next opportunity\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-3 gap-6 sm:gap-8 max-w-5xl mx-auto\">\n            {/* Step 1 */}\n            <div className=\"space-y-3\">\n              <div className=\"bg-black text-white px-4 py-2 rounded-md font-semibold text-center\">\n                Upload CV\n              </div>\n              <div className=\"space-y-2\">\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <FileText className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">Upload your PDF resume</span>\n                  </CardContent>\n                </Card>\n                <div className=\"h-2 w-px bg-border mx-auto\" />\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <Brain className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">AI extracts your skills</span>\n                  </CardContent>\n                </Card>\n                <div className=\"h-2 w-px bg-border mx-auto\" />\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">Profile created instantly</span>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n\n            {/* Step 2 */}\n            <div className=\"space-y-3\">\n              <div className=\"bg-black text-white px-4 py-2 rounded-md font-semibold text-center\">\n                Get Matched\n              </div>\n              <div className=\"space-y-2\">\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <Target className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">AI finds relevant projects</span>\n                  </CardContent>\n                </Card>\n                <div className=\"h-2 w-px bg-border mx-auto\" />\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <TrendingUp className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">Calculate fit scores</span>\n                  </CardContent>\n                </Card>\n                <div className=\"h-2 w-px bg-border mx-auto\" />\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <Zap className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">Ranked by relevance</span>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n\n            {/* Step 3 */}\n            <div className=\"space-y-3\">\n              <div className=\"bg-black text-white px-4 py-2 rounded-md font-semibold text-center\">\n                Apply & Win\n              </div>\n              <div className=\"space-y-2\">\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <Briefcase className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">Review opportunities</span>\n                  </CardContent>\n                </Card>\n                <div className=\"h-2 w-px bg-border mx-auto\" />\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <CheckCircle2 className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">One-click apply</span>\n                  </CardContent>\n                </Card>\n                <div className=\"h-2 w-px bg-border mx-auto\" />\n                <Card className=\"hover-elevate\">\n                  <CardContent className=\"p-4 flex items-center gap-3\">\n                    <TrendingUp className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n                    <span className=\"text-sm\">Track your applications</span>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Features */}\n      <section className=\"py-12 sm:py-16\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-8 sm:mb-12\">\n            <h2 className=\"text-2xl sm:text-3xl font-bold mb-3 sm:mb-4\">Why Candidates Choose Us</h2>\n            <p className=\"text-base sm:text-lg text-muted-foreground px-4 sm:px-0\">\n              Modern talent matching powered by AI\n            </p>\n          </div>\n\n          <div className=\"grid sm:grid-cols-2 md:grid-cols-3 gap-6 sm:gap-8\">\n            <Card>\n              <CardHeader>\n                <div className=\"w-12 h-12 bg-black rounded-md flex items-center justify-center mb-4\">\n                  <Brain className=\"w-6 h-6 text-white\" />\n                </div>\n                <CardTitle>AI Skill Extraction</CardTitle>\n                <CardDescription>\n                  Google Gemini AI automatically identifies your skills, experience, and expertise from your CV\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <div className=\"w-12 h-12 bg-black rounded-md flex items-center justify-center mb-4\">\n                  <Target className=\"w-6 h-6 text-white\" />\n                </div>\n                <CardTitle>Smart Matching</CardTitle>\n                <CardDescription>\n                  Get matched with projects based on skill overlap, experience level, and soft skill relevance\n                </CardDescription>\n              </CardHeader>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <div className=\"w-12 h-12 bg-black rounded-md flex items-center justify-center mb-4\">\n                  <Zap className=\"w-6 h-6 text-white\" />\n                </div>\n                <CardTitle>Instant Results</CardTitle>\n                <CardDescription>\n                  See fit scores (0-100%) for every project and understand why you're a good match\n                </CardDescription>\n              </CardHeader>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Upload Section */}\n      {showUploadSection && (\n        <section id=\"upload-section\" className=\"py-16 bg-muted/30 scroll-mt-16\">\n          <div className=\"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <Card>\n              <CardHeader className=\"text-center\">\n                <CardTitle className=\"text-2xl\" data-testid=\"upload-title\">\n                  Upload Your CV\n                </CardTitle>\n                <CardDescription>\n                  Get matched with projects that fit your skills\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {uploadState === 'idle' && (\n                  <div className=\"space-y-4\">\n                    <div className=\"border-2 border-dashed rounded-md p-12 text-center hover-elevate active-elevate-2 transition-colors\">\n                      <input\n                        type=\"file\"\n                        id=\"cv-upload\"\n                        accept=\".pdf\"\n                        onChange={handleFileUpload}\n                        className=\"hidden\"\n                        data-testid=\"input-cv-file\"\n                      />\n                      <label\n                        htmlFor=\"cv-upload\"\n                        className=\"cursor-pointer flex flex-col items-center gap-3\"\n                      >\n                        <Upload className=\"w-12 h-12 text-muted-foreground\" />\n                        <div>\n                          <p className=\"font-medium\">Click to upload CV</p>\n                          <p className=\"text-sm text-muted-foreground\">PDF format only</p>\n                        </div>\n                      </label>\n                    </div>\n\n                    <div className=\"bg-muted/50 rounded-md p-4 text-sm text-center\">\n                      <p className=\"text-muted-foreground\">\n                        After uploading, you'll be prompted to login to view your matches\n                      </p>\n                    </div>\n                  </div>\n                )}\n\n                {(uploadState === 'uploading' || uploadState === 'parsing' || uploadState === 'analyzing') && (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-center gap-3\">\n                      <Loader2 className=\"w-6 h-6 animate-spin\" />\n                      <span className=\"font-medium\">\n                        {uploadState === 'uploading' && 'Uploading CV...'}\n                        {uploadState === 'parsing' && 'Parsing document...'}\n                        {uploadState === 'analyzing' && 'AI analyzing skills...'}\n                      </span>\n                    </div>\n                    <div className=\"w-full bg-muted rounded-full h-2\">\n                      <div\n                        className=\"bg-black h-2 rounded-full transition-all duration-300\"\n                        style={{ width: `${progress}%` }}\n                        data-testid=\"progress-bar\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n                {uploadState === 'complete' && (\n                  <div className=\"text-center space-y-4\">\n                    <CheckCircle2 className=\"w-16 h-16 text-green-600 mx-auto\" data-testid=\"icon-success\" />\n                    <div>\n                      <h3 className=\"text-xl font-semibold\" data-testid=\"success-title\">\n                        CV Uploaded Successfully!\n                      </h3>\n                      <p className=\"text-muted-foreground\">\n                        Please login to view your job matches\n                      </p>\n                    </div>\n                  </div>\n                )}\n\n                {uploadState === 'error' && (\n                  <div className=\"text-center space-y-4\">\n                    <AlertCircle className=\"w-16 h-16 text-destructive mx-auto\" data-testid=\"icon-error\" />\n                    <div>\n                      <h3 className=\"text-xl font-semibold\">Upload Failed</h3>\n                      <p className=\"text-muted-foreground\" data-testid=\"error-message\">\n                        {errorMessage}\n                      </p>\n                    </div>\n                    <Button\n                      onClick={() => {\n                        setUploadState('idle');\n                        setProgress(0);\n                        setErrorMessage('');\n                      }}\n                      data-testid=\"button-try-again\"\n                    >\n                      Try Again\n                    </Button>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </section>\n      )}\n\n      {/* CTA Section */}\n      <section className=\"py-16 border-t\">\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n          <h2 className=\"text-3xl font-bold mb-4\">Ready to Find Your Next Opportunity?</h2>\n          <p className=\"text-lg text-muted-foreground mb-8\">\n            Join hundreds of talented professionals getting matched with their ideal projects\n          </p>\n          <Button \n            size=\"lg\"\n            onClick={() => {\n              setShowUploadSection(true);\n              setTimeout(() => {\n                document.getElementById('upload-section')?.scrollIntoView({ \n                  behavior: 'smooth' \n                });\n              }, 100);\n            }}\n            data-testid=\"button-cta-upload\"\n          >\n            <Upload className=\"w-5 h-5 mr-2\" />\n            Get Started Now\n          </Button>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"border-t py-8\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center text-sm text-muted-foreground\">\n            <div className=\"flex items-center gap-2\">\n              <Briefcase className=\"w-4 h-4\" />\n              <span>Powered by LeanfounderSpace</span>\n            </div>\n            <div>© 2025 Lean Workforce. All rights reserved.</div>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","size_bytes":20096},"client/src/pages/Login.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Mail, Loader2, CheckCircle2, AlertCircle, Clock, Briefcase, User } from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function Login() {\n  const [email, setEmail] = useState(\"\");\n  const [role, setRole] = useState<\"candidate\" | \"business\">(\"candidate\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [linkSent, setLinkSent] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [canResend, setCanResend] = useState(true);\n  const [countdown, setCountdown] = useState(0);\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    \n    if (!email || !email.includes(\"@\")) {\n      setError(\"Please enter a valid email address\");\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const response = await apiRequest(\"POST\", \"/api/auth/request-magic-link\", { \n        email,\n        requestedRole: role \n      });\n      \n      setLinkSent(true);\n      setCanResend(false);\n      \n      // Start 30 second countdown before allowing resend\n      let timeLeft = 30;\n      setCountdown(timeLeft);\n      const timer = setInterval(() => {\n        timeLeft -= 1;\n        setCountdown(timeLeft);\n        if (timeLeft <= 0) {\n          clearInterval(timer);\n          setCanResend(true);\n          setCountdown(0);\n        }\n      }, 1000);\n\n      toast({\n        title: \"Magic link sent!\",\n        description: \"Check your email for the login link.\",\n      });\n    } catch (err: any) {\n      const errorMsg = err.message || \"Failed to send magic link. Please try again.\";\n      setError(errorMsg);\n      \n      if (err.message?.includes(\"Too many requests\")) {\n        setCanResend(false);\n        toast({\n          title: \"Rate limit exceeded\",\n          description: \"Please wait before requesting another link.\",\n          variant: \"destructive\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: errorMsg,\n          variant: \"destructive\",\n        });\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleResend = () => {\n    setLinkSent(false);\n    setError(\"\");\n    handleSubmit(new Event(\"submit\") as any);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Lean Workforce</h1>\n          <p className=\"text-muted-foreground\">AI-powered talent matching platform</p>\n        </div>\n\n        <Card>\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4\">\n              <Mail className=\"w-6 h-6 text-primary\" />\n            </div>\n            <CardTitle>Login to Your Account</CardTitle>\n            <CardDescription>\n              Enter your email and we'll send you a secure login link\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {!linkSent ? (\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\n                <div>\n                  <Label htmlFor=\"email\" className=\"text-sm font-medium mb-2 block\">\n                    Email Address\n                  </Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    placeholder=\"your.email@example.com\"\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    disabled={isLoading}\n                    autoFocus\n                    data-testid=\"input-email\"\n                  />\n                  {error && (\n                    <div className=\"flex items-center gap-2 mt-2 text-sm text-destructive\">\n                      <AlertCircle className=\"w-4 h-4\" />\n                      <span data-testid=\"error-message\">{error}</span>\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <Label className=\"text-sm font-medium mb-3 block\">\n                    Login As\n                  </Label>\n                  <RadioGroup \n                    value={role} \n                    onValueChange={(value) => setRole(value as \"candidate\" | \"business\")}\n                    className=\"grid grid-cols-2 gap-4\"\n                  >\n                    <div>\n                      <RadioGroupItem\n                        value=\"candidate\"\n                        id=\"candidate\"\n                        className=\"peer sr-only\"\n                        data-testid=\"radio-candidate\"\n                      />\n                      <Label\n                        htmlFor=\"candidate\"\n                        className=\"flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover-elevate cursor-pointer peer-data-[state=checked]:border-primary [&:has([data-state=checked])]:border-primary\"\n                      >\n                        <User className=\"mb-3 h-6 w-6\" />\n                        <div className=\"text-center\">\n                          <div className=\"font-semibold\">Candidate</div>\n                          <div className=\"text-xs text-muted-foreground mt-1\">\n                            Find opportunities\n                          </div>\n                        </div>\n                      </Label>\n                    </div>\n                    <div>\n                      <RadioGroupItem\n                        value=\"business\"\n                        id=\"business\"\n                        className=\"peer sr-only\"\n                        data-testid=\"radio-business\"\n                      />\n                      <Label\n                        htmlFor=\"business\"\n                        className=\"flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover-elevate cursor-pointer peer-data-[state=checked]:border-primary [&:has([data-state=checked])]:border-primary\"\n                      >\n                        <Briefcase className=\"mb-3 h-6 w-6\" />\n                        <div className=\"text-center\">\n                          <div className=\"font-semibold\">Business</div>\n                          <div className=\"text-xs text-muted-foreground mt-1\">\n                            Find talent\n                          </div>\n                        </div>\n                      </Label>\n                    </div>\n                  </RadioGroup>\n                </div>\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={isLoading || !email}\n                  data-testid=\"button-send-link\"\n                >\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Sending...\n                    </>\n                  ) : (\n                    <>\n                      <Mail className=\"w-4 h-4 mr-2\" />\n                      Send Magic Link\n                    </>\n                  )}\n                </Button>\n\n                <p className=\"text-xs text-center text-muted-foreground\">\n                  No password needed. We'll email you a secure link to log in.\n                </p>\n              </form>\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"flex flex-col items-center text-center py-6\">\n                  <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n                    <CheckCircle2 className=\"w-8 h-8 text-green-600\" />\n                  </div>\n                  <h3 className=\"font-semibold text-lg mb-2\" data-testid=\"success-title\">Check Your Email</h3>\n                  <p className=\"text-muted-foreground mb-4\" data-testid=\"success-message\">\n                    We sent a login link to <strong>{email}</strong>\n                  </p>\n                  <div className=\"bg-muted/50 rounded-md p-4 mb-4 text-sm space-y-2\">\n                    <div className=\"flex items-start gap-2\">\n                      <Clock className=\"w-4 h-4 mt-0.5 shrink-0\" />\n                      <p className=\"text-left\">\n                        The link will expire in <strong>10 minutes</strong>\n                      </p>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <Mail className=\"w-4 h-4 mt-0.5 shrink-0\" />\n                      <p className=\"text-left\">\n                        Check your spam folder if you don't see it\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full\"\n                  onClick={handleResend}\n                  disabled={!canResend || isLoading}\n                  data-testid=\"button-resend\"\n                >\n                  {countdown > 0 ? (\n                    <>\n                      Resend in {countdown}s\n                    </>\n                  ) : (\n                    <>\n                      Resend Link\n                    </>\n                  )}\n                </Button>\n\n                <Button\n                  variant=\"ghost\"\n                  className=\"w-full\"\n                  onClick={() => {\n                    setLinkSent(false);\n                    setEmail(\"\");\n                    setError(\"\");\n                  }}\n                  data-testid=\"button-different-email\"\n                >\n                  Use Different Email\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <div className=\"text-center mt-6 text-sm text-muted-foreground\">\n          <p>New to Lean Workforce?</p>\n          <p className=\"mt-1\">Just enter your email to create an account automatically.</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10391},"client/src/components/ProtectedRoute.tsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Loader2 } from \"lucide-react\";\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n  requireBusiness?: boolean;\n  requireCandidate?: boolean;\n}\n\nexport function ProtectedRoute({ \n  children, \n  requireBusiness = false,\n  requireCandidate = false \n}: ProtectedRouteProps) {\n  const [, setLocation] = useLocation();\n  const { user, isLoading } = useAuth();\n\n  useEffect(() => {\n    if (!isLoading && !user) {\n      // Not logged in → Redirect to home or appropriate login\n      const loginPath = requireBusiness ? \"/business-login\" : \n                       requireCandidate ? \"/candidate-login\" : \"/\";\n      setLocation(loginPath);\n      return;\n    }\n\n    if (!isLoading && user) {\n      // Business route but wrong role\n      if (requireBusiness && user.role !== \"business\") {\n        const dashboardPath = user.role === \"candidate\" ? \"/candidate/dashboard\" : \"/\";\n        setLocation(dashboardPath);\n        return;\n      }\n\n      // Candidate route but wrong role\n      if (requireCandidate && user.role !== \"candidate\") {\n        const dashboardPath = user.role === \"business\" ? \"/business\" : \"/\";\n        setLocation(dashboardPath);\n        return;\n      }\n    }\n  }, [user, isLoading, setLocation, requireBusiness, requireCandidate]);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  if (!user) {\n    return null;\n  }\n\n  // Block wrong role\n  if (requireBusiness && user.role !== \"business\") {\n    return null;\n  }\n\n  if (requireCandidate && user.role !== \"candidate\") {\n    return null;\n  }\n\n  return <>{children}</>;\n}\n","size_bytes":1820},"server/sendgrid.ts":{"content":"import sgMail from '@sendgrid/mail';\n\nlet connectionSettings: any;\n\nasync function getCredentials() {\n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=sendgrid',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  if (!connectionSettings || (!connectionSettings.settings.api_key || !connectionSettings.settings.from_email)) {\n    throw new Error('SendGrid not connected');\n  }\n  return {apiKey: connectionSettings.settings.api_key, email: connectionSettings.settings.from_email};\n}\n\nexport async function getUncachableSendGridClient() {\n  const {apiKey, email} = await getCredentials();\n  sgMail.setApiKey(apiKey);\n  return {\n    client: sgMail,\n    fromEmail: email\n  };\n}\n\nexport async function sendMagicLinkEmail(to: string, magicLink: string): Promise<void> {\n  const {client, fromEmail} = await getUncachableSendGridClient();\n  \n  const msg = {\n    to,\n    from: fromEmail,\n    subject: 'Your Login Link for Lean Workforce',\n    text: `Click the link below to log in to your account:\\n\\n${magicLink}\\n\\nThis link will expire in 10 minutes and can only be used once.\\n\\nIf you didn't request this link, you can safely ignore this email.`,\n    html: `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #000000;\">Login to Lean Workforce</h2>\n        <p>Click the button below to log in to your account:</p>\n        <div style=\"margin: 30px 0;\">\n          <a href=\"${magicLink}\" \n             style=\"background-color: #000000; color: #ffffff; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">\n            Login to Account\n          </a>\n        </div>\n        <p style=\"color: #666666; font-size: 14px;\">\n          Or copy and paste this link into your browser:<br>\n          <a href=\"${magicLink}\" style=\"color: #000000;\">${magicLink}</a>\n        </p>\n        <p style=\"color: #999999; font-size: 12px; margin-top: 30px;\">\n          This link will expire in 10 minutes and can only be used once.<br>\n          If you didn't request this link, you can safely ignore this email.\n        </p>\n      </div>\n    `\n  };\n\n  await client.send(msg);\n  console.log(`✅ Magic link email sent to ${to}`);\n}\n\n/**\n * Send job completion notification email\n */\nexport async function sendJobCompletionEmail(\n  to: string, \n  jobType: string, \n  status: \"success\" | \"failed\",\n  errorMessage?: string\n): Promise<void> {\n  try {\n    const {client, fromEmail} = await getUncachableSendGridClient();\n    \n    const jobTypeLabel = {\n      'cv_processing': 'CV Processing',\n      'fit_score_calculation': 'Job Matching',\n      'skill_map_generation': 'Skill Analysis',\n      'jira_sync': 'Jira Synchronization'\n    }[jobType] || jobType;\n    \n    const subject = status === \"success\" \n      ? `✓ ${jobTypeLabel} Completed` \n      : `✗ ${jobTypeLabel} Failed`;\n    \n    const successMessage = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #000000;\">Job Completed Successfully</h2>\n        <p>Your ${jobTypeLabel} has been completed successfully.</p>\n        <p>Log in to view your results:</p>\n        <div style=\"margin: 30px 0;\">\n          <a href=\"${process.env.REPLIT_DOMAINS || 'http://localhost:5000'}\" \n             style=\"background-color: #000000; color: #ffffff; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">\n            View Dashboard\n          </a>\n        </div>\n      </div>\n    `;\n    \n    const failureMessage = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #000000;\">Job Failed</h2>\n        <p>Unfortunately, your ${jobTypeLabel} job encountered an error.</p>\n        ${errorMessage ? `<p style=\"color: #666666;\">Error: ${errorMessage}</p>` : ''}\n        <p>Please try again or contact support if the issue persists.</p>\n        <div style=\"margin: 30px 0;\">\n          <a href=\"${process.env.REPLIT_DOMAINS || 'http://localhost:5000'}\" \n             style=\"background-color: #000000; color: #ffffff; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">\n            Return to Dashboard\n          </a>\n        </div>\n      </div>\n    `;\n    \n    const msg = {\n      to,\n      from: fromEmail,\n      subject,\n      html: status === \"success\" ? successMessage : failureMessage\n    };\n    \n    await client.send(msg);\n    console.log(`✅ Job completion email sent to ${to} (${status})`);\n  } catch (error: any) {\n    console.error(`Failed to send job completion email: ${error.message}`);\n    // Don't throw - email failure shouldn't break the job\n  }\n}\n","size_bytes":5196},"client/src/pages/CandidateUpload.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Upload, CheckCircle2, AlertCircle, Loader2, ArrowRight } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { isAuthenticated } from \"@/lib/auth\";\n\ntype UploadState = 'idle' | 'uploading' | 'parsing' | 'analyzing' | 'complete' | 'error';\n\nexport default function CandidateUpload() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [uploadState, setUploadState] = useState<UploadState>('idle');\n  const [progress, setProgress] = useState(0);\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const isLoggedIn = isAuthenticated();\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    if (!file.name.endsWith('.pdf')) {\n      toast({\n        title: \"Invalid File\",\n        description: \"Please upload a PDF file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('cv', file);\n\n    try {\n      setUploadState('uploading');\n      setProgress(25);\n\n      setTimeout(() => {\n        setUploadState('parsing');\n        setProgress(50);\n      }, 500);\n\n      setTimeout(() => {\n        setUploadState('analyzing');\n        setProgress(75);\n      }, 1000);\n\n      const res = await fetch('/api/candidate/upload-cv', {\n        method: 'POST',\n        body: formData,\n        credentials: 'include',\n      });\n\n      if (!res.ok) {\n        const text = await res.text();\n        throw new Error(text || 'Upload failed');\n      }\n\n      setProgress(100);\n      setUploadState('complete');\n\n      toast({\n        title: \"CV Uploaded Successfully\",\n        description: \"Your profile has been created with AI-extracted skills\",\n      });\n\n      if (isLoggedIn) {\n        setTimeout(() => setLocation('/candidate/dashboard'), 1500);\n      } else {\n        setTimeout(() => setLocation('/login'), 2000);\n      }\n    } catch (error: any) {\n      setUploadState('error');\n      setErrorMessage(error.message || 'Upload failed');\n      toast({\n        title: \"Upload Failed\",\n        description: error.message || \"Failed to upload CV\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-2xl\">\n        <CardHeader className=\"text-center\">\n          <CardTitle className=\"text-2xl\" data-testid=\"upload-title\">\n            Upload Your CV\n          </CardTitle>\n          <CardDescription>\n            Get matched with projects that fit your skills\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {uploadState === 'idle' && (\n            <div className=\"space-y-4\">\n              <div className=\"border-2 border-dashed rounded-md p-12 text-center hover-elevate active-elevate-2 transition-colors\">\n                <input\n                  type=\"file\"\n                  id=\"cv-upload\"\n                  accept=\".pdf\"\n                  onChange={handleFileUpload}\n                  className=\"hidden\"\n                  data-testid=\"input-cv-file\"\n                />\n                <label\n                  htmlFor=\"cv-upload\"\n                  className=\"cursor-pointer flex flex-col items-center gap-3\"\n                >\n                  <Upload className=\"w-12 h-12 text-muted-foreground\" />\n                  <div>\n                    <p className=\"font-medium\">Click to upload CV</p>\n                    <p className=\"text-sm text-muted-foreground\">PDF format only</p>\n                  </div>\n                </label>\n              </div>\n\n              {!isLoggedIn && (\n                <div className=\"bg-muted/50 rounded-md p-4 text-sm text-center\">\n                  <p className=\"text-muted-foreground\">\n                    After uploading, you'll be prompted to login to view your matches\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {(uploadState === 'uploading' || uploadState === 'parsing' || uploadState === 'analyzing') && (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-center gap-3\">\n                <Loader2 className=\"w-6 h-6 animate-spin\" />\n                <span className=\"font-medium\">\n                  {uploadState === 'uploading' && 'Uploading CV...'}\n                  {uploadState === 'parsing' && 'Parsing document...'}\n                  {uploadState === 'analyzing' && 'AI analyzing skills...'}\n                </span>\n              </div>\n              <div className=\"w-full bg-muted rounded-full h-2\">\n                <div\n                  className=\"bg-black h-2 rounded-full transition-all duration-300\"\n                  style={{ width: `${progress}%` }}\n                  data-testid=\"progress-bar\"\n                />\n              </div>\n            </div>\n          )}\n\n          {uploadState === 'complete' && (\n            <div className=\"text-center space-y-4\">\n              <CheckCircle2 className=\"w-16 h-16 text-green-600 mx-auto\" data-testid=\"icon-success\" />\n              <div>\n                <h3 className=\"text-xl font-semibold\" data-testid=\"success-title\">\n                  CV Uploaded Successfully!\n                </h3>\n                <p className=\"text-muted-foreground\">\n                  {isLoggedIn \n                    ? \"Redirecting to your dashboard...\"\n                    : \"Please login to view your job matches\"}\n                </p>\n              </div>\n            </div>\n          )}\n\n          {uploadState === 'error' && (\n            <div className=\"text-center space-y-4\">\n              <AlertCircle className=\"w-16 h-16 text-destructive mx-auto\" data-testid=\"icon-error\" />\n              <div>\n                <h3 className=\"text-xl font-semibold\">Upload Failed</h3>\n                <p className=\"text-muted-foreground\" data-testid=\"error-message\">\n                  {errorMessage}\n                </p>\n              </div>\n              <Button\n                onClick={() => {\n                  setUploadState('idle');\n                  setProgress(0);\n                  setErrorMessage('');\n                }}\n                data-testid=\"button-try-again\"\n              >\n                Try Again\n              </Button>\n            </div>\n          )}\n\n          <div className=\"flex justify-between items-center pt-4 border-t\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => setLocation('/')}\n              data-testid=\"button-back\"\n            >\n              Back to Home\n            </Button>\n            {!isLoggedIn && uploadState === 'idle' && (\n              <Button\n                variant=\"ghost\"\n                onClick={() => setLocation('/login')}\n                data-testid=\"button-login\"\n              >\n                Already have an account?\n                <ArrowRight className=\"w-4 h-4 ml-2\" />\n              </Button>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7345},"server/document-parser.ts":{"content":"import { readFileSync } from \"fs\";\nimport mammoth from \"mammoth\";\n\n// Dynamic import for pdf-parse since it doesn't have proper ESM support\nasync function getPdfParser() {\n  const pdfParse = await import(\"pdf-parse\");\n  return pdfParse.default || pdfParse;\n}\n\nexport interface ParseResult {\n  text: string;\n  error?: string;\n}\n\n/**\n * Extract text from PDF file with retry logic\n */\nasync function extractPDFText(filePath: string, retries = 3): Promise<string> {\n  let lastError: Error | null = null;\n  \n  for (let attempt = 1; attempt <= retries; attempt++) {\n    try {\n      const dataBuffer = readFileSync(filePath);\n      const pdfParse = await getPdfParser();\n      const data = await pdfParse(dataBuffer);\n      \n      if (!data.text || data.text.trim().length === 0) {\n        throw new Error(\"PDF parsing resulted in empty text\");\n      }\n      \n      return data.text;\n    } catch (error: any) {\n      lastError = error;\n      console.error(`PDF extraction attempt ${attempt}/${retries} failed:`, error.message);\n      \n      // Exponential backoff: wait 2^attempt seconds\n      if (attempt < retries) {\n        const waitTime = Math.pow(2, attempt) * 1000;\n        console.log(`Retrying PDF extraction in ${waitTime}ms...`);\n        await new Promise(resolve => setTimeout(resolve, waitTime));\n      }\n    }\n  }\n  \n  throw new Error(`PDF extraction failed after ${retries} attempts: ${lastError?.message}`);\n}\n\n/**\n * Extract text from DOC/DOCX file with retry logic\n */\nasync function extractDocxText(filePath: string, retries = 3): Promise<string> {\n  let lastError: Error | null = null;\n  \n  for (let attempt = 1; attempt <= retries; attempt++) {\n    try {\n      const result = await mammoth.extractRawText({ path: filePath });\n      \n      if (!result.value || result.value.trim().length === 0) {\n        throw new Error(\"DOCX parsing resulted in empty text\");\n      }\n      \n      return result.value;\n    } catch (error: any) {\n      lastError = error;\n      console.error(`DOCX extraction attempt ${attempt}/${retries} failed:`, error.message);\n      \n      // Exponential backoff\n      if (attempt < retries) {\n        const waitTime = Math.pow(2, attempt) * 1000;\n        console.log(`Retrying DOCX extraction in ${waitTime}ms...`);\n        await new Promise(resolve => setTimeout(resolve, waitTime));\n      }\n    }\n  }\n  \n  throw new Error(`DOCX extraction failed after ${retries} attempts: ${lastError?.message}`);\n}\n\n/**\n * Parse document and extract text based on file type\n * Supports: PDF, DOC, DOCX, TXT\n */\nexport async function parseDocument(filePath: string, mimeType?: string): Promise<ParseResult> {\n  try {\n    // Determine file type from mimetype or file extension\n    const fileExtension = filePath.toLowerCase().split('.').pop();\n    \n    let text: string;\n    \n    if (mimeType === 'application/pdf' || fileExtension === 'pdf') {\n      console.log('Parsing PDF document...');\n      text = await extractPDFText(filePath);\n    } else if (\n      mimeType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ||\n      mimeType === 'application/msword' ||\n      fileExtension === 'docx' ||\n      fileExtension === 'doc'\n    ) {\n      console.log('Parsing Word document...');\n      text = await extractDocxText(filePath);\n    } else if (mimeType?.startsWith('text/') || fileExtension === 'txt') {\n      console.log('Reading plain text document...');\n      text = readFileSync(filePath, 'utf-8');\n    } else {\n      return {\n        text: '',\n        error: `Unsupported file type: ${mimeType || fileExtension}. Please upload PDF, DOC, DOCX, or TXT files.`\n      };\n    }\n    \n    // Validate we got meaningful text\n    if (!text || text.trim().length < 50) {\n      return {\n        text: text || '',\n        error: 'Document appears to be empty or too short. Please ensure your CV contains readable text.'\n      };\n    }\n    \n    console.log(`Successfully extracted ${text.length} characters from document`);\n    return { text };\n    \n  } catch (error: any) {\n    console.error('Document parsing error:', error);\n    return {\n      text: '',\n      error: `Failed to parse document: ${error.message}. Please try a different file or format.`\n    };\n  }\n}\n\n/**\n * Validate file type before processing\n */\nexport function validateFileType(filename: string, mimeType?: string): { valid: boolean; error?: string } {\n  const allowedExtensions = ['pdf', 'doc', 'docx', 'txt'];\n  const allowedMimeTypes = [\n    'application/pdf',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    'application/msword',\n    'text/plain'\n  ];\n  \n  const fileExtension = filename.toLowerCase().split('.').pop();\n  \n  if (!fileExtension || !allowedExtensions.includes(fileExtension)) {\n    return {\n      valid: false,\n      error: `Invalid file type. Please upload a PDF, DOC, DOCX, or TXT file. Received: .${fileExtension}`\n    };\n  }\n  \n  if (mimeType && !allowedMimeTypes.includes(mimeType)) {\n    // Be lenient with mime type since some browsers send different values\n    console.warn(`Unexpected MIME type: ${mimeType} for file ${filename}`);\n  }\n  \n  return { valid: true };\n}\n","size_bytes":5142},"server/job-worker.ts":{"content":"import { storage } from \"./storage\";\nimport { parseDocument } from \"./document-parser\";\nimport { analyzeCVText, calculateFitScore, generateSkillMap } from \"./gemini\";\nimport { calculateFallbackFitScore, extractFallbackSkillMap } from \"./fallback-scoring\";\nimport { sendJobCompletionEmail } from \"./sendgrid\";\nimport type { BackgroundJob } from \"@shared/schema\";\n\n/**\n * Background Job Worker - processes async jobs\n */\n\nlet isWorkerRunning = false;\nconst POLL_INTERVAL = 5000; // Check for new jobs every 5 seconds\nconst MAX_CONCURRENT_JOBS = 3;\n\n/**\n * Start the background job worker\n */\nexport function startJobWorker() {\n  if (isWorkerRunning) {\n    console.log('[Job Worker] Already running');\n    return;\n  }\n  \n  isWorkerRunning = true;\n  console.log('[Job Worker] Starting background job processor...');\n  \n  // Start polling for jobs\n  processJobQueue();\n}\n\n/**\n * Stop the job worker\n */\nexport function stopJobWorker() {\n  isWorkerRunning = false;\n  console.log('[Job Worker] Stopped');\n}\n\n/**\n * Main job queue processing loop\n */\nasync function processJobQueue() {\n  while (isWorkerRunning) {\n    try {\n      // Get pending jobs\n      const pendingJobs = await storage.getPendingJobs(MAX_CONCURRENT_JOBS);\n      \n      if (pendingJobs.length > 0) {\n        console.log(`[Job Worker] Processing ${pendingJobs.length} jobs...`);\n        \n        // Process jobs in parallel\n        await Promise.all(pendingJobs.map(job => processJob(job)));\n      }\n      \n      // Wait before next poll\n      await new Promise(resolve => setTimeout(resolve, POLL_INTERVAL));\n    } catch (error: any) {\n      console.error('[Job Worker] Queue processing error:', error.message);\n      await new Promise(resolve => setTimeout(resolve, POLL_INTERVAL));\n    }\n  }\n}\n\n/**\n * Process a single background job\n */\nasync function processJob(job: BackgroundJob) {\n  const jobId = job.id;\n  \n  try {\n    console.log(`[Job Worker] Processing ${job.jobType} job ${jobId}`);\n    \n    // Mark job as processing\n    await storage.updateJob(jobId, {\n      status: \"processing\",\n      startedAt: new Date(),\n      attempts: (job.attempts || 0) + 1,\n    });\n    \n    // Execute job based on type\n    let result: any;\n    switch (job.jobType) {\n      case \"cv_processing\":\n        result = await processCVJob(job);\n        break;\n      case \"fit_score_calculation\":\n        result = await processFitScoreJob(job);\n        break;\n      case \"skill_map_generation\":\n        result = await processSkillMapJob(job);\n        break;\n      default:\n        throw new Error(`Unknown job type: ${job.jobType}`);\n    }\n    \n    // Mark job as completed\n    await storage.updateJob(jobId, {\n      status: \"completed\",\n      result: result as any,\n      progress: 100,\n      completedAt: new Date(),\n    });\n    \n    console.log(`[Job Worker] ✓ Completed ${job.jobType} job ${jobId}`);\n    \n    // Send email notification\n    if (job.userEmail) {\n      try {\n        await sendJobCompletionEmail(job.userEmail, job.jobType, \"success\");\n      } catch (error) {\n        console.error('[Job Worker] Email notification failed:', error);\n      }\n    }\n    \n  } catch (error: any) {\n    console.error(`[Job Worker] ✗ Failed ${job.jobType} job ${jobId}:`, error.message);\n    \n    // Check if we should retry\n    const shouldRetry = (job.attempts || 0) < (job.maxAttempts || 3);\n    \n    await storage.updateJob(jobId, {\n      status: shouldRetry ? \"pending\" : \"failed\",\n      error: error.message,\n    });\n    \n    // Send failure email if max attempts reached\n    if (!shouldRetry && job.userEmail) {\n      try {\n        await sendJobCompletionEmail(job.userEmail, job.jobType, \"failed\", error.message);\n      } catch (emailError) {\n        console.error('[Job Worker] Email notification failed:', emailError);\n      }\n    }\n  }\n}\n\n/**\n * Process CV upload job\n */\nasync function processCVJob(job: BackgroundJob) {\n  const { candidateId, filePath, mimeType } = job.payload as any;\n  \n  console.log(`[CV Processing] Parsing document for candidate ${candidateId}`);\n  \n  // Step 1: Parse document (10%)\n  await storage.updateJob(job.id, { progress: 10 });\n  const parseResult = await parseDocument(filePath, mimeType);\n  \n  if (parseResult.error || !parseResult.text) {\n    throw new Error(parseResult.error || \"Failed to extract text from CV\");\n  }\n  \n  // Step 2: Analyze with AI (50%)\n  await storage.updateJob(job.id, { progress: 50 });\n  let cvAnalysis;\n  let usedFallback = false;\n  \n  try {\n    cvAnalysis = await analyzeCVText(parseResult.text);\n  } catch (error: any) {\n    console.error('[CV Processing] AI analysis failed, using fallback:', error.message);\n    usedFallback = true;\n    \n    // Fallback: extract basic info from text\n    cvAnalysis = {\n      name: \"Candidate\",\n      skills: extractKeywords(parseResult.text, [\"javascript\", \"python\", \"react\", \"node\"]),\n      experience: parseResult.text.substring(0, 500),\n      education: \"Not specified\",\n    };\n  }\n  \n  // Step 3: Update candidate (70%)\n  await storage.updateJob(job.id, { progress: 70 });\n  await storage.updateCandidate(candidateId, {\n    cvAnalysis: cvAnalysis as any,\n    skills: cvAnalysis.skills,\n    experience: cvAnalysis.experience,\n    education: cvAnalysis.education,\n  });\n  \n  // Step 4: Calculate fit scores (100%)\n  await storage.updateJob(job.id, { progress: 90 });\n  const matchCount = await calculateAllFitScores(candidateId);\n  \n  return {\n    candidateId,\n    cvAnalyzed: true,\n    usedAI: !usedFallback,\n    matchesFound: matchCount,\n    skills: cvAnalysis.skills,\n  };\n}\n\n/**\n * Process fit score calculation job\n */\nasync function processFitScoreJob(job: BackgroundJob) {\n  const { candidateId, milestoneId } = job.payload as any;\n  \n  const candidate = await storage.getCandidate(candidateId);\n  const milestone = await storage.getMilestone(milestoneId);\n  \n  if (!candidate || !milestone) {\n    throw new Error(\"Candidate or milestone not found\");\n  }\n  \n  if (!milestone.skillMap || !candidate.skills) {\n    throw new Error(\"Missing skill data for fit score calculation\");\n  }\n  \n  let fitAnalysis;\n  let usedFallback = false;\n  \n  try {\n    fitAnalysis = await calculateFitScore(\n      candidate.skills,\n      candidate.experience || \"\",\n      milestone.skillMap as any\n    );\n  } catch (error: any) {\n    console.error('[Fit Score] AI calculation failed, using fallback:', error.message);\n    usedFallback = true;\n    \n    fitAnalysis = calculateFallbackFitScore(\n      candidate.skills,\n      candidate.experience || \"\",\n      milestone.skillMap as any\n    );\n  }\n  \n  await storage.createFitScore({\n    candidateId,\n    milestoneId,\n    score: Math.round(fitAnalysis.score),\n    skillOverlap: Math.round(fitAnalysis.skillOverlap),\n    experienceMatch: Math.round(fitAnalysis.experienceMatch),\n    softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n    reasoning: fitAnalysis.reasoning,\n  });\n  \n  return {\n    candidateId,\n    milestoneId,\n    score: Math.round(fitAnalysis.score),\n    usedAI: !usedFallback,\n  };\n}\n\n/**\n * Process skill map generation job\n */\nasync function processSkillMapJob(job: BackgroundJob) {\n  const { milestoneId, name, description } = job.payload as any;\n  \n  let skillMap;\n  let usedFallback = false;\n  \n  try {\n    skillMap = await generateSkillMap(name, description);\n  } catch (error: any) {\n    console.error('[Skill Map] AI generation failed, using fallback:', error.message);\n    usedFallback = true;\n    \n    skillMap = extractFallbackSkillMap(name, description);\n  }\n  \n  await storage.updateMilestone(milestoneId, {\n    skillMap: skillMap as any,\n  });\n  \n  return {\n    milestoneId,\n    skillMap,\n    usedAI: !usedFallback,\n  };\n}\n\n/**\n * Helper: Calculate fit scores for candidate against all milestones\n */\nasync function calculateAllFitScores(candidateId: string): Promise<number> {\n  const candidate = await storage.getCandidate(candidateId);\n  if (!candidate || !candidate.skills || candidate.skills.length === 0) {\n    return 0;\n  }\n  \n  const projects = await storage.getAllProjects();\n  let matchCount = 0;\n  \n  for (const project of projects) {\n    const milestones = await storage.getMilestonesByProject(project.id);\n    \n    for (const milestone of milestones) {\n      if (!milestone.skillMap) continue;\n      \n      try {\n        let fitAnalysis;\n        try {\n          fitAnalysis = await calculateFitScore(\n            candidate.skills,\n            candidate.experience || \"\",\n            milestone.skillMap as any\n          );\n        } catch (error) {\n          // Fallback if AI fails\n          fitAnalysis = calculateFallbackFitScore(\n            candidate.skills,\n            candidate.experience || \"\",\n            milestone.skillMap as any\n          );\n        }\n        \n        await storage.createFitScore({\n          candidateId,\n          milestoneId: milestone.id,\n          score: Math.round(fitAnalysis.score),\n          skillOverlap: Math.round(fitAnalysis.skillOverlap),\n          experienceMatch: Math.round(fitAnalysis.experienceMatch),\n          softSkillRelevance: Math.round(fitAnalysis.softSkillRelevance),\n          reasoning: fitAnalysis.reasoning,\n        });\n        \n        matchCount++;\n      } catch (error) {\n        console.error(`[Fit Score] Failed for milestone ${milestone.id}:`, error);\n      }\n    }\n  }\n  \n  return matchCount;\n}\n\n/**\n * Helper: Extract keywords from text\n */\nfunction extractKeywords(text: string, keywords: string[]): string[] {\n  const found: string[] = [];\n  const lowerText = text.toLowerCase();\n  \n  for (const keyword of keywords) {\n    if (lowerText.includes(keyword.toLowerCase())) {\n      found.push(keyword);\n    }\n  }\n  \n  return found;\n}\n","size_bytes":9644},"server/encryption.ts":{"content":"import crypto from \"crypto\";\n\n/**\n * Encryption Service for Sensitive Data (Jira API Tokens)\n * Uses AES-256-GCM encryption\n */\n\n/**\n * Get encryption key from environment variable\n * CRITICAL: Must be set to a stable 32-byte hex string to prevent data corruption\n * Generate one with: node -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"\n */\nfunction getEncryptionKey(): string {\n  const key = process.env.ENCRYPTION_KEY;\n  const isProduction = process.env.NODE_ENV === 'production';\n  \n  if (!key) {\n    if (isProduction) {\n      // HARD REQUIREMENT in production - fail fast\n      throw new Error(\n        '\\n❌ CRITICAL: ENCRYPTION_KEY is required in production!\\n' +\n        '   Without a persistent encryption key, Jira API tokens will be corrupted on restart.\\n\\n' +\n        '   Generate a secure 32-byte encryption key:\\n' +\n        '   node -e \"console.log(require(\\'crypto\\').randomBytes(32).toString(\\'hex\\'))\"\\n\\n' +\n        '   Add to environment:\\n' +\n        '   ENCRYPTION_KEY=<your-generated-key>\\n\\n' +\n        '   Production deployment cannot continue without this key.\\n'\n      );\n    }\n    \n    // Development only - allow with warning\n    console.warn(\n      '\\n⚠️  WARNING: ENCRYPTION_KEY not set - using temporary key!\\n' +\n      '   Jira API tokens will be corrupted on restart.\\n' +\n      '   Generate a secure key: node -e \"console.log(require(\\'crypto\\').randomBytes(32).toString(\\'hex\\'))\"\\n' +\n      '   Add to Secrets: ENCRYPTION_KEY=<your-generated-key>\\n'\n    );\n    return crypto.randomBytes(32).toString('hex');\n  }\n  \n  // Validate key length\n  const keyBuffer = Buffer.from(key, 'hex');\n  if (keyBuffer.length !== 32) {\n    throw new Error(\n      `ENCRYPTION_KEY must be exactly 32 bytes (64 hex characters). ` +\n      `Current length: ${keyBuffer.length} bytes`\n    );\n  }\n  \n  return key;\n}\n\nconst ENCRYPTION_KEY = getEncryptionKey();\n\n/**\n * Encrypt sensitive data using AES-256-GCM\n */\nexport function encrypt(plaintext: string): string {\n  try {\n    // Generate random initialization vector\n    const iv = crypto.randomBytes(16);\n    \n    // Create cipher\n    const key = Buffer.from(ENCRYPTION_KEY.slice(0, 64), 'hex');\n    const cipher = crypto.createCipheriv('aes-256-gcm', key, iv);\n    \n    // Encrypt data\n    let encrypted = cipher.update(plaintext, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    \n    // Get authentication tag\n    const authTag = cipher.getAuthTag();\n    \n    // Combine iv + authTag + encrypted data\n    // Format: iv(32 chars) + authTag(32 chars) + encrypted\n    return iv.toString('hex') + authTag.toString('hex') + encrypted;\n  } catch (error: any) {\n    console.error('[Encryption Error]', error.message);\n    throw new Error('Failed to encrypt data');\n  }\n}\n\n/**\n * Decrypt sensitive data using AES-256-GCM\n */\nexport function decrypt(ciphertext: string): string {\n  try {\n    // Extract iv, authTag, and encrypted data\n    const iv = Buffer.from(ciphertext.slice(0, 32), 'hex');\n    const authTag = Buffer.from(ciphertext.slice(32, 64), 'hex');\n    const encrypted = ciphertext.slice(64);\n    \n    // Create decipher\n    const key = Buffer.from(ENCRYPTION_KEY.slice(0, 64), 'hex');\n    const decipher = crypto.createDecipheriv('aes-256-gcm', key, iv);\n    decipher.setAuthTag(authTag);\n    \n    // Decrypt data\n    let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n    decrypted += decipher.final('utf8');\n    \n    return decrypted;\n  } catch (error: any) {\n    console.error('[Decryption Error]', error.message);\n    throw new Error('Failed to decrypt data - data may be corrupted');\n  }\n}\n\n/**\n * Check if data is encrypted (basic heuristic)\n */\nexport function isEncrypted(data: string): boolean {\n  // Encrypted data should be at least 64 chars (iv + authTag)\n  // and should be valid hex\n  return data.length >= 64 && /^[0-9a-f]+$/i.test(data);\n}\n\n/**\n * Safely encrypt if not already encrypted\n */\nexport function safeEncrypt(data: string): string {\n  if (!data) return '';\n  if (isEncrypted(data)) return data;\n  return encrypt(data);\n}\n\n/**\n * Safely decrypt if encrypted\n */\nexport function safeDecrypt(data: string): string {\n  if (!data) return '';\n  if (!isEncrypted(data)) return data; // Already plaintext\n  return decrypt(data);\n}\n\n/**\n * Generate a secure random token (for token rotation)\n */\nexport function generateSecureToken(length: number = 32): string {\n  return crypto.randomBytes(length).toString('base64url');\n}\n\n/**\n * Hash sensitive data (one-way, for verification)\n */\nexport function hash(data: string): string {\n  return crypto\n    .createHash('sha256')\n    .update(data)\n    .digest('hex');\n}\n","size_bytes":4644},"server/fallback-scoring.ts":{"content":"/**\n * Rule-Based Fallback Scoring System\n * Used when Gemini AI is unavailable or fails\n */\n\nexport interface SkillMap {\n  requiredSkills: string[];\n  niceToHave?: string[];\n  experienceLevel?: string;\n  domain?: string;\n}\n\nexport interface FitScoreResult {\n  score: number;\n  skillOverlap: number;\n  experienceMatch: number;\n  softSkillRelevance: number;\n  reasoning: string;\n}\n\n/**\n * Calculate skill overlap using keyword matching\n */\nfunction calculateSkillOverlap(candidateSkills: string[], requiredSkills: string[], niceToHave: string[] = []): number {\n  if (!candidateSkills || candidateSkills.length === 0) return 0;\n  if (!requiredSkills || requiredSkills.length === 0) return 50; // neutral score\n  \n  // Normalize skills to lowercase for comparison\n  const candidateSkillsNorm = candidateSkills.map(s => s.toLowerCase().trim());\n  const requiredSkillsNorm = requiredSkills.map(s => s.toLowerCase().trim());\n  const niceToHaveNorm = niceToHave.map(s => s.toLowerCase().trim());\n  \n  // Count exact matches for required skills\n  let requiredMatches = 0;\n  for (const required of requiredSkillsNorm) {\n    if (candidateSkillsNorm.some(cs => cs.includes(required) || required.includes(cs))) {\n      requiredMatches++;\n    }\n  }\n  \n  // Count nice-to-have matches\n  let niceToHaveMatches = 0;\n  for (const nice of niceToHaveNorm) {\n    if (candidateSkillsNorm.some(cs => cs.includes(nice) || nice.includes(cs))) {\n      niceToHaveMatches++;\n    }\n  }\n  \n  // Calculate weighted score\n  const requiredScore = requiredSkills.length > 0 \n    ? (requiredMatches / requiredSkills.length) * 80 \n    : 50;\n  \n  const niceToHaveScore = niceToHave.length > 0 \n    ? (niceToHaveMatches / niceToHave.length) * 20 \n    : 0;\n  \n  return Math.min(100, Math.round(requiredScore + niceToHaveScore));\n}\n\n/**\n * Calculate experience match based on text analysis\n */\nfunction calculateExperienceMatch(candidateExperience: string, experienceLevel?: string): number {\n  if (!candidateExperience) return 40; // neutral score for missing data\n  if (!experienceLevel) return 60; // neutral-positive if no requirement\n  \n  const expText = candidateExperience.toLowerCase();\n  const levelNorm = experienceLevel.toLowerCase();\n  \n  // Extract years of experience from text\n  const yearsMatch = expText.match(/(\\d+)\\+?\\s*(years?|yrs?)/i);\n  const candidateYears = yearsMatch ? parseInt(yearsMatch[1]) : 0;\n  \n  // Match experience level keywords\n  if (levelNorm.includes('senior') || levelNorm.includes('lead') || levelNorm.includes('principal')) {\n    if (candidateYears >= 5) return 90;\n    if (candidateYears >= 3) return 70;\n    if (expText.includes('senior') || expText.includes('lead')) return 85;\n    return 50;\n  }\n  \n  if (levelNorm.includes('mid') || levelNorm.includes('intermediate')) {\n    if (candidateYears >= 2 && candidateYears < 6) return 90;\n    if (candidateYears >= 1) return 75;\n    return 60;\n  }\n  \n  if (levelNorm.includes('junior') || levelNorm.includes('entry')) {\n    if (candidateYears <= 2) return 90;\n    if (candidateYears <= 4) return 70;\n    return 50;\n  }\n  \n  // Default: check if candidate has any experience\n  return candidateYears > 0 ? 65 : 45;\n}\n\n/**\n * Calculate soft skill relevance using keyword analysis\n */\nfunction calculateSoftSkillRelevance(candidateExperience: string, domain?: string): number {\n  if (!candidateExperience) return 50; // neutral\n  \n  const expText = candidateExperience.toLowerCase();\n  const softSkillKeywords = [\n    'team', 'collaborate', 'communication', 'leadership', 'agile',\n    'scrum', 'project management', 'problem solving', 'analytical'\n  ];\n  \n  let matchCount = 0;\n  for (const keyword of softSkillKeywords) {\n    if (expText.includes(keyword)) {\n      matchCount++;\n    }\n  }\n  \n  // Domain match bonus\n  let domainBonus = 0;\n  if (domain && expText.includes(domain.toLowerCase())) {\n    domainBonus = 15;\n  }\n  \n  const baseScore = Math.min(70, matchCount * 8);\n  return Math.min(100, baseScore + domainBonus + 30); // +30 baseline\n}\n\n/**\n * Rule-based fit score calculation (fallback when AI fails)\n */\nexport function calculateFallbackFitScore(\n  candidateSkills: string[],\n  candidateExperience: string,\n  skillMap: SkillMap\n): FitScoreResult {\n  console.log('[Fallback Scoring] Using rule-based scoring system');\n  \n  const skillOverlap = calculateSkillOverlap(\n    candidateSkills,\n    skillMap.requiredSkills,\n    skillMap.niceToHave\n  );\n  \n  const experienceMatch = calculateExperienceMatch(\n    candidateExperience,\n    skillMap.experienceLevel\n  );\n  \n  const softSkillRelevance = calculateSoftSkillRelevance(\n    candidateExperience,\n    skillMap.domain\n  );\n  \n  // Weighted average: skills 50%, experience 30%, soft skills 20%\n  const score = Math.round(\n    skillOverlap * 0.5 +\n    experienceMatch * 0.3 +\n    softSkillRelevance * 0.2\n  );\n  \n  const reasoning = generateFallbackReasoning(\n    skillOverlap,\n    experienceMatch,\n    softSkillRelevance,\n    candidateSkills,\n    skillMap\n  );\n  \n  return {\n    score,\n    skillOverlap,\n    experienceMatch,\n    softSkillRelevance,\n    reasoning\n  };\n}\n\n/**\n * Generate human-readable reasoning for fallback scores\n */\nfunction generateFallbackReasoning(\n  skillOverlap: number,\n  experienceMatch: number,\n  softSkillRelevance: number,\n  candidateSkills: string[],\n  skillMap: SkillMap\n): string {\n  const parts: string[] = [];\n  \n  // Skill assessment\n  if (skillOverlap >= 80) {\n    parts.push('Strong skill match with most required competencies.');\n  } else if (skillOverlap >= 60) {\n    parts.push('Good skill alignment with key requirements.');\n  } else if (skillOverlap >= 40) {\n    parts.push('Partial skill match - some gaps in required skills.');\n  } else {\n    parts.push('Limited skill overlap - significant training may be needed.');\n  }\n  \n  // Experience assessment\n  if (experienceMatch >= 80) {\n    parts.push('Experience level aligns well with position requirements.');\n  } else if (experienceMatch >= 60) {\n    parts.push('Adequate experience for the role.');\n  } else {\n    parts.push('Experience level may not fully match requirements.');\n  }\n  \n  // Soft skills\n  if (softSkillRelevance >= 70) {\n    parts.push('Profile demonstrates relevant soft skills and domain knowledge.');\n  } else {\n    parts.push('Additional soft skill development may be beneficial.');\n  }\n  \n  parts.push('[Note: Score calculated using rule-based system]');\n  \n  return parts.join(' ');\n}\n\n/**\n * Extract skill map from text using simple keyword extraction\n * Used when AI skill map generation fails\n */\nexport function extractFallbackSkillMap(text: string, description: string = ''): SkillMap {\n  console.log('[Fallback Skill Map] Using keyword extraction');\n  \n  const combinedText = `${text} ${description}`.toLowerCase();\n  \n  // Common technology keywords\n  const techKeywords = [\n    'javascript', 'typescript', 'python', 'java', 'react', 'node.js', 'nodejs',\n    'angular', 'vue', 'sql', 'mongodb', 'postgresql', 'aws', 'docker', 'kubernetes',\n    'git', 'rest api', 'graphql', 'html', 'css', 'tailwind', 'bootstrap',\n    'express', 'django', 'spring', 'flask', 'redis', 'elasticsearch'\n  ];\n  \n  const requiredSkills: string[] = [];\n  for (const keyword of techKeywords) {\n    if (combinedText.includes(keyword)) {\n      requiredSkills.push(keyword);\n    }\n  }\n  \n  // Extract experience level\n  let experienceLevel = 'mid-level';\n  if (combinedText.includes('senior') || combinedText.includes('lead')) {\n    experienceLevel = 'senior';\n  } else if (combinedText.includes('junior') || combinedText.includes('entry')) {\n    experienceLevel = 'junior';\n  }\n  \n  return {\n    requiredSkills: requiredSkills.length > 0 ? requiredSkills : ['general programming'],\n    niceToHave: [],\n    experienceLevel,\n    domain: 'software development'\n  };\n}\n","size_bytes":7773},"ROADMAP.md":{"content":"# Lean Workforce - Product Roadmap\n\n## Priority Classification\n\n**P0 (Critical - Blockers)**: Must fix before production launch. These prevent core functionality or cause data corruption.\n\n**P1 (High - Important)**: Should implement soon. These significantly impact user experience or business operations.\n\n**P2 (Medium - Nice to Have)**: Can be implemented later. These improve the platform but aren't essential for launch.\n\n---\n\n## 🚨 P0 - Critical (Must Fix Before Production)\n\n### 1. Jira Sync Error Handling\n**Status**: Not implemented  \n**Impact**: High - System crashes when Jira API fails  \n**Risk**: Production outages, data loss\n\n**Current Behavior**: Application crashes on Jira 500 errors or missing milestones  \n**Required Implementation**:\n- Add try-catch blocks around all Jira API calls\n- Store sync status and error logs in database\n- Graceful degradation when Jira unavailable\n- Manual retry mechanism for failed syncs\n- Alert business users when sync fails\n\n**Acceptance Criteria**:\n- ✅ Jira API errors don't crash the application\n- ✅ Sync errors logged to database with timestamps\n- ✅ Business users notified of sync failures\n- ✅ Manual retry button in business dashboard\n\n---\n\n### 2. ENCRYPTION_KEY Production Requirement\n**Status**: Partially implemented (warns but uses temporary key)  \n**Impact**: Critical - Data corruption on restart  \n**Risk**: Jira credentials lost, security breach\n\n**Current Behavior**: Generates random key if ENCRYPTION_KEY not set  \n**Required Implementation**:\n- **HARD REQUIREMENT**: Fail fast on startup if ENCRYPTION_KEY missing in production\n- Environment detection (development vs production)\n- Clear documentation for key generation and storage\n- Migration script to re-encrypt existing tokens when key changes\n\n**Acceptance Criteria**:\n- ✅ Production deployment fails without ENCRYPTION_KEY\n- ✅ Development shows warning but continues\n- ✅ Documentation includes key generation instructions\n- ✅ Existing encrypted data can be migrated to new key\n\n---\n\n### 3. Candidate Double-Booking Prevention\n**Status**: Not implemented  \n**Impact**: High - Revenue loss, candidate burnout  \n**Risk**: Legal issues, reputation damage\n\n**Current Behavior**: No validation - candidates can be assigned to multiple projects simultaneously  \n**Required Implementation**:\n- Candidate availability calendar (simple boolean: available/busy)\n- Assignment validation before confirming\n- Check existing active assignments\n- Prevent overlapping assignments\n- Require candidate confirmation before assignment\n\n**Acceptance Criteria**:\n- ✅ System checks candidate availability before assignment\n- ✅ Candidates can mark themselves as available/busy\n- ✅ Business users see candidate availability status\n- ✅ Assignment requires candidate acceptance\n\n---\n\n## 🔶 P1 - High Priority (Implement Soon)\n\n### 4. Candidate Application Status Workflow\n**Status**: Not implemented  \n**Impact**: Medium-High - Unclear process for candidates and businesses  \n**User Confusion**: Current \"Apply\" button has no follow-up\n\n**Current Behavior**: Candidates can \"Apply\" but status remains \"pending\" forever  \n**Recommended Implementation**:\n```\nState Machine:\nviewed → saved → applied → interviewed → accepted/rejected → active → completed\n\nTransitions:\n- Candidate \"Apply\" → status: \"applied\" → notify business\n- Business \"Interview\" → status: \"interviewed\" → notify candidate\n- Business \"Accept\" → status: \"accepted\" → notify candidate\n- Business \"Reject\" → status: \"rejected\" → notify candidate\n- Assignment confirmed → status: \"active\"\n- Project completed → status: \"completed\"\n```\n\n**Acceptance Criteria**:\n- ✅ Add `applicationStatus` field to applications table\n- ✅ Business dashboard shows pending applications\n- ✅ Business can accept/reject applications\n- ✅ Email notifications at each state change\n- ✅ Candidate dashboard shows application status history\n\n---\n\n### 5. Multi-Business Candidate Competition Logic\n**Status**: Not implemented  \n**Impact**: Medium - Unfair allocation, candidate overwhelm  \n**Business Impact**: Poor candidate experience\n\n**Current Behavior**: Undefined - what happens when 3 businesses want same candidate?  \n**Recommended Implementation**:\n```\nPriority Scoring Algorithm:\n- Fit Score: 40% weight\n- Project Budget/Value: 30% weight\n- Candidate Preference: 30% weight\n\nProcess:\n1. Multiple businesses mark candidate as \"interested\"\n2. System calculates priority score for each\n3. Top 3 opportunities shown to candidate\n4. Candidate chooses (or rejects all)\n5. Losing businesses notified, can adjust offer\n```\n\n**Acceptance Criteria**:\n- ✅ Track multiple business interests per candidate\n- ✅ Priority scoring algorithm implemented\n- ✅ Candidate sees top 3 matches\n- ✅ Businesses can adjust offers to compete\n\n---\n\n### 6. Risk Alert Escalation Levels\n**Status**: Partially implemented (basic risk detection only)  \n**Impact**: Medium - Over/under reaction to delays  \n**Efficiency**: Current all-or-nothing approach is crude\n\n**Current Behavior**: High risk → Auto-activate backup (too aggressive)  \n**Recommended Implementation**:\n```\nRisk Levels:\n- Low (10-20% delay): Monitor only + notify business\n- Medium (20-30% delay): Notify business + prepare backup list (don't activate)\n- High (30-40% delay): Notify business + backup ready + require decision within 24h\n- Critical (>40% delay): Auto-activate backup + escalate to management\n```\n\n**Acceptance Criteria**:\n- ✅ 4-tier risk classification\n- ✅ Different actions per tier\n- ✅ Business notification includes recommended action\n- ✅ Management escalation for critical risks\n\n---\n\n### 7. Business Review & Confirmation Workflow\n**Status**: Not implemented  \n**Impact**: Medium - Prevents irrelevant notifications  \n**Quality**: Adds human-in-the-loop validation\n\n**Current Behavior**: Auto-generate skill maps → Auto-calculate fit scores → Auto-notify candidates  \n**Recommended Implementation**:\n```\nWorkflow:\n1. Create project\n2. AI suggests skill map\n3. 📋 Business reviews/edits skill map\n4. Business confirms skill map\n5. Calculate fit scores\n6. 📋 Business reviews top 10 candidates\n7. Business selects candidates to notify\n8. Send notifications\n```\n\n**Acceptance Criteria**:\n- ✅ Skill map shown in editable form before confirmation\n- ✅ Business can modify AI suggestions\n- ✅ Top candidates shown in review screen\n- ✅ Business selects which candidates to notify\n\n---\n\n## 📦 P2 - Medium Priority (Future Enhancements)\n\n### 8. Payment & Pricing Model\n**Status**: Not implemented  \n**Impact**: Low (initially) - Can launch without payments  \n**Business Requirement**: Eventually critical for monetization\n\n**Options to Consider**:\n```\nModel 1: Subscription\n- Business: $99/month for unlimited projects\n- Candidate: Free\n- Platform fee: Monthly recurring\n\nModel 2: Per-Hire Commission\n- Business: Free to post, 15% fee on hire\n- Candidate: Free\n- Platform fee: One-time per successful hire\n\nModel 3: Hybrid\n- Business: $49/month + 10% commission\n- Candidate: Free\n- Platform fee: Monthly + commission\n```\n\n**Recommended**: Start with Model 2 (per-hire) to reduce barrier to entry\n\n**Future Implementation**:\n- Payment gateway integration (Stripe)\n- Invoice generation\n- Escrow for milestone-based payments\n- Refund workflows\n\n---\n\n### 9. Post-Project Candidate Evaluation\n**Status**: Not implemented  \n**Impact**: Low - Platform works without it  \n**Long-term Value**: Improves fit score accuracy over time\n\n**Recommended Implementation**:\n```\nAfter project completion:\n1. Business rates candidate (1-5 stars)\n2. Breakdown: Skills (1-5), Communication (1-5), Timeliness (1-5)\n3. Optional written feedback\n4. Rating affects candidate's reputation score\n5. Future fit scores weighted by past performance\n\nReputation Score Formula:\nfitScore_adjusted = base_fitScore * (1 + (avgRating - 3) * 0.1)\n\nExample:\n- Base fit: 85%\n- Avg rating: 4.5/5\n- Adjusted fit: 85% * (1 + 0.15) = 97.75%\n```\n\n**Acceptance Criteria**:\n- ✅ Rating form in business dashboard after project completion\n- ✅ Ratings stored in database\n- ✅ Reputation score calculated and displayed\n- ✅ Fit score algorithm includes reputation weight\n\n---\n\n### 10. Project Cancellation Policy\n**Status**: Not implemented  \n**Impact**: Low - Edge case, not common  \n**Risk Management**: Protects candidates from unfair cancellations\n\n**Recommended Policy**:\n```\nCancellation Rules:\n- Before assignment: Full refund, no penalty\n- After assignment but <7 days: \n  → 50% compensation to candidate\n  → 50% refund to business\n- After 7 days: \n  → Full payment to candidate for work completed\n  → Business charged full milestone amount\n  → Platform fee retained\n```\n\n**Future Implementation**:\n- Cancellation request form\n- Automated refund/payment processing\n- Dispute resolution workflow\n- Cancellation analytics (track abuse)\n\n---\n\n### 11. Business Metrics Dashboard\n**Status**: Not implemented  \n**Impact**: Low - Analytics nice-to-have  \n**Value**: Helps optimize platform over time\n\n**Metrics to Track**:\n```\n1. Time-to-Fill\n   - Avg: Project created → Candidate assigned\n   - Target: <48 hours\n\n2. Candidate Utilization Rate\n   - % time assigned vs available\n   - Target: 60-80% (avoid burnout)\n\n3. Fit Score Accuracy\n   - Correlation: Predicted fit vs actual rating\n   - Target: >0.7 correlation\n\n4. Backup Activation Success Rate\n   - % backups that prevented delays\n   - If <50%, reconsider threshold\n\n5. Churn Metrics\n   - Candidate drop-off after signup\n   - Business retention after first project\n```\n\n**Future Implementation**:\n- Analytics dashboard for platform admin\n- Automated reports (weekly/monthly)\n- Metric visualization with charts\n- Anomaly detection and alerts\n\n---\n\n### 12. Backup Candidate Workflow Refinement\n**Status**: Partially implemented  \n**Impact**: Low - Current logic works but can be improved  \n**Edge Case**: Candidate rejects after backup activated\n\n**Current Behavior**: Undefined what happens if candidate rejects after backup already assigned  \n**Recommended State Machine**:\n```\nPrimary Assignment States:\npending → offered → accepted → active → completed → failed\n\nBackup Assignment Flow:\n1. Primary candidate = \"active\"\n2. Risk detection triggers backup = \"standby\"\n3. If primary fails → backup = \"offered\"\n4. If backup accepts → backup = \"active\", primary = \"failed\"\n5. If backup rejects → try next backup in queue\n\nRules:\n- Can't have 2 active candidates on same milestone\n- Primary candidate can be re-assigned if backup fails\n- Track transition history for auditing\n```\n\n**Acceptance Criteria**:\n- ✅ State machine enforces valid transitions\n- ✅ Transition history logged to database\n- ✅ Validation prevents double-active assignments\n- ✅ UI shows current state clearly\n\n---\n\n## 📊 Implementation Timeline\n\n### Phase 1: Production Readiness (Week 1-2)\n**Goal**: Fix P0 blockers\n- [ ] Jira sync error handling\n- [ ] ENCRYPTION_KEY hard requirement\n- [ ] Candidate double-booking prevention\n\n**Success Criteria**: Platform can safely launch without data corruption or crashes\n\n---\n\n### Phase 2: Core Workflows (Week 3-4)\n**Goal**: Complete P1 high-value features\n- [ ] Application status workflow\n- [ ] Multi-business competition logic\n- [ ] Risk alert escalation levels\n- [ ] Business review & confirmation workflow\n\n**Success Criteria**: Professional workflow that handles real-world scenarios\n\n---\n\n### Phase 3: Optimization (Month 2-3)\n**Goal**: Implement P2 enhancements\n- [ ] Payment & pricing model\n- [ ] Post-project evaluation\n- [ ] Project cancellation policy\n- [ ] Metrics dashboard\n- [ ] Backup workflow refinement\n\n**Success Criteria**: Platform ready for scale and monetization\n\n---\n\n## 🎯 Success Metrics\n\n### After Phase 1 (Production Ready):\n- ✅ Zero production crashes in 1 week\n- ✅ 100% data persistence across restarts\n- ✅ Zero double-booking incidents\n\n### After Phase 2 (Core Workflows):\n- ✅ <48 hour average time-to-fill\n- ✅ >80% candidate satisfaction with assignment process\n- ✅ <5% false-positive risk alerts\n\n### After Phase 3 (Optimized):\n- ✅ Payment success rate >95%\n- ✅ Fit score accuracy correlation >0.7\n- ✅ <10% monthly churn rate\n\n---\n\n## 📝 Notes\n\n- **Prioritization Rationale**: P0 items prevent production use, P1 items are needed for professional operations, P2 items are optimizations\n- **Timeline**: Aggressive but achievable with focused effort\n- **Flexibility**: Can adjust priorities based on user feedback after soft launch\n- **Technical Debt**: Some P2 items (like metrics) can use simple implementations first, then optimize later\n\n---\n\n**Last Updated**: October 29, 2025  \n**Status**: Initial roadmap based on product feedback analysis\n","size_bytes":12749},"server/assignment-validator.ts":{"content":"/**\n * Assignment Validation - Prevents candidate double-booking\n */\n\nimport { storage } from './storage';\nimport type { Candidate, Milestone } from '@shared/schema';\n\ninterface AssignmentValidationResult {\n  valid: boolean;\n  error?: string;\n  activeAssignments?: Milestone[];\n}\n\n/**\n * Check if candidate has any active assignments\n */\nexport async function getCandidateActiveAssignments(candidateId: string): Promise<Milestone[]> {\n  // Get all milestones where candidate is assigned\n  const allMilestones = await storage.getMilestonesByProject(''); // This won't work, need better approach\n  \n  // Actually, let's query by checking all projects\n  const allProjects = await storage.getAllProjects();\n  const activeAssignments: Milestone[] = [];\n  \n  for (const project of allProjects) {\n    const milestones = await storage.getMilestonesByProject(project.id);\n    \n    for (const milestone of milestones) {\n      // Check if this candidate is actively assigned\n      const isActivelyAssigned = \n        milestone.assignedCandidateId === candidateId &&\n        ['confirmed', 'active'].includes(milestone.assignmentStatus || '');\n      \n      const isActiveBackup = \n        milestone.backupCandidateId === candidateId &&\n        ['active'].includes(milestone.backupAssignmentStatus || '');\n      \n      if (isActivelyAssigned || isActiveBackup) {\n        activeAssignments.push(milestone);\n      }\n    }\n  }\n  \n  return activeAssignments;\n}\n\n/**\n * Validate if candidate can be assigned to a milestone\n * Prevents double-booking and checks availability\n */\nexport async function validateCandidateAssignment(\n  candidateId: string,\n  milestoneId: string\n): Promise<AssignmentValidationResult> {\n  // Get candidate\n  const candidate = await storage.getCandidate(candidateId);\n  if (!candidate) {\n    return {\n      valid: false,\n      error: 'Candidate not found'\n    };\n  }\n  \n  // Check if candidate is available\n  if (candidate.isAvailable === false) {\n    return {\n      valid: false,\n      error: `${candidate.name} is currently marked as unavailable. Please ask them to update their availability status.`\n    };\n  }\n  \n  // Check for active assignments\n  const activeAssignments = await getCandidateActiveAssignments(candidateId);\n  \n  if (activeAssignments.length > 0) {\n    const projectNames = await Promise.all(\n      activeAssignments.map(async (m) => {\n        const project = await storage.getProject(m.projectId);\n        return project?.name || 'Unknown Project';\n      })\n    );\n    \n    return {\n      valid: false,\n      error: `${candidate.name} is already assigned to ${activeAssignments.length} active project(s): ${projectNames.join(', ')}. Complete or reassign existing work before adding new assignments.`,\n      activeAssignments\n    };\n  }\n  \n  // All checks passed\n  return {\n    valid: true\n  };\n}\n\n/**\n * Validate backup candidate assignment\n * Backup can be assigned even if primary is active (they're on standby)\n */\nexport async function validateBackupAssignment(\n  candidateId: string,\n  milestoneId: string\n): Promise<AssignmentValidationResult> {\n  const candidate = await storage.getCandidate(candidateId);\n  if (!candidate) {\n    return {\n      valid: false,\n      error: 'Candidate not found'\n    };\n  }\n  \n  // Backup candidates can be on standby even with other assignments\n  // But they should still be generally available\n  if (candidate.isAvailable === false) {\n    return {\n      valid: false,\n      error: `${candidate.name} is currently unavailable. Please confirm their availability before assigning as backup.`\n    };\n  }\n  \n  return {\n    valid: true\n  };\n}\n\n/**\n * Confirm candidate assignment (candidate accepts the offer)\n */\nexport async function confirmCandidateAssignment(\n  milestoneId: string,\n  candidateId: string\n): Promise<{ success: boolean; error?: string }> {\n  const milestone = await storage.getMilestone(milestoneId);\n  if (!milestone) {\n    return { success: false, error: 'Milestone not found' };\n  }\n  \n  if (milestone.assignedCandidateId !== candidateId) {\n    return { success: false, error: 'You are not assigned to this milestone' };\n  }\n  \n  if (milestone.assignmentStatus === 'confirmed' || milestone.assignmentStatus === 'active') {\n    return { success: false, error: 'Assignment already confirmed' };\n  }\n  \n  // Validate still available (in case status changed)\n  const validation = await validateCandidateAssignment(candidateId, milestoneId);\n  if (!validation.valid) {\n    return { success: false, error: validation.error };\n  }\n  \n  // Confirm assignment\n  await storage.updateMilestone(milestoneId, {\n    assignmentStatus: 'confirmed',\n    assignmentConfirmedAt: new Date(),\n  });\n  \n  // Mark candidate as unavailable (they're now committed)\n  await storage.updateCandidate(candidateId, {\n    isAvailable: false\n  });\n  \n  return { success: true };\n}\n\n/**\n * Reject candidate assignment (candidate declines the offer)\n */\nexport async function rejectCandidateAssignment(\n  milestoneId: string,\n  candidateId: string,\n  reason?: string\n): Promise<{ success: boolean; error?: string }> {\n  const milestone = await storage.getMilestone(milestoneId);\n  if (!milestone) {\n    return { success: false, error: 'Milestone not found' };\n  }\n  \n  if (milestone.assignedCandidateId !== candidateId) {\n    return { success: false, error: 'You are not assigned to this milestone' };\n  }\n  \n  // Clear assignment\n  await storage.updateMilestone(milestoneId, {\n    assignedCandidateId: null,\n    assignmentStatus: 'unassigned',\n    assignmentConfirmedAt: null,\n  });\n  \n  console.log(`Candidate ${candidateId} rejected assignment to milestone ${milestoneId}. Reason: ${reason || 'Not provided'}`);\n  \n  return { success: true };\n}\n","size_bytes":5701},"server/jira-error-handler.ts":{"content":"/**\n * Jira Sync Error Handler\n * Wraps Jira API calls with comprehensive error handling and logging\n */\n\nimport { storage } from './storage';\nimport type { InsertJiraSyncLog } from '@shared/schema';\n\ninterface JiraSyncContext {\n  businessUserId: string;\n  syncType: 'import_projects' | 'sync_project' | 'sync_milestone';\n  projectId?: string;\n  jiraProjectKey?: string;\n}\n\ninterface JiraSyncResult<T = any> {\n  success: boolean;\n  data?: T;\n  error?: string;\n  logId?: string;\n  canRetry: boolean;\n}\n\n/**\n * Categorize Jira errors to determine if retry is possible\n */\nfunction categorizeJiraError(error: any): { canRetry: boolean; errorType: string } {\n  const errorMessage = error?.message || String(error);\n  const statusCode = error?.response?.status || error?.statusCode;\n\n  // Network errors - can retry\n  if (errorMessage.includes('ECONNREFUSED') || errorMessage.includes('ETIMEDOUT')) {\n    return { canRetry: true, errorType: 'network_error' };\n  }\n\n  // Rate limiting - can retry after delay\n  if (statusCode === 429) {\n    return { canRetry: true, errorType: 'rate_limit' };\n  }\n\n  // Authentication errors - cannot retry without fixing credentials\n  if (statusCode === 401 || statusCode === 403) {\n    return { canRetry: false, errorType: 'authentication_error' };\n  }\n\n  // Not found - cannot retry\n  if (statusCode === 404) {\n    return { canRetry: false, errorType: 'not_found' };\n  }\n\n  // Server errors - can retry\n  if (statusCode >= 500) {\n    return { canRetry: true, errorType: 'server_error' };\n  }\n\n  // Bad request - cannot retry without fixing request\n  if (statusCode >= 400 && statusCode < 500) {\n    return { canRetry: false, errorType: 'client_error' };\n  }\n\n  // Unknown error - allow retry\n  return { canRetry: true, errorType: 'unknown_error' };\n}\n\n/**\n * Execute Jira sync operation with error handling and logging\n */\nexport async function executeJiraSync<T>(\n  context: JiraSyncContext,\n  operation: () => Promise<T>\n): Promise<JiraSyncResult<T>> {\n  // Create initial log entry\n  const logEntry: InsertJiraSyncLog = {\n    businessUserId: context.businessUserId,\n    syncType: context.syncType,\n    projectId: context.projectId,\n    jiraProjectKey: context.jiraProjectKey,\n    status: 'success', // Will update if fails\n    startedAt: new Date(),\n  };\n\n  const log = await storage.createJiraSyncLog(logEntry);\n\n  try {\n    // Execute the Jira operation\n    const result = await operation();\n\n    // Update log as successful\n    await storage.updateJiraSyncLog(log.id, {\n      status: 'success',\n      completedAt: new Date(),\n    });\n\n    // Update project sync status if applicable\n    if (context.projectId) {\n      await storage.updateProject(context.projectId, {\n        lastJiraSyncAt: new Date(),\n        lastJiraSyncStatus: 'success',\n        lastJiraSyncError: null,\n      });\n    }\n\n    return {\n      success: true,\n      data: result,\n      logId: log.id,\n      canRetry: false,\n    };\n  } catch (error: any) {\n    console.error(`[Jira Sync Error] ${context.syncType}:`, error);\n\n    const { canRetry, errorType } = categorizeJiraError(error);\n    const errorMessage = error?.message || String(error);\n\n    // Update log with error details\n    await storage.updateJiraSyncLog(log.id, {\n      status: 'failed',\n      error: errorMessage,\n      errorDetails: {\n        type: errorType,\n        statusCode: error?.response?.status || error?.statusCode,\n        stack: error?.stack,\n        response: error?.response?.data,\n      } as any,\n      canRetry,\n      completedAt: new Date(),\n    });\n\n    // Update project sync status if applicable\n    if (context.projectId) {\n      await storage.updateProject(context.projectId, {\n        lastJiraSyncAt: new Date(),\n        lastJiraSyncStatus: 'failed',\n        lastJiraSyncError: errorMessage,\n      });\n    }\n\n    return {\n      success: false,\n      error: errorMessage,\n      logId: log.id,\n      canRetry,\n    };\n  }\n}\n\n/**\n * Execute Jira sync with partial success tracking\n * Used when syncing multiple items (e.g., importing multiple projects)\n */\nexport async function executeJiraSyncBatch<T>(\n  context: JiraSyncContext,\n  operation: () => Promise<{ created: number; updated: number; data: T }>\n): Promise<JiraSyncResult<T>> {\n  const logEntry: InsertJiraSyncLog = {\n    businessUserId: context.businessUserId,\n    syncType: context.syncType,\n    projectId: context.projectId,\n    jiraProjectKey: context.jiraProjectKey,\n    status: 'success',\n    startedAt: new Date(),\n  };\n\n  const log = await storage.createJiraSyncLog(logEntry);\n\n  try {\n    const result = await operation();\n\n    // Update log with counts\n    await storage.updateJiraSyncLog(log.id, {\n      status: 'success',\n      milestonesCreated: result.created,\n      milestonesUpdated: result.updated,\n      completedAt: new Date(),\n    });\n\n    if (context.projectId) {\n      await storage.updateProject(context.projectId, {\n        lastJiraSyncAt: new Date(),\n        lastJiraSyncStatus: 'success',\n        lastJiraSyncError: null,\n      });\n    }\n\n    return {\n      success: true,\n      data: result.data,\n      logId: log.id,\n      canRetry: false,\n    };\n  } catch (error: any) {\n    console.error(`[Jira Sync Batch Error] ${context.syncType}:`, error);\n\n    const { canRetry, errorType } = categorizeJiraError(error);\n    const errorMessage = error?.message || String(error);\n\n    await storage.updateJiraSyncLog(log.id, {\n      status: 'failed',\n      error: errorMessage,\n      errorDetails: {\n        type: errorType,\n        statusCode: error?.response?.status || error?.statusCode,\n        stack: error?.stack,\n      } as any,\n      canRetry,\n      completedAt: new Date(),\n    });\n\n    if (context.projectId) {\n      await storage.updateProject(context.projectId, {\n        lastJiraSyncAt: new Date(),\n        lastJiraSyncStatus: 'failed',\n        lastJiraSyncError: errorMessage,\n      });\n    }\n\n    return {\n      success: false,\n      error: errorMessage,\n      logId: log.id,\n      canRetry,\n    };\n  }\n}\n\n/**\n * Get user-friendly error message for Jira sync failures\n */\nexport function getJiraSyncErrorMessage(error: string, canRetry: boolean): string {\n  if (error.includes('not connected') || error.includes('401') || error.includes('403')) {\n    return 'Jira connection failed. Please check your Jira credentials in settings.';\n  }\n\n  if (error.includes('404')) {\n    return 'Jira project or issue not found. It may have been deleted or you don\\'t have access.';\n  }\n\n  if (error.includes('429') || error.includes('rate limit')) {\n    return 'Jira rate limit reached. Please try again in a few minutes.';\n  }\n\n  if (error.includes('ECONNREFUSED') || error.includes('ETIMEDOUT')) {\n    return 'Unable to connect to Jira. Please check your internet connection and try again.';\n  }\n\n  if (error.includes('500') || error.includes('502') || error.includes('503')) {\n    return 'Jira server error. This is temporary - please try again later.';\n  }\n\n  if (canRetry) {\n    return `Jira sync failed: ${error}. You can try again using the Retry button.`;\n  }\n\n  return `Jira sync failed: ${error}. Please check your Jira configuration.`;\n}\n","size_bytes":7117},"server/priority-scorer.ts":{"content":"/**\n * Priority Scoring Algorithm for Multi-Business Competition\n * \n * Calculates priority score when multiple businesses compete for the same candidate.\n * Formula: Priority Score = (Fit Score × 40%) + (Budget Score × 30%) + (Preference Score × 30%)\n * \n * Output: Integer 0-100 representing overall priority\n */\n\nexport interface PriorityScoreInput {\n  fitScore: number; // Candidate's fit score for this milestone (0-100)\n  offerBudget: number; // Budget offered by business (in dollars)\n  candidatePreference?: number; // Candidate's rating of this opportunity (1-5 stars)\n  maxBudget?: number; // Maximum budget across all competing offers (for normalization)\n}\n\nexport interface PriorityScoreResult {\n  priorityScore: number; // Final priority score (0-100)\n  breakdown: {\n    fitContribution: number; // Contribution from fit score\n    budgetContribution: number; // Contribution from budget\n    preferenceContribution: number; // Contribution from candidate preference\n  };\n}\n\n/**\n * Calculate priority score for a business interest\n * \n * @param input - Scoring input parameters\n * @returns Priority score with breakdown\n */\nexport function calculatePriorityScore(input: PriorityScoreInput): PriorityScoreResult {\n  const { fitScore, offerBudget, candidatePreference, maxBudget } = input;\n  \n  // Normalize fit score (already 0-100, just ensure it's valid)\n  const normalizedFit = Math.max(0, Math.min(100, fitScore));\n  \n  // Normalize budget to 0-100 scale\n  // If maxBudget provided, use it for normalization\n  // Otherwise assume current offer is the max (100)\n  const normalizedBudget = maxBudget && maxBudget > 0\n    ? Math.min(100, (offerBudget / maxBudget) * 100)\n    : Math.min(100, offerBudget > 0 ? 100 : 0);\n  \n  // Normalize candidate preference (1-5 stars) to 0-100 scale\n  // Default to 50 (neutral) if not provided\n  const normalizedPreference = candidatePreference \n    ? ((candidatePreference - 1) / 4) * 100 // Convert 1-5 to 0-100\n    : 50; // Default neutral if candidate hasn't rated yet\n  \n  // Calculate weighted contributions\n  const fitContribution = normalizedFit * 0.4; // 40% weight\n  const budgetContribution = normalizedBudget * 0.3; // 30% weight\n  const preferenceContribution = normalizedPreference * 0.3; // 30% weight\n  \n  // Calculate final priority score\n  const priorityScore = Math.round(\n    fitContribution + budgetContribution + preferenceContribution\n  );\n  \n  return {\n    priorityScore: Math.max(0, Math.min(100, priorityScore)),\n    breakdown: {\n      fitContribution: Math.round(fitContribution),\n      budgetContribution: Math.round(budgetContribution),\n      preferenceContribution: Math.round(preferenceContribution),\n    },\n  };\n}\n\n/**\n * Calculate priority scores for multiple competing business interests\n * Automatically finds max budget across all offers for normalization\n * \n * @param interests - Array of business interests to score\n * @returns Array of scored interests with priority scores\n */\nexport function calculateCompetingPriorityScores(\n  interests: Array<{\n    id: string;\n    fitScore: number;\n    offerBudget: number;\n    candidatePreference?: number;\n  }>\n): Array<{\n  id: string;\n  priorityScore: number;\n  breakdown: PriorityScoreResult['breakdown'];\n}> {\n  // Find max budget across all competing offers\n  const maxBudget = Math.max(...interests.map(i => i.offerBudget || 0));\n  \n  return interests.map(interest => {\n    const result = calculatePriorityScore({\n      fitScore: interest.fitScore,\n      offerBudget: interest.offerBudget,\n      candidatePreference: interest.candidatePreference,\n      maxBudget,\n    });\n    \n    return {\n      id: interest.id,\n      priorityScore: result.priorityScore,\n      breakdown: result.breakdown,\n    };\n  });\n}\n\n/**\n * Get top N competing offers for a candidate, sorted by priority score\n * \n * @param interests - Array of business interests\n * @param topN - Number of top offers to return (default: 3)\n * @returns Top N offers sorted by priority score (highest first)\n */\nexport function getTopCompetingOffers<T extends { priorityScore: number }>(\n  interests: T[],\n  topN: number = 3\n): T[] {\n  return interests\n    .sort((a, b) => b.priorityScore - a.priorityScore)\n    .slice(0, topN);\n}\n","size_bytes":4222},"server/session.d.ts":{"content":"import \"express-session\";\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    userId: string;\n    email: string;\n    role: \"business\" | \"candidate\";\n  }\n}\n","size_bytes":169},"client/src/pages/CandidateLogin.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Mail, Loader2, CheckCircle2, AlertCircle, Clock, User, ArrowLeft } from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/hooks/useAuth\";\n\nexport default function CandidateLogin() {\n  const [, setLocation] = useLocation();\n  const { user, isLoading: isCheckingAuth } = useAuth();\n  const [email, setEmail] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [linkSent, setLinkSent] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [canResend, setCanResend] = useState(true);\n  const [countdown, setCountdown] = useState(0);\n  const { toast } = useToast();\n\n  // Auto-redirect if already logged in\n  useEffect(() => {\n    if (user) {\n      if (user.role === \"candidate\") {\n        setLocation(\"/candidate/dashboard\");\n      } else {\n        setLocation(\"/business\");\n      }\n    }\n  }, [user, setLocation]);\n\n  // Show loading while checking auth\n  if (isCheckingAuth) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  // Don't render login form if user is logged in\n  if (user) {\n    return null;\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    \n    if (!email || !email.includes(\"@\")) {\n      setError(\"Please enter a valid email address\");\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const response = await apiRequest(\"POST\", \"/api/auth/request-magic-link\", { \n        email,\n        requestedRole: \"candidate\"\n      });\n      \n      setLinkSent(true);\n      setCanResend(false);\n      \n      let timeLeft = 30;\n      setCountdown(timeLeft);\n      const timer = setInterval(() => {\n        timeLeft -= 1;\n        setCountdown(timeLeft);\n        if (timeLeft <= 0) {\n          clearInterval(timer);\n          setCanResend(true);\n          setCountdown(0);\n        }\n      }, 1000);\n\n      toast({\n        title: \"Magic link sent!\",\n        description: \"Check your email for the login link.\",\n      });\n    } catch (err: any) {\n      const errorMsg = err.message || \"Failed to send magic link. Please try again.\";\n      setError(errorMsg);\n      \n      if (err.message?.includes(\"Too many requests\")) {\n        setCanResend(false);\n        toast({\n          title: \"Rate limit exceeded\",\n          description: \"Please wait before requesting another link.\",\n          variant: \"destructive\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: errorMsg,\n          variant: \"destructive\",\n        });\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleResend = () => {\n    setLinkSent(false);\n    setError(\"\");\n    handleSubmit(new Event(\"submit\") as any);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Lean Workforce</h1>\n          <p className=\"text-muted-foreground\">Find your next opportunity</p>\n        </div>\n\n        <Card>\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4\">\n              <User className=\"w-6 h-6 text-primary\" />\n            </div>\n            <CardTitle>Candidate Login</CardTitle>\n            <CardDescription>\n              Enter your email to access your opportunities\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {!linkSent ? (\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"email\" className=\"text-sm font-medium mb-2 block\">\n                    Email Address\n                  </Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    placeholder=\"your.email@example.com\"\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    disabled={isLoading}\n                    autoFocus\n                    data-testid=\"input-email-candidate\"\n                  />\n                  {error && (\n                    <div className=\"flex items-center gap-2 mt-2 text-sm text-destructive\">\n                      <AlertCircle className=\"w-4 h-4\" />\n                      <span data-testid=\"error-message\">{error}</span>\n                    </div>\n                  )}\n                </div>\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={isLoading || !email}\n                  data-testid=\"button-send-link-candidate\"\n                >\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Sending...\n                    </>\n                  ) : (\n                    <>\n                      <Mail className=\"w-4 h-4 mr-2\" />\n                      Send Login Link\n                    </>\n                  )}\n                </Button>\n\n                <p className=\"text-xs text-center text-muted-foreground\">\n                  No password needed. We'll email you a secure link.\n                </p>\n              </form>\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"flex flex-col items-center text-center py-6\">\n                  <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n                    <CheckCircle2 className=\"w-8 h-8 text-green-600\" />\n                  </div>\n                  <h3 className=\"font-semibold text-lg mb-2\" data-testid=\"success-title\">Check Your Email</h3>\n                  <p className=\"text-muted-foreground mb-4\" data-testid=\"success-message\">\n                    We sent a login link to <strong>{email}</strong>\n                  </p>\n                  <div className=\"bg-muted/50 rounded-md p-4 mb-4 text-sm space-y-2\">\n                    <div className=\"flex items-start gap-2\">\n                      <Clock className=\"w-4 h-4 mt-0.5 shrink-0\" />\n                      <p className=\"text-left\">\n                        The link will expire in <strong>10 minutes</strong>\n                      </p>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <Mail className=\"w-4 h-4 mt-0.5 shrink-0\" />\n                      <p className=\"text-left\">\n                        Check your spam folder if you don't see it\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full\"\n                  onClick={handleResend}\n                  disabled={!canResend || isLoading}\n                  data-testid=\"button-resend\"\n                >\n                  {countdown > 0 ? (\n                    <>\n                      Resend in {countdown}s\n                    </>\n                  ) : (\n                    <>\n                      Resend Link\n                    </>\n                  )}\n                </Button>\n\n                <Button\n                  variant=\"ghost\"\n                  className=\"w-full\"\n                  onClick={() => {\n                    setLinkSent(false);\n                    setEmail(\"\");\n                    setError(\"\");\n                  }}\n                  data-testid=\"button-different-email\"\n                >\n                  Use Different Email\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <div className=\"text-center mt-6\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\" data-testid=\"link-back-home\">\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Home\n            </Button>\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8506},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { fetchSession } from \"@/lib/auth\";\n\nexport function useAuth() {\n  const { data, isLoading, error, refetch } = useQuery({\n    queryKey: [\"/api/auth/session\"],\n    queryFn: fetchSession,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    retry: false,\n  });\n\n  return {\n    user: data ?? null,\n    isLoading,\n    error,\n    isAuthenticated: !!data,\n    isBusinessUser: data?.role === \"business\",\n    isCandidateUser: data?.role === \"candidate\",\n    refetch,\n  };\n}\n","size_bytes":517},"client/src/pages/BusinessLogin.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Mail, Loader2, CheckCircle2, AlertCircle, Clock, Briefcase, ArrowLeft } from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/hooks/useAuth\";\n\nexport default function BusinessLogin() {\n  const [, setLocation] = useLocation();\n  const { user, isLoading: isCheckingAuth } = useAuth();\n  const [email, setEmail] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [linkSent, setLinkSent] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [canResend, setCanResend] = useState(true);\n  const [countdown, setCountdown] = useState(0);\n  const { toast } = useToast();\n\n  // Auto-redirect if already logged in\n  useEffect(() => {\n    if (user) {\n      if (user.role === \"business\") {\n        setLocation(\"/business\");\n      } else {\n        setLocation(\"/candidate/dashboard\");\n      }\n    }\n  }, [user, setLocation]);\n\n  // Show loading while checking auth\n  if (isCheckingAuth) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n      </div>\n    );\n  }\n\n  // Don't render login form if user is logged in\n  if (user) {\n    return null;\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    \n    if (!email || !email.includes(\"@\")) {\n      setError(\"Please enter a valid email address\");\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const response = await apiRequest(\"POST\", \"/api/auth/request-magic-link\", { \n        email,\n        requestedRole: \"business\"\n      });\n      \n      setLinkSent(true);\n      setCanResend(false);\n      \n      let timeLeft = 30;\n      setCountdown(timeLeft);\n      const timer = setInterval(() => {\n        timeLeft -= 1;\n        setCountdown(timeLeft);\n        if (timeLeft <= 0) {\n          clearInterval(timer);\n          setCanResend(true);\n          setCountdown(0);\n        }\n      }, 1000);\n\n      toast({\n        title: \"Magic link sent!\",\n        description: \"Check your email for the login link.\",\n      });\n    } catch (err: any) {\n      const errorMsg = err.message || \"Failed to send magic link. Please try again.\";\n      setError(errorMsg);\n      \n      if (err.message?.includes(\"Too many requests\")) {\n        setCanResend(false);\n        toast({\n          title: \"Rate limit exceeded\",\n          description: \"Please wait before requesting another link.\",\n          variant: \"destructive\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: errorMsg,\n          variant: \"destructive\",\n        });\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleResend = () => {\n    setLinkSent(false);\n    setError(\"\");\n    handleSubmit(new Event(\"submit\") as any);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Lean Workforce</h1>\n          <p className=\"text-muted-foreground\">Find the right talent for your projects</p>\n        </div>\n\n        <Card>\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4\">\n              <Briefcase className=\"w-6 h-6 text-primary\" />\n            </div>\n            <CardTitle>Business Login</CardTitle>\n            <CardDescription>\n              Enter your email to access your business dashboard\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {!linkSent ? (\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"email\" className=\"text-sm font-medium mb-2 block\">\n                    Business Email Address\n                  </Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    placeholder=\"your.email@company.com\"\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    disabled={isLoading}\n                    autoFocus\n                    data-testid=\"input-email-business\"\n                  />\n                  {error && (\n                    <div className=\"flex items-center gap-2 mt-2 text-sm text-destructive\">\n                      <AlertCircle className=\"w-4 h-4\" />\n                      <span data-testid=\"error-message\">{error}</span>\n                    </div>\n                  )}\n                </div>\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={isLoading || !email}\n                  data-testid=\"button-send-link-business\"\n                >\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Sending...\n                    </>\n                  ) : (\n                    <>\n                      <Mail className=\"w-4 h-4 mr-2\" />\n                      Send Login Link\n                    </>\n                  )}\n                </Button>\n\n                <p className=\"text-xs text-center text-muted-foreground\">\n                  No password needed. We'll email you a secure link.\n                </p>\n              </form>\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"flex flex-col items-center text-center py-6\">\n                  <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n                    <CheckCircle2 className=\"w-8 h-8 text-green-600\" />\n                  </div>\n                  <h3 className=\"font-semibold text-lg mb-2\" data-testid=\"success-title\">Check Your Email</h3>\n                  <p className=\"text-muted-foreground mb-4\" data-testid=\"success-message\">\n                    We sent a login link to <strong>{email}</strong>\n                  </p>\n                  <div className=\"bg-muted/50 rounded-md p-4 mb-4 text-sm space-y-2\">\n                    <div className=\"flex items-start gap-2\">\n                      <Clock className=\"w-4 h-4 mt-0.5 shrink-0\" />\n                      <p className=\"text-left\">\n                        The link will expire in <strong>10 minutes</strong>\n                      </p>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <Mail className=\"w-4 h-4 mt-0.5 shrink-0\" />\n                      <p className=\"text-left\">\n                        Check your spam folder if you don't see it\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full\"\n                  onClick={handleResend}\n                  disabled={!canResend || isLoading}\n                  data-testid=\"button-resend\"\n                >\n                  {countdown > 0 ? (\n                    <>\n                      Resend in {countdown}s\n                    </>\n                  ) : (\n                    <>\n                      Resend Link\n                    </>\n                  )}\n                </Button>\n\n                <Button\n                  variant=\"ghost\"\n                  className=\"w-full\"\n                  onClick={() => {\n                    setLinkSent(false);\n                    setEmail(\"\");\n                    setError(\"\");\n                  }}\n                  data-testid=\"button-different-email\"\n                >\n                  Use Different Email\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <div className=\"text-center mt-6\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\" data-testid=\"link-back-home\">\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Home\n            </Button>\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8537}},"version":2}